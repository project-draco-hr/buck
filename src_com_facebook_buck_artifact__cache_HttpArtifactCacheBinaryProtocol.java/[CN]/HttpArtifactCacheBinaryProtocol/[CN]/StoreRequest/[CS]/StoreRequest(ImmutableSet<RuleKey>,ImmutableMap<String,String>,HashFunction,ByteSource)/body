{
  this.payloadSource=payloadSource;
  this.hashFunction=hashFunction;
  this.rawKeys=createKeysHeader(ruleKeys);
  this.rawMetadata=createMetadataHeader(ruleKeys,metadata,payloadSource,hashFunction);
  this.contentLength=rawKeys.length + Integer.SIZE / Byte.SIZE + rawMetadata.length + payloadSource.size();
}
