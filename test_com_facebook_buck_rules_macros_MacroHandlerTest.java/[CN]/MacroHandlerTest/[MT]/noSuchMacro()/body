{
  MacroHandler handler=new MacroHandler(ImmutableMap.<String,MacroExpander>of());
  BuildTarget target=BuildTargetFactory.newInstance("//:test");
  BuildRuleResolver resolver=new BuildRuleResolver();
  ProjectFilesystem filesystem=new FakeProjectFilesystem();
  try {
    handler.expand(target,resolver,filesystem,"$(badmacro hello)");
  }
 catch (  MacroException e) {
    assertTrue(e.getMessage().contains("no such macro \"badmacro\""));
  }
  try {
    handler.extractTargets(target,"$(badmacro hello)");
  }
 catch (  MacroException e) {
    assertTrue(e.getMessage().contains("no such macro \"badmacro\""));
  }
}
