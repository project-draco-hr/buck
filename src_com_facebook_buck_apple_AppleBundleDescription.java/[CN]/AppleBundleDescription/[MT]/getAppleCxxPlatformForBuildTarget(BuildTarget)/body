{
  Optional<FatBinaryInfo> fatBinaryInfo=FatBinaryInfo.create(platformFlavorsToAppleCxxPlatforms,target);
  AppleCxxPlatform appleCxxPlatform;
  if (fatBinaryInfo.isPresent()) {
    appleCxxPlatform=fatBinaryInfo.get().getRepresentativePlatform();
  }
 else {
    CxxPlatform cxxPlatform=getCxxPlatformForBuildTarget(target);
    appleCxxPlatform=platformFlavorsToAppleCxxPlatforms.get(cxxPlatform.getFlavor());
    if (appleCxxPlatform == null) {
      throw new HumanReadableException("%s: Apple bundle requires an Apple platform, found '%s'",target,cxxPlatform.getFlavor().getName());
    }
  }
  return appleCxxPlatform;
}
