{
  Optional<String> version=findNdkVersion(directory);
  if (version.isPresent()) {
    if (targetNdkVersion.isPresent() && !versionsMatch(targetNdkVersion.get(),version.get())) {
      throw new HumanReadableException("Buck is configured to use Android NDK version " + targetNdkVersion.get() + " at ndk.dir or ANDROID_NDK or NDK_HOME. The found version "+ "is "+ version.get()+ " located at "+ directory);
    }
  }
 else {
    throw new HumanReadableException("Failed to read NDK version from " + directory + ".");
  }
  return Optional.of(directory);
}
