{
  final String testBuckFileJson1=testDataPath("TargetsCommandTestBuckJson1.js");
  SortedMap<String,TargetNode<?>> nodes=buildTargetNodes("//" + testDataPath(""),"test-library");
  targetsCommand.printJsonForTargets(nodes,new ParserConfig(new FakeBuckConfig()));
  String observedOutput=console.getTextWrittenToStdOut();
  JsonNode observed=objectMapper.readTree(objectMapper.getJsonFactory().createJsonParser(observedOutput));
  String expectedJson=Files.toString(new File(testBuckFileJson1),Charsets.UTF_8);
  JsonNode expected=objectMapper.readTree(objectMapper.getJsonFactory().createJsonParser(expectedJson).enable(Feature.ALLOW_COMMENTS));
  assertEquals("Output from targets command should match expected JSON.",expected,observed);
  assertEquals("Nothing should be printed to stderr.","",console.getTextWrittenToStdErr());
}
