{
  this.filesystem=filesystem;
  this.watchman=watchman;
  this.config=config;
  this.directoryResolver=directoryResolver;
  ParserConfig parserConfig=new ParserConfig(config);
  this.buildFileName=parserConfig.getBuildFileName();
  this.enforceBuckPackageBoundaries=parserConfig.getEnforceBuckPackageBoundary();
  this.tempFilePatterns=parserConfig.getTempFilePatterns();
  PythonBuckConfig pythonConfig=new PythonBuckConfig(config,new ExecutableFinder());
  this.pythonInterpreter=pythonConfig.getPythonInterpreter();
  this.knownBuildRuleTypes=knownBuildRuleTypesFactory.create(config);
  this.cells=CacheBuilder.newBuilder().build(new CacheLoader<Path,Cell>(){
    @Override public Cell load(    Path cellPath) throws Exception {
      cellPath=cellPath.toRealPath();
      ImmutableMap<String,String> allCells=getBuckConfig().getEntriesForSection("repositories");
      Path root=null;
      Set<Path> knownRoots=new TreeSet<>();
      for (      String path : allCells.values()) {
        Path cellRoot=Preconditions.checkNotNull(getBuckConfig().resolvePathThatMayBeOutsideTheProjectFilesystem(Paths.get(path)));
        if (cellPath.equals(cellRoot)) {
          root=cellRoot;
          break;
        }
        knownRoots.add(cellRoot);
      }
      if (root == null) {
        throw new HumanReadableException("Unable to find repository rooted at %s. Known roots are:\n  %s",getFilesystem().getRootPath(),Joiner.on(",\n  ").join(knownRoots));
      }
      ImmutableMap<String,ImmutableMap<String,String>> sections=ImmutableMap.of();
      Config config=Config.createDefaultConfig(root,sections);
      ProjectFilesystem cellFilesystem=new ProjectFilesystem(root,config);
      Cell parent=Cell.this;
      BuckConfig parentConfig=parent.getBuckConfig();
      BuckConfig buckConfig=new BuckConfig(config,cellFilesystem,parentConfig.getArchitecture(),parentConfig.getPlatform(),parentConfig.getEnvironment());
      Watchman.build(root,parentConfig.getEnvironment(),console,clock);
      return new Cell(cellFilesystem,console,watchman,buckConfig,knownBuildRuleTypesFactory,directoryResolver,clock);
    }
  }
);
  cells.put(getFilesystem().getRootPath(),this);
}
