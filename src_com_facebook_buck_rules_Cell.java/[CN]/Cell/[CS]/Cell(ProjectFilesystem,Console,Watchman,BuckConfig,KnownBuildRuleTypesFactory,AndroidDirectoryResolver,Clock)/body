{
  this.filesystem=filesystem;
  this.watchman=watchman;
  this.config=config;
  this.directoryResolver=directoryResolver;
  ParserConfig parserConfig=new ParserConfig(config);
  this.buildFileName=parserConfig.getBuildFileName();
  this.enforceBuckPackageBoundaries=parserConfig.getEnforceBuckPackageBoundary();
  this.tempFilePatterns=parserConfig.getTempFilePatterns();
  ImmutableMap<String,String> allCells=getBuckConfig().getEntriesForSection("repositories");
  ImmutableSet.Builder<Path> roots=ImmutableSet.builder();
  roots.add(filesystem.getRootPath());
  for (  String cellName : allCells.keySet()) {
    Path cellRoot=Preconditions.checkNotNull(getCellRoots().apply(Optional.of(cellName)));
    roots.add(cellRoot);
  }
  this.knownRoots=roots.build();
  PythonBuckConfig pythonConfig=new PythonBuckConfig(config,new ExecutableFinder());
  this.pythonInterpreter=pythonConfig.getPythonInterpreter();
  this.knownBuildRuleTypes=knownBuildRuleTypesFactory.create(config);
  this.cells=CacheBuilder.newBuilder().build(new CacheLoader<Path,Cell>(){
    @Override public Cell load(    Path cellPath) throws Exception {
      cellPath=cellPath.toRealPath();
      if (!knownRoots.contains(cellPath)) {
        throw new HumanReadableException("Unable to find repository rooted at %s. Known roots are:\n  %s",getFilesystem().getRootPath(),Joiner.on(",\n  ").join(knownRoots));
      }
      ImmutableMap<String,ImmutableMap<String,String>> sections=ImmutableMap.of();
      Config config=Config.createDefaultConfig(cellPath,sections);
      ProjectFilesystem cellFilesystem=new ProjectFilesystem(cellPath,config);
      Cell parent=Cell.this;
      BuckConfig parentConfig=parent.getBuckConfig();
      BuckConfig buckConfig=new BuckConfig(config,cellFilesystem,parentConfig.getArchitecture(),parentConfig.getPlatform(),parentConfig.getEnvironment());
      Watchman.build(cellPath,parentConfig.getEnvironment(),console,clock);
      return new Cell(cellFilesystem,console,watchman,buckConfig,knownBuildRuleTypesFactory,directoryResolver,clock);
    }
  }
);
  cells.put(getFilesystem().getRootPath(),this);
}
