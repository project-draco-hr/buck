{
  this.filesystem=filesystem;
  this.watchman=watchman;
  this.config=config;
  this.directoryResolver=directoryResolver;
  this.cells=cells;
  ParserConfig parserConfig=new ParserConfig(config);
  this.buildFileName=parserConfig.getBuildFileName();
  this.enforceBuckPackageBoundaries=parserConfig.getEnforceBuckPackageBoundary();
  this.tempFilePatterns=parserConfig.getTempFilePatterns();
  ImmutableMap<String,String> allCells=getBuckConfig().getEntriesForSection("repositories");
  ImmutableSet.Builder<Path> roots=ImmutableSet.builder();
  ImmutableMap.Builder<Path,Optional<String>> rootsMap=ImmutableMap.builder();
  roots.add(filesystem.getRootPath());
  for (  String cellName : allCells.keySet()) {
    Path cellRoot=Preconditions.checkNotNull(getCellRoots().getCellPath(Optional.of(cellName)));
    roots.add(cellRoot);
    rootsMap.put(cellRoot,Optional.of(cellName));
  }
  this.knownRoots=roots.build();
  this.rootToCellMapDeprecated=rootsMap.build();
  PythonBuckConfig pythonConfig=new PythonBuckConfig(config,new ExecutableFinder());
  this.pythonInterpreter=pythonConfig.getPythonInterpreter();
  this.knownBuildRuleTypes=knownBuildRuleTypesFactory.create(config);
  cellLoader=new CacheLoader<Path,Cell>(){
    @Override public Cell load(    Path cellPath) throws Exception {
      cellPath=cellPath.toRealPath().normalize();
      if (!knownRoots.contains(cellPath)) {
        throw new HumanReadableException("Unable to find repository rooted at %s. Known roots are:\n  %s",getFilesystem().getRootPath(),Joiner.on(",\n  ").join(knownRoots));
      }
      Cell parent=Cell.this;
      BuckConfig parentConfig=parent.getBuckConfig();
      Config config=Configs.createDefaultConfig(Optional.fromNullable(rootToCellMapDeprecated.get(cellPath)).or(Optional.<String>absent()),cellPath,parentConfig.getConfigOverrides());
      ProjectFilesystem cellFilesystem=new ProjectFilesystem(cellPath,config);
      BuckConfig buckConfig=new BuckConfig(config,cellFilesystem,parentConfig.getArchitecture(),parentConfig.getPlatform(),parentConfig.getEnvironment());
      Watchman.build(cellPath,parentConfig.getEnvironment(),console,clock).close();
      return new Cell(cellFilesystem,console,watchman,buckConfig,knownBuildRuleTypesFactory,directoryResolver,clock,cells);
    }
  }
;
  cells.put(getFilesystem().getRootPath(),this);
}
