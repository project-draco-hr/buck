{
  assumeTrue(Platform.detect() == Platform.MACOS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"apple_library_is_hermetic",tmp);
  workspace.setUp();
  ProjectWorkspace.ProcessResult first=workspace.runBuckCommand(workspace.getPath("first"),"build","//Libraries/TestLibrary:TestLibrary#static,iphonesimulator-x86_64");
  first.assertSuccess();
  ProjectWorkspace.ProcessResult second=workspace.runBuckCommand(workspace.getPath("second"),"build","//Libraries/TestLibrary:TestLibrary#static,iphonesimulator-x86_64");
  second.assertSuccess();
  MoreAsserts.assertContentsEqual(workspace.getPath("first/buck-out/gen/Libraries/TestLibrary/" + "TestLibrary#compile-" + sanitize("TestClass.m.o") + ",iphonesimulator-x86_64/"+ "TestClass.m.o"),workspace.getPath("second/buck-out/gen/Libraries/TestLibrary/" + "TestLibrary#compile-" + sanitize("TestClass.m.o") + ",iphonesimulator-x86_64/"+ "TestClass.m.o"));
  MoreAsserts.assertContentsEqual(workspace.getPath("first/buck-out/gen/Libraries/TestLibrary/" + "TestLibrary#iphonesimulator-x86_64,static/libTestLibrary.a"),workspace.getPath("second/buck-out/gen/Libraries/TestLibrary/" + "TestLibrary#iphonesimulator-x86_64,static/libTestLibrary.a"));
}
