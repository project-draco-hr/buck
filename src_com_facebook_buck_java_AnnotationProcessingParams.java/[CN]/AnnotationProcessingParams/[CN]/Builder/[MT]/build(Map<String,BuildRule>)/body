{
  Preconditions.checkNotNull(buildRuleIndex);
  if (names.isEmpty() && targets.isEmpty() && parameters.isEmpty()) {
    return EMPTY;
  }
  Set<String> searchPathElements=Sets.newHashSet();
  for (  BuildTarget target : targets) {
    BuildRule rule=buildRuleIndex.get(target.getFullyQualifiedName());
    String type=rule.getType().getName();
    if ("java_binary".equals(type) || "prebuilt_jar".equals(type)) {
      File output=rule.getOutput();
      if (output != null) {
        searchPathElements.add(output.getAbsolutePath());
      }
    }
 else     if (rule instanceof HasClasspathEntries) {
      HasClasspathEntries javaLibraryRule=(HasClasspathEntries)rule;
      searchPathElements.addAll(javaLibraryRule.getTransitiveClasspathEntries().values());
    }
 else {
      throw new HumanReadableException("%1$s: Error adding '%2$s' to annotation_processing_deps: " + "must refer only to prebuilt jar, java binary, or java library targets.",ownerTarget,target.getFullyQualifiedName());
    }
  }
  return new AnnotationProcessingParams(ownerTarget,searchPathElements,names,parameters,processOnly);
}
