{
  Builder builder=createDefaultBuilder();
  builder.register(BuildRuleType.JAVA_LIBRARY,new JavaLibraryBuildRuleFactory(javacEnv.getJavacPath(),javacEnv.getJavacVersion()));
  builder.register(BuildRuleType.ANDROID_LIBRARY,new AndroidLibraryBuildRuleFactory(javacEnv.getJavacPath(),javacEnv.getJavacVersion()));
  builder.register(BuildRuleType.ANDROID_BINARY,new AndroidBinaryBuildRuleFactory(JavacOptions.builder(JavacOptions.DEFAULTS).setJavaCompilerEnviornment(javacEnv).build(),buckConfig.getProguardJarOverride()));
  Optional<String> ndkVersion=buckConfig.getNdkVersion();
  if (!ndkVersion.isPresent()) {
    ndkVersion=androidDirectoryResolver.getNdkVersion();
  }
  builder.register(new NdkLibraryDescription(ndkVersion));
  return builder;
}
