{
  HashCode sha1;
  try {
    Optional<Path> relativePath=projectFilesystem.getPathRelativeToProjectRoot(path);
    if (!relativePath.isPresent() || projectFilesystem.isIgnored(relativePath.get())) {
      sha1=getHashCode(path);
    }
 else {
      sha1=loadingCache.get(relativePath.get().normalize());
    }
  }
 catch (  ExecutionException|IOException e) {
    throw new RuntimeException(e);
  }
  return Preconditions.checkNotNull(sha1,"Failed to find a HashCode for %s.",path);
}
