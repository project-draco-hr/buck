{
  ParserAndOptions<T> parserAndOptions=createParser();
  T options=parserAndOptions.options;
  CmdLineParser parser=parserAndOptions.parser;
  boolean hasValidOptions=false;
  try {
    parser.parseArgument(args);
    hasValidOptions=true;
  }
 catch (  CmdLineException e) {
    params.getConsole().getStdErr().println(e.getMessage());
  }
  if (hasValidOptions && !options.showHelp()) {
    return runCommandWithOptions(params,options);
  }
 else {
    printUsage(params,parser);
    return 1;
  }
}
