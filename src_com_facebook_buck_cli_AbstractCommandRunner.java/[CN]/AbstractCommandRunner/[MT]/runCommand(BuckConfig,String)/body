{
  ParserAndOptions<T> parserAndOptions=createParser(buckConfig);
  T options=parserAndOptions.options;
  CmdLineParser parser=parserAndOptions.parser;
  boolean hasValidOptions=false;
  try {
    parser.parseArgument(args);
    hasValidOptions=true;
  }
 catch (  CmdLineException e) {
    console.getStdErr().println(e.getMessage());
  }
  if (hasValidOptions && !options.showHelp()) {
    return runCommandWithOptions(options);
  }
 else {
    printUsage(parser);
    return 1;
  }
}
