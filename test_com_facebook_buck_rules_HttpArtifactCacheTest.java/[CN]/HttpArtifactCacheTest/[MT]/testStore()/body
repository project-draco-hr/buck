{
  connection.setConnectTimeout(1000);
  connection.setDoOutput(true);
  connection.setRequestMethod("POST");
  expect(connection.getOutputStream()).andReturn(nullOutputStream());
  File file=File.createTempFile("000","");
  InputStream is=new ByteArrayInputStream("test".getBytes());
  expect(projectFilesystem.newFileInputStream(file.toPath())).andReturn(is);
  expect(connection.getResponseCode()).andReturn(HttpURLConnection.HTTP_ACCEPTED);
  replay(connection);
  replay(projectFilesystem);
  cache.store(new RuleKey("00000000000000000000000000000000"),file);
  verify(connection);
  verify(projectFilesystem);
}
