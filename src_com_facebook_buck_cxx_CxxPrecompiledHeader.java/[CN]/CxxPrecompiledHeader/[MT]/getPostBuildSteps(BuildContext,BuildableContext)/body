{
  ImmutableMap<Path,Path> replacementPaths;
  try {
    replacementPaths=preprocessorDelegate.getReplacementPaths();
  }
 catch (  AbstractCxxHeaders.ConflictingHeadersException e) {
    throw e.getHumanReadableExceptionForBuildTarget(getBuildTarget());
  }
  Path scratchDir=BuildTargets.getScratchPath(getBuildTarget(),"%s_tmp");
  return ImmutableList.of(new MkdirStep(getProjectFilesystem(),output.getParent()),new MakeCleanDirectoryStep(getProjectFilesystem(),scratchDir),new CxxPreprocessAndCompileStep(getProjectFilesystem(),CxxPreprocessAndCompileStep.Operation.GENERATE_PCH,getPathToOutput(),getDepFilePath(),getResolver().getAbsolutePath(input),inputType,Optional.of(new CxxPreprocessAndCompileStep.ToolCommand(ImmutableList.<String>builder().addAll(preprocessorDelegate.getPreprocessor().getCommandPrefix(getResolver())).addAll(preprocessorDelegate.getFlagsWithSearchPaths().getAllFlags()).build(),preprocessorDelegate.getEnvironment(),preprocessorDelegate.getFlagsForColorDiagnostics())),Optional.<CxxPreprocessAndCompileStep.ToolCommand>absent(),replacementPaths,sanitizer,Optional.<Function<String,Iterable<String>>>absent(),scratchDir));
}
