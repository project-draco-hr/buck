{
  if (assetsDirectories.isEmpty()) {
    return Optional.absent();
  }
  Path destination=getPathToAllAssetsDirectory();
  steps.add(new MakeCleanDirectoryStep(getProjectFilesystem(),destination));
  final ImmutableMap.Builder<Path,Path> allAssets=ImmutableMap.builder();
  for (  final Path assetsDirectory : assetsDirectories) {
    if (!filesystem.exists(assetsDirectory)) {
      continue;
    }
    filesystem.walkRelativeFileTree(assetsDirectory,new SimpleFileVisitor<Path>(){
      @Override public FileVisitResult visitFile(      Path file,      BasicFileAttributes attrs){
        if (!AaptStep.isSilentlyIgnored(file)) {
          allAssets.put(assetsDirectory.relativize(file),file);
        }
        return FileVisitResult.CONTINUE;
      }
    }
);
  }
  for (  Map.Entry<Path,Path> entry : allAssets.build().entrySet()) {
    steps.add(new MkdirAndSymlinkFileStep(getProjectFilesystem(),entry.getValue(),destination.resolve(entry.getKey())));
  }
  return Optional.of(destination);
}
