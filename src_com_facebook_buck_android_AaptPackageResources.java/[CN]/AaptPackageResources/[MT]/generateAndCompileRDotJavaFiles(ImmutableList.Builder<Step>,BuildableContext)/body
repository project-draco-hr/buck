{
  Path rDotJavaSrc=getPathToGeneratedRDotJavaSrcFiles();
  steps.add(new MakeCleanDirectoryStep(rDotJavaSrc));
  Path rDotTxtDir=getPathToRDotTxtDir();
  MergeAndroidResourcesStep mergeStep=new MergeAndroidResourcesStep(resourceDeps,Optional.of(rDotTxtDir.resolve("R.txt")),rDotJavaSrc);
  steps.add(mergeStep);
  if (shouldBuildStringSourceMap) {
    Path outputDirPath=getPathForNativeStringInfoDirectory();
    steps.add(new MakeCleanDirectoryStep(outputDirPath));
    GenStringSourceMapStep genNativeStringInfo=new GenStringSourceMapStep(rDotTxtDir,filteredResourcesProvider.getResDirectories(),outputDirPath);
    steps.add(genNativeStringInfo);
    buildableContext.recordArtifactsInDirectory(outputDirPath);
  }
  Path rDotJavaBin=getPathToCompiledRDotJavaFiles();
  steps.add(new MakeCleanDirectoryStep(rDotJavaBin));
  JavacStep javacStep=RDotJava.createJavacStepForUberRDotJavaFiles(ImmutableSet.copyOf(getResolver().getAllPaths(mergeStep.getRDotJavaFiles())),rDotJavaBin,javac,javacOptions,getBuildTarget());
  steps.add(javacStep);
  Path rDotJavaClassesTxt=getPathToRDotJavaClassesTxt();
  steps.add(new MakeCleanDirectoryStep(rDotJavaClassesTxt.getParent()));
  steps.add(new AccumulateClassNamesStep(Optional.of(rDotJavaBin),rDotJavaClassesTxt));
  buildableContext.recordArtifactsInDirectory(rDotTxtDir);
  buildableContext.recordArtifactsInDirectory(rDotJavaSrc);
  buildableContext.recordArtifactsInDirectory(rDotJavaBin);
  buildableContext.recordArtifact(rDotJavaClassesTxt);
}
