{
  DocumentBuilder docBuilder;
  Transformer transformer;
  try {
    docBuilder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
    transformer=TransformerFactory.newInstance().newTransformer();
  }
 catch (  ParserConfigurationException|TransformerConfigurationException e) {
    throw new RuntimeException(e);
  }
  DOMImplementation domImplementation=docBuilder.getDOMImplementation();
  Document doc=domImplementation.createDocument(null,"Scheme",null);
  doc.setXmlVersion("1.0");
  Element rootElem=doc.getDocumentElement();
  rootElem.setAttribute("LastUpgradeVersion","0500");
  rootElem.setAttribute("version","1.7");
  Element buildActionElem=serializeBuildAction(doc,scheme.getBuildAction());
  rootElem.appendChild(buildActionElem);
  Element testActionElem=serializeTestAction(doc,scheme.getTestAction());
  rootElem.appendChild(testActionElem);
  Element launchActionElem=serializeLaunchAction(doc,scheme.getLaunchAction());
  rootElem.appendChild(launchActionElem);
  Element profileActionElem=serializeProfileAction(doc,scheme.getProfileAction());
  rootElem.appendChild(profileActionElem);
  DOMSource source=new DOMSource(doc);
  StreamResult result=new StreamResult(stream);
  try {
    transformer.transform(source,result);
  }
 catch (  TransformerException e) {
    throw new RuntimeException(e);
  }
}
