{
  Preconditions.checkNotNull(scribeLogger);
  Preconditions.checkNotNull(blacklistCategories);
  Preconditions.checkArgument(maxScribeOfflineLogsKB > 0);
  Preconditions.checkNotNull(projectFilesystem);
  Preconditions.checkNotNull(objectMapper);
  Preconditions.checkNotNull(buildId);
  this.scribeLogger=scribeLogger;
  this.blacklistCategories=blacklistCategories;
  this.maxScribeOfflineLogsBytes=KILO * maxScribeOfflineLogsKB;
  this.filesystem=projectFilesystem;
  this.objectMapper=objectMapper;
  this.logFileStoreStream=null;
  this.storingAvailable=true;
  this.bytesStoredSoFar=0;
  this.startedStoring=false;
  this.startedClosing=false;
  this.logDir=projectFilesystem.getBuckPaths().getOfflineLogDir();
  this.newLogPath=projectFilesystem.resolve(logDir.resolve(LOGFILE_PREFIX + buildId + LOGFILE_SUFFIX));
  this.startedSendingStored=new AtomicBoolean(false);
}
