{
  outputStream.writeInt(arrays.keySet().size());
  if (arrays.keySet().isEmpty()) {
    return;
  }
  int previousResourceId=arrays.keySet().first();
  outputStream.writeInt(previousResourceId);
  try (ByteArrayOutputStream dataStream=new ByteArrayOutputStream()){
    for (    int resourceId : arrays.keySet()) {
      writeShort(outputStream,resourceId - previousResourceId);
      Collection<String> arrayValues=arrays.get(resourceId);
      outputStream.writeInt(arrayValues.size());
      for (      String arrayValue : arrayValues) {
        byte[] byteValue=getUnescapedStringBytes(arrayValue);
        writeShort(outputStream,byteValue.length);
        dataStream.write(byteValue);
      }
      previousResourceId=resourceId;
    }
    outputStream.write(dataStream.toByteArray());
  }
 }
