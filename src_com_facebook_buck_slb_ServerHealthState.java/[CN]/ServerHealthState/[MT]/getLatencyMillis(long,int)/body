{
  int count=0;
  int sum=0;
  long initialMillis=nowMillis - timeRangeMillis;
  ListIterator<LatencySample> iterator=latencies.listIterator(latencies.size());
  while (iterator.hasPrevious()) {
    LatencySample sample=iterator.previous();
    if (sample.getEpochMillis() >= initialMillis && sample.getEpochMillis() <= nowMillis) {
      sum+=sample.getLatencyMillis();
      ++count;
    }
  }
  if (count > 0) {
    return sum / count;
  }
 else {
    return -1;
  }
}
