{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  BuildTarget keystoreTarget=addKeystoreRule(ruleResolver);
  AndroidBinaryRule ruleInRootDirectory=ruleResolver.buildAndAddToIndex(AndroidBinaryRule.newAndroidBinaryRuleBuilder(new FakeBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//:fb4a")).setManifest(new FileSourcePath("AndroidManifest.xml")).setKeystore(keystoreTarget).setTarget("Google Inc.:Google APIs:16"));
  assertEquals(Paths.get(GEN_DIR + "/fb4a.apk"),ruleInRootDirectory.getApkPath());
  AndroidBinaryRule ruleInNonRootDirectory=ruleResolver.buildAndAddToIndex(AndroidBinaryRule.newAndroidBinaryRuleBuilder(new FakeBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//java/com/example:fb4a")).setManifest(new FileSourcePath("AndroidManifest.xml")).setKeystore(keystoreTarget).setTarget("Google Inc.:Google APIs:16"));
  assertEquals(Paths.get(GEN_DIR + "/java/com/example/fb4a.apk"),ruleInNonRootDirectory.getApkPath());
}
