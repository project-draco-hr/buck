{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  AndroidBinaryRule.Builder builder=AndroidBinaryRule.newAndroidBinaryRuleBuilder(new FakeAbstractBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//:fbandroid_with_dash_debug_fbsign")).setManifest("AndroidManifest.xml").setKeystore(addKeystoreRule(ruleResolver)).setTarget("Google Inc:Google APIs:16");
  for (  String filter : cpuFilters) {
    builder.addCpuFilter(filter);
  }
  ImmutableList.Builder<Step> commands=ImmutableList.builder();
  AndroidBinaryRule buildRule=ruleResolver.buildAndAddToIndex(builder);
  buildRule.copyNativeLibrary(sourceDir,destinationDir,commands);
  ImmutableList<Step> steps=commands.build();
  assertEquals(steps.size(),expectedBashCommands.size());
  for (  Step command : commands.build()) {
    assertTrue(expectedBashCommands.contains(((BashStep)command).getShellCommand(createMock(ExecutionContext.class)).get(2)));
  }
}
