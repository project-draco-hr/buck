{
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  RuleKeyBuilderFactory inputBasedRuleKeyBuilderFactory=new InputBasedRuleKeyBuilderFactory(FakeFileHashCache.createFromStrings(ImmutableMap.<String,String>of()),pathResolver);
  FakeBuildRule dep=new FakeBuildRule("//:dep",pathResolver);
  symlinkTreeBuildRule=new SymlinkTree(new FakeBuildRuleParamsBuilder(buildTarget).setDeclaredDeps(ImmutableSortedSet.<BuildRule>of(dep)).build(),new SourcePathResolver(new BuildRuleResolver()),outputPath,links);
  dep.setRuleKey(new RuleKey("aaaa"));
  RuleKey ruleKey1=inputBasedRuleKeyBuilderFactory.build(symlinkTreeBuildRule);
  dep.setRuleKey(new RuleKey("bbbb"));
  RuleKey ruleKey2=inputBasedRuleKeyBuilderFactory.build(symlinkTreeBuildRule);
  assertEquals(ruleKey1,ruleKey2);
}
