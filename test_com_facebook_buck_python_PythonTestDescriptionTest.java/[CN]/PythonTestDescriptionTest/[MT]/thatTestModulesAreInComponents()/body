{
  BuildRuleResolver resolver=new BuildRuleResolver();
  BuildRuleParams params=new FakeBuildRuleParamsBuilder(BuildTargetFactory.newInstance("//:bin")).build();
  PythonTestDescription desc=new PythonTestDescription(PROJECT_FILESYSTEM,PEX_PATH,PEX_EXECUTER_PATH,TEST_MAIN,new PythonEnvironment(Paths.get("fake_python"),PythonVersion.of("Python 2.7")),CXX_PLATFORM,CXX_PLATFORMS);
  PythonTestDescription.Arg arg=desc.createUnpopulatedConstructorArg();
  arg.deps=Optional.of(ImmutableSortedSet.<BuildTarget>of());
  arg.srcs=Optional.of(Either.<ImmutableSortedSet<SourcePath>,ImmutableMap<String,SourcePath>>ofLeft(ImmutableSortedSet.<SourcePath>of(new TestSourcePath("blah.py"))));
  arg.resources=Optional.absent();
  arg.baseModule=Optional.absent();
  arg.contacts=Optional.absent();
  arg.labels=Optional.absent();
  arg.sourceUnderTest=Optional.absent();
  arg.zipSafe=Optional.absent();
  PythonTest testRule=desc.createBuildRule(params,resolver,arg);
  PythonBinary binRule=(PythonBinary)resolver.getRule(desc.getBinaryBuildTarget(testRule.getBuildTarget()));
  assertNotNull(binRule);
  PythonPackageComponents components=binRule.getComponents();
  assertTrue(components.getModules().containsKey(desc.getTestModulesListName()));
  assertTrue(components.getModules().containsKey(desc.getTestMainName()));
  assertEquals(binRule.getMainModule(),PythonUtil.toModuleName(params.getBuildTarget(),desc.getTestMainName().toString()));
}
