{
  for (  SourcePath sourcePath : toCopy) {
    Path absolute=resolver.getAbsolutePath(sourcePath);
    if (absolute.toString().endsWith(Javac.SRC_ZIP) || absolute.toString().endsWith(Javac.SRC_JAR)) {
      steps.add(new UnzipStep(filesystem,absolute,destinationDir));
      continue;
    }
    if (Files.isDirectory(absolute)) {
      throw new HumanReadableException("Cowardly refusing to copy a directory: " + absolute);
    }
    Path destination;
    Path relative=resolver.getRelativePath(sourcePath);
    if (!junkPaths && relative.startsWith(basePath)) {
      destination=basePath.relativize(relative);
    }
 else {
      destination=absolute.getFileName();
    }
    destination=destinationDir.resolve(destination);
    if (destination.getParent() != null) {
      steps.add(new MkdirStep(filesystem,destination.getParent()));
    }
    steps.add(CopyStep.forFile(filesystem,absolute,destination));
  }
}
