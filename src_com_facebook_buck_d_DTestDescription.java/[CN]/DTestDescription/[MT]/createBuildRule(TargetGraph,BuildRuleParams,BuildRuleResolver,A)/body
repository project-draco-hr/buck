{
  BuildTarget target=params.getBuildTarget();
  SourcePathResolver pathResolver=new SourcePathResolver(buildRuleResolver);
  SymlinkTree sourceTree=buildRuleResolver.addToIndex(DDescriptionUtils.createSourceSymlinkTree(DDescriptionUtils.getSymlinkTreeTarget(params.getBuildTarget()),params,pathResolver,args.srcs));
  BuildTarget binaryTarget=DDescriptionUtils.createBuildTargetForFile(target,"build-",target.getFullyQualifiedName(),cxxPlatform);
  ImmutableList<SourcePath> sources=args.srcs.getPaths();
  BuildRule binaryRule=DDescriptionUtils.createNativeLinkable(params.copyWithBuildTarget(binaryTarget),buildRuleResolver,cxxPlatform,dBuckConfig,ImmutableList.of("-unittest"),sources,DIncludes.builder().setLinkTree(new BuildTargetSourcePath(sourceTree.getBuildTarget())).addAllSources(sources).build());
  return new DTest(params.appendExtraDeps(ImmutableList.of(binaryRule)),new SourcePathResolver(buildRuleResolver),binaryRule,args.contacts.get(),args.labels.get(),args.testRuleTimeoutMs.or(defaultTestRuleTimeoutMs),buildRuleResolver.getAllRules(args.sourceUnderTest.or(ImmutableSortedSet.<BuildTarget>of())));
}
