{
  Matcher matcher=SIGNATURE_PATTERN.matcher(source);
  if (!matcher.find()) {
    return SignatureStatus.UNSIGNED;
  }
  if (matcher.groupCount() == 1) {
    String sourceSignature=matcher.group("signature");
    String sourceSignatureReplacedWithToken=matcher.replaceFirst(SIGNED_SOURCE_PLACEHOLDER);
    String expectedSignature=Hashing.md5().hashString(sourceSignatureReplacedWithToken,Charsets.UTF_8).toString();
    if (sourceSignature.equals(expectedSignature)) {
      return SignatureStatus.OK;
    }
  }
  return SignatureStatus.INVALID;
}
