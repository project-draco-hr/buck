{
  List<Predicate<Path>> pathPredicates=Lists.newArrayList();
  final boolean canDownscale=imageScaler != null && imageScaler.isAvailable(context);
  if (filterDrawables) {
    Set<Path> drawables=drawableFinder.findDrawables(inResDirToOutResDirMap.keySet());
    pathPredicates.add(Filters.createImageDensityFilter(drawables,targetDensities,canDownscale));
  }
  if (filterStrings) {
    pathPredicates.add(new Predicate<Path>(){
      @Override public boolean apply(      Path pathRelativeToProjectRoot){
        if (!NON_ENGLISH_STRING_PATH.matcher(pathRelativeToProjectRoot.toString()).matches()) {
          return true;
        }
        for (        Path whitelistedStringDir : whitelistedStringDirs) {
          if (pathRelativeToProjectRoot.startsWith(whitelistedStringDir)) {
            return true;
          }
        }
        nonEnglishStringFilesBuilder.add(pathRelativeToProjectRoot);
        return false;
      }
    }
);
  }
  filteredDirectoryCopier.copyDirs(context.getProjectFilesystem(),inResDirToOutResDirMap,Predicates.and(pathPredicates));
  if (canDownscale && filterDrawables) {
    scaleUnmatchedDrawables(context);
  }
  return 0;
}
