{
  final File javac=temporaryFolder.newFile();
  javac.setExecutable(true);
  FakeBuckConfig buckConfig=new FakeBuckConfig(new HashMap<String,Map<String,String>>(){
{
      put("tools",new HashMap<String,String>(){
{
          put("javac",javac.toString());
        }
      }
);
    }
  }
);
  KnownBuildRuleTypes buildRuleTypes=KnownBuildRuleTypes.getDefault();
  BuildRuleFactory<?> factory=buildRuleTypes.getFactory(BuildRuleType.JAVA_LIBRARY);
  BuildRule rule=factory.newInstance(params).build(new BuildRuleResolver());
  KnownBuildRuleTypes configuredBuildRuleTypes=KnownBuildRuleTypes.createConfiguredBuilder(buckConfig,new FakeProcessExecutor(0,"fakeVersion 0.1",""),Optional.<String>absent()).build();
  BuildRuleFactory<?> configuredFactory=configuredBuildRuleTypes.getFactory(BuildRuleType.JAVA_LIBRARY);
  BuildRule configuredRule=configuredFactory.newInstance(params).build(new BuildRuleResolver());
  assertNotEquals(rule.getRuleKey(),configuredRule.getRuleKey());
}
