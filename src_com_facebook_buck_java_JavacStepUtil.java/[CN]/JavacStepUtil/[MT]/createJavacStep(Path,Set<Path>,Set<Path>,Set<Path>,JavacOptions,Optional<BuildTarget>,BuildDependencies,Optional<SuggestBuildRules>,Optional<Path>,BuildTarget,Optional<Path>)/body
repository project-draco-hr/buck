{
  Compiler compiler;
  if (javacOptions.getJavaCompilerEnvironment().getJavacPath().isPresent()) {
    compiler=new ExternalJavacCompiler(javaSourceFilePaths,javacOptions,invokingRule,pathToSrcsList,buildTarget,workingDirectory);
  }
 else {
    compiler=new Jsr199Compiler(javaSourceFilePaths,invokingRule,pathToSrcsList);
  }
  return new JavacStep(compiler,outputDirectory,javaSourceFilePaths,transitiveClasspathEntries,declaredClasspathEntries,javacOptions,invokingRule,buildDependencies,suggestBuildRules);
}
