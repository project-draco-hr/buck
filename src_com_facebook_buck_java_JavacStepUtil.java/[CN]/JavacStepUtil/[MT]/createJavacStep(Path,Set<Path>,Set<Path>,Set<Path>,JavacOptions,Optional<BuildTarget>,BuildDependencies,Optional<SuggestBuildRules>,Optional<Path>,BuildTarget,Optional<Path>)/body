{
  Javac javac;
  if (javacOptions.getJavaCompilerEnvironment().getJavacPath().isPresent()) {
    javac=new ExternalJavac(javaSourceFilePaths,javacOptions,invokingRule,pathToSrcsList,buildTarget,workingDirectory);
  }
 else {
    javac=new Jsr199Javac(javaSourceFilePaths,invokingRule,pathToSrcsList);
  }
  return new JavacStep(javac,outputDirectory,javaSourceFilePaths,transitiveClasspathEntries,declaredClasspathEntries,javacOptions,invokingRule,buildDependencies,suggestBuildRules);
}
