{
  if (canFit(permits)) {
    size+=permits;
    return Futures.immediateFuture(null);
  }
  SettableFuture<Void> future=SettableFuture.create();
  pending.add(new AbstractMap.SimpleEntry<>(permits,future));
  return future;
}
