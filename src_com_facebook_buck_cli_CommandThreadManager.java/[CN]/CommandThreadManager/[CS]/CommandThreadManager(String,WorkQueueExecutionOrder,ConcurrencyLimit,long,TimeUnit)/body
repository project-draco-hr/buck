{
  this.threadGroup=new ThreadGroup(name);
  this.executor=new WeightedListeningExecutorService(new ListeningSemaphore(concurrencyLimit.threadLimit,ListeningSemaphore.Cap.SOFT,ListeningSemaphore.Fairness.FAIR),1,listeningDecorator(new LimitedThreadPoolExecutor(new ThreadFactoryBuilder().setNameFormat(name + "-%d").setThreadFactory(new CommandThreadFactory(new ThreadFactory(){
    @Override public Thread newThread(    @Nonnull Runnable r){
      return new Thread(threadGroup,r);
    }
  }
)).build(),workQueueExecutionOrder.newWorkQueue(),concurrencyLimit)));
  this.shutdownTimeout=shutdownTimeout;
  this.shutdownTimeoutUnit=shutdownTimeoutUnit;
}
