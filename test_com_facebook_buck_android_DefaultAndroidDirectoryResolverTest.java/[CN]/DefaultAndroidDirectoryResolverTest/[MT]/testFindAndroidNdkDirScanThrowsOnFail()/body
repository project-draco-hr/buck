{
  tmpDir.newFolder("ndk-dir-r9a");
  tmpDir.newFolder("ndk-dir-r9b");
  tmpDir.newFolder("ndk-dir-r9c");
  Path releaseFile=tmpDir.newFile("ndk-dir-r9c/RELEASE.TXT");
  MoreFiles.writeLinesToFile(ImmutableList.of("r9c"),releaseFile);
  PropertyFinder propertyFinder=new FakePropertyFinder(ImmutableMap.of("ndk.dir",Optional.<Path>absent(),"ndk.repository",Optional.of(tmpDir.getRoot())));
  DefaultAndroidDirectoryResolver androidDirectoryResolver=new DefaultAndroidDirectoryResolver(new ProjectFilesystem(tmpDir.getRoot()),Optional.of("r9e"),propertyFinder);
  try {
    androidDirectoryResolver.findAndroidNdkDir();
    fail("Should have thrown an exception for malformed NDK directory.");
  }
 catch (  Exception e) {
    assertEquals("Couldn't find a valid NDK under " + tmpDir.getRoot().toAbsolutePath(),e.getMessage());
  }
}
