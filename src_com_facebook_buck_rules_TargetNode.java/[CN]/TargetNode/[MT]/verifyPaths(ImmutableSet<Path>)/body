{
  Path basePath=getBuildTarget().getBasePath();
  BuildFileTree buildFileTree=ruleFactoryParams.getBuildFileTree();
  for (  Path path : paths) {
    if (!basePath.toString().isEmpty() && !path.startsWith(basePath)) {
      throw new InvalidSourcePathInputException("'%s' in '%s' refers to a parent directory.",basePath.relativize(path),getBuildTarget());
    }
    Optional<Path> ancestor=buildFileTree.getBasePathOfAncestorTarget(path);
    if (!ancestor.isPresent() || !ancestor.get().equals(basePath)) {
      throw new InvalidSourcePathInputException("'%s' in '%s' crosses a buck package boundary. Find the nearest BUCK file in the " + "directory that contains this file and refer to the rule referencing the desired" + "file.",path,getBuildTarget());
    }
  }
  return paths;
}
