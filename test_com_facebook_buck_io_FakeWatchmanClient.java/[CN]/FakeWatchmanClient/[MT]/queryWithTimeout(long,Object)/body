{
  if (queryElapsedTimeNanos > timeoutNanos) {
    return Optional.absent();
  }
  if (exceptionToThrow != null) {
    if (exceptionToThrow instanceof IOException) {
      throw (IOException)exceptionToThrow;
    }
 else     if (exceptionToThrow instanceof InterruptedException) {
      throw (InterruptedException)exceptionToThrow;
    }
 else {
      throw new RuntimeException("Invalid exception");
    }
  }
  return Optional.fromNullable(queryResults.get(ImmutableList.copyOf(query)));
}
