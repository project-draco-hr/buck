{
  if (projectRoot.resolve(".hg").toFile().exists()) {
    HgCmdLineInterface hgCmdLineInterface=new HgCmdLineInterface(processExecutor,projectRoot.toFile(),hgCmd);
    try {
      hgCmdLineInterface.currentRevisionId();
      LOG.debug("Using HgCmdLineInterface.");
      return hgCmdLineInterface;
    }
 catch (    VersionControlCommandFailedException ex) {
      LOG.warn("Project contains a .hg file, but could not read current revision " + " due to exception %s",ex);
    }
  }
  LOG.debug("Using NoOpCmdLineInterface.");
  return new NoOpCmdLineInterface();
}
