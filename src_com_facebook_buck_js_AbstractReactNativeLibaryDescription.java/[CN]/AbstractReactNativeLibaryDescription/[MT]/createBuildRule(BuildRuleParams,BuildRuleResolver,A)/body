{
  BuildTarget originalBuildTarget=params.getBuildTarget();
  SourcePathResolver sourcePathResolver=new SourcePathResolver(resolver);
  boolean devMode=originalBuildTarget.getFlavors().contains(DEV);
  BuildTarget depsFinderTarget=BuildTarget.builder(originalBuildTarget).addFlavors(REACT_NATIVE_DEPS_FLAVOR).build();
  BuildRuleParams paramsForDepsFinder=params.copyWithBuildTarget(depsFinderTarget);
  ReactNativeDeps depsFinder=new ReactNativeDeps(paramsForDepsFinder,sourcePathResolver,getPackager(),args.srcs.get(),args.entryPath,platform);
  resolver.addToIndex(depsFinder);
  return new ReactNativeLibrary(params.copyWithExtraDeps(Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of(depsFinder))),new SourcePathResolver(resolver),args.entryPath,devMode,args.bundleName,getPackager(),platform,depsFinder);
}
