{
  Set<Flavor> flavors=Sets.newHashSet(params.getBuildTarget().getFlavors());
  flavors.remove(CxxCompilationDatabase.COMPILATION_DATABASE);
  BuildTarget target=BuildTarget.builder(params.getBuildTarget().getUnflavoredBuildTarget()).addAllFlavors(flavors).build();
  BuildRuleParams paramsWithoutCompilationDatabaseFlavor=params.copyWithChanges(params.getBuildRuleType(),target,Suppliers.ofInstance(params.getDeclaredDeps()),Suppliers.ofInstance(params.getExtraDeps()));
  requireObjects(paramsWithoutCompilationDatabaseFlavor,ruleResolver,pathResolver,cxxPlatform,lexSources,yaccSources,preprocessorFlags,prefixHeaders,headers,exportedHeaders,compilerFlags,sources,frameworkSearchPaths,compileStrategy,CxxSourceRuleFactory.PicType.PIC);
  return CxxCompilationDatabase.createCompilationDatabase(params,ruleResolver,pathResolver,compileStrategy);
}
