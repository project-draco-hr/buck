{
  if (workingDirectory == null) {
    workingDirectory=Files.createTempDir();
    workingDirectory.deleteOnExit();
  }
  ShellStep unzip=new UnzipStep(inputFile,workingDirectory.getAbsolutePath(),true,entries);
  ShellStep cp=new CopyStep(inputFile,outputFile);
  ShellStep zip=new ZipStep(ZipStep.Mode.ADD,new File(outputFile).getAbsolutePath(),entries,false,compressionLevel,workingDirectory.getAbsoluteFile());
  return ImmutableList.of(unzip,cp,zip);
}
