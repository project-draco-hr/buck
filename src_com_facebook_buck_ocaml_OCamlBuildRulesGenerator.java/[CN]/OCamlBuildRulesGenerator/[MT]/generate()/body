{
  ImmutableList.Builder<BuildRule> rules=ImmutableList.builder();
  ImmutableList<SourcePath> cmxFiles=generateMLNativeCompilation(mlInput);
  ImmutableList<SourcePath> objFiles=generateCCompilation(cInput);
  BuildRule link=generateNativeLinking(ImmutableList.<SourcePath>builder().addAll(Iterables.concat(cmxFiles,objFiles)).build());
  rules.add(link);
  ImmutableList<SourcePath> cmoFiles=generateMLBytecodeCompilation(mlInput);
  BuildRule bytecodeLink=generateBytecodeLinking(ImmutableList.<SourcePath>builder().addAll(Iterables.concat(cmoFiles,objFiles)).build());
  rules.add(bytecodeLink);
  if (!ocamlContext.isLibrary()) {
    rules.add(generateDebugLauncherRule());
  }
  return OCamlGeneratedBuildRules.builder().setRules(rules.build()).setNativeCompileDeps(ImmutableSortedSet.copyOf(pathResolver.filterBuildRuleInputs(cmxFiles))).setBytecodeCompileDeps(ImmutableSortedSet.copyOf(pathResolver.filterBuildRuleInputs(cmoFiles))).setObjectFiles(objFiles).setBytecodeLink(bytecodeLink).build();
}
