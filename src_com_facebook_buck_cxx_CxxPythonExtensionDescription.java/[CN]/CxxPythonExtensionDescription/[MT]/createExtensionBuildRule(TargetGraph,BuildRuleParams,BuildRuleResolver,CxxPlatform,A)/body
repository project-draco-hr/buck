{
  SourcePathResolver pathResolver=new SourcePathResolver(ruleResolver);
  ImmutableMap<String,CxxSource> srcs=CxxDescriptionEnhancer.parseCxxSources(params,ruleResolver,cxxPlatform,args);
  ImmutableMap<Path,SourcePath> headers=CxxDescriptionEnhancer.parseHeaders(params,ruleResolver,cxxPlatform,args);
  ImmutableMap<String,SourcePath> lexSrcs=CxxDescriptionEnhancer.parseLexSources(params,ruleResolver,args);
  ImmutableMap<String,SourcePath> yaccSrcs=CxxDescriptionEnhancer.parseYaccSources(params,ruleResolver,args);
  CxxHeaderSourceSpec lexYaccSources=CxxDescriptionEnhancer.createLexYaccBuildRules(params,ruleResolver,cxxPlatform,ImmutableList.<String>of(),lexSrcs,ImmutableList.<String>of(),yaccSrcs);
  HeaderSymlinkTree headerSymlinkTree=CxxDescriptionEnhancer.requireHeaderSymlinkTree(params,ruleResolver,new SourcePathResolver(ruleResolver),cxxPlatform,true,lexSrcs,yaccSrcs,headers,HeaderVisibility.PRIVATE);
  ImmutableList<CxxPreprocessorInput> cxxPreprocessorInput=CxxDescriptionEnhancer.collectCxxPreprocessorInput(targetGraph,params,cxxPlatform,CxxFlags.getLanguageFlags(args.preprocessorFlags,args.platformPreprocessorFlags,args.langPreprocessorFlags,cxxPlatform),ImmutableList.of(headerSymlinkTree),ImmutableSet.<Path>of(),CxxPreprocessables.getTransitiveCxxPreprocessorInput(targetGraph,cxxPlatform,params.getDeps()));
  ImmutableMap<String,CxxSource> allSources=ImmutableMap.<String,CxxSource>builder().putAll(srcs).putAll(lexYaccSources.getCxxSources()).build();
  ImmutableMap<CxxPreprocessAndCompile,SourcePath> picObjects=CxxSourceRuleFactory.requirePreprocessAndCompileRules(params,ruleResolver,pathResolver,cxxPlatform,cxxPreprocessorInput,CxxFlags.getFlags(args.compilerFlags,args.platformCompilerFlags,cxxPlatform),args.prefixHeader,cxxBuckConfig.getPreprocessMode(),allSources,CxxSourceRuleFactory.PicType.PIC);
  String extensionName=getExtensionName(params.getBuildTarget());
  Path extensionPath=getExtensionPath(params.getBuildTarget(),cxxPlatform.getFlavor());
  return CxxLinkableEnhancer.createCxxLinkableBuildRule(targetGraph,cxxPlatform,params,pathResolver,CxxFlags.getFlags(args.linkerFlags,args.platformLinkerFlags,cxxPlatform),getExtensionTarget(params.getBuildTarget(),cxxPlatform.getFlavor()),Linker.LinkType.SHARED,Optional.of(extensionName),extensionPath,picObjects.values(),ImmutableList.<SourcePath>of(),Linker.LinkableDepType.SHARED,params.getDeps(),args.cxxRuntimeType,Optional.<SourcePath>absent(),ImmutableSet.<BuildRule>of());
}
