def _bunser_template(buf, pos):
    if (buf[(pos + 1)] != BSER_ARRAY):
        raise RuntimeError('Expect ARRAY to follow TEMPLATE')
    (keys, pos) = _bunser_array(buf, (pos + 1))
    (nitems, pos) = _bunser_int(buf, pos)
    arr = []
    for i in range(nitems):
        obj = {}
        for keyidx in range(len(keys)):
            if (buf[pos] == BSER_SKIP):
                pos += 1
                continue
            key = keys[keyidx]
            (ele, pos) = _bser_loads_recursive(buf, pos)
            obj[key] = ele
        arr.append(obj)
    return (arr, pos)
