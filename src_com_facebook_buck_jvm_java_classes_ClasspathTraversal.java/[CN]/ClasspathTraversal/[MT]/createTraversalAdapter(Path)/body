{
  String extension=MorePaths.getFileExtension(path);
  if (Files.isDirectory(path)) {
    return new DirectoryTraversalAdapter(path);
  }
 else   if (Files.isRegularFile(path)) {
    if (extension.equalsIgnoreCase("jar") || extension.equalsIgnoreCase("zip")) {
      return new ZipFileTraversalAdapter(path);
    }
 else {
      return new FileTraversalAdapter(path);
    }
  }
 else {
    throw new IllegalArgumentException("Unsupported classpath traversal input: " + path);
  }
}
