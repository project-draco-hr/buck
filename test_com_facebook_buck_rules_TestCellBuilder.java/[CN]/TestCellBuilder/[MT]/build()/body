{
  ProcessExecutor executor=new ProcessExecutor(new TestConsole());
  BuckConfig config=buckConfig == null ? FakeBuckConfig.builder().setFilesystem(filesystem).build() : buckConfig;
  KnownBuildRuleTypesFactory typesFactory=new KnownBuildRuleTypesFactory(executor,androidDirectoryResolver,Optional.<Path>absent());
  if (parserFactory == null) {
    return new Cell(filesystem,new TestConsole(),NULL_WATCHMAN,config,typesFactory,androidDirectoryResolver,new FakeClock(0));
  }
  return new Cell(filesystem,new TestConsole(),NULL_WATCHMAN,config,typesFactory,androidDirectoryResolver,new FakeClock(0)){
    @Override protected ProjectBuildFileParserFactory createBuildFileParserFactory(    boolean watchmanGlob){
      return parserFactory;
    }
  }
;
}
