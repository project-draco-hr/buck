{
  ImmutableList.Builder<Step> commands=ImmutableList.builder();
  commands.add(new SleepingStep(0,0));
  commands.add(new SleepingStep(10,1));
  commands.add(new SleepingStep(5000,1));
  ExecutionContext context=ExecutionContext.builder().setVerbosity(Verbosity.SILENT).setProjectFilesystem(EasyMock.createMock(ProjectFilesystem.class)).setConsole(new Console(System.out,System.err,Ansi.withoutTty())).build();
  ThreadFactory threadFactory=new ThreadFactoryBuilder().setDaemon(true).setNameFormat(getClass().getSimpleName() + "-%d").build();
  ListeningExecutorService executorService=MoreExecutors.listeningDecorator(Executors.newFixedThreadPool(3,threadFactory));
  DefaultStepRunner runner=new DefaultStepRunner(context,executorService);
  runner.runCommandsInParallelAndWait(commands.build());
}
