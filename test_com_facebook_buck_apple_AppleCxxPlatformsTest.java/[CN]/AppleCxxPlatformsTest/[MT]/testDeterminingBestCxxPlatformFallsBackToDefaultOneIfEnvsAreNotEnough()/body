{
  CxxPlatform defaultPlatform=createCxxPlatformWithFlavor(ImmutableFlavor.builder().name("default").build());
  ImmutableMap.Builder<Flavor,CxxPlatform> platformBuilder=ImmutableMap.<Flavor,CxxPlatform>builder();
  addCxxPlatformWithFlavour(ImmutableFlavor.builder().name("iphoneos-arm64").build(),platformBuilder);
  addCxxPlatformWithFlavour(ImmutableFlavor.builder().name("iphonesimulator-i386").build(),platformBuilder);
  addCxxPlatformWithFlavour(ImmutableFlavor.builder().name("macosx-x86_64").build(),platformBuilder);
  CxxPlatform bestPlatform=AppleCxxPlatforms.determineBestPlatform(ImmutableMap.<String,String>builder().build(),defaultPlatform,platformBuilder.build());
  assertThat(bestPlatform.getFlavor().getName(),Matchers.equalTo("default"));
}
