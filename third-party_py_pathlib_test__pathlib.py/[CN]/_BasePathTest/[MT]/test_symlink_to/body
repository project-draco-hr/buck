@with_symlinks
def test_symlink_to(self):
    P = self.cls(BASE)
    target = (P / 'fileA')
    link = ((P / 'dirA') / 'linkAA')
    link.symlink_to(target)
    self.assertEqual(link.stat(), target.stat())
    self.assertNotEqual(link.lstat(), target.stat())
    link = ((P / 'dirA') / 'linkAAA')
    link.symlink_to(str(target))
    self.assertEqual(link.stat(), target.stat())
    self.assertNotEqual(link.lstat(), target.stat())
    self.assertFalse(link.is_dir())
    target = (P / 'dirB')
    link = ((P / 'dirA') / 'linkAAAA')
    link.symlink_to(target, target_is_directory=True)
    self.assertEqual(link.stat(), target.stat())
    self.assertNotEqual(link.lstat(), target.stat())
    self.assertTrue(link.is_dir())
    self.assertTrue(list(link.iterdir()))
