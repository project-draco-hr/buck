{
  eventBus=BuckEventBusFactory.newInstance();
  projectFilesystem=FakeProjectFilesystem.createJavaOnlyFilesystem("/first");
  javaFs=projectFilesystem.getRootPath().getFileSystem();
  secondProjectFilesystem=FakeProjectFilesystem.createJavaOnlyFilesystem("/second");
  secondJavaFs=secondProjectFilesystem.getRootPath().getFileSystem();
  buildRuleResolver=new BuildRuleResolver(TargetGraph.EMPTY,new DefaultTargetNodeToBuildRuleTransformer());
  sourcePathResolver=new SourcePathResolver(buildRuleResolver);
  setUpRules(buildRuleResolver,sourcePathResolver);
  actionGraph=new ActionGraph(buildRuleResolver.getBuildRules());
  distributedBuildFileHashes=new DistributedBuildFileHashes(actionGraph,sourcePathResolver,createFileHashCache(),MoreExecutors.newDirectExecutorService(),0);
}
