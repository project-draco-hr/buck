{
  eventBus=BuckEventBusFactory.newInstance();
  projectFilesystem=first;
  javaFs=projectFilesystem.getRootPath().getFileSystem();
  secondProjectFilesystem=second;
  secondJavaFs=secondProjectFilesystem.getRootPath().getFileSystem();
  buildRuleResolver=new BuildRuleResolver(TargetGraph.EMPTY,new DefaultTargetNodeToBuildRuleTransformer());
  sourcePathResolver=new SourcePathResolver(buildRuleResolver);
  setUpRules(buildRuleResolver,sourcePathResolver);
  actionGraph=new ActionGraph(buildRuleResolver.getBuildRules());
  distributedBuildFileHashes=new DistributedBuildFileHashes(actionGraph,sourcePathResolver,createFileHashCache(),MoreExecutors.newDirectExecutorService(),0);
}
