{
  FakeProcess fakeProcess=processMap.get(params);
  if (fakeProcess == null) {
    throw new RuntimeException(String.format("Unexpected params: %s",params));
  }
  launchedProcesses.add(params);
  try {
    String stderr=new String(ByteStreams.toByteArray(fakeProcess.getErrorStream()),UTF_8);
    String stdout=new String(ByteStreams.toByteArray(fakeProcess.getInputStream()),UTF_8);
    return new Result(fakeProcess.waitFor(),stdout,stderr);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
