{
  int numWritten=0;
  for (  DepsForBuildFiles.BuildFileWithDeps buildFileWithDeps : buildFilesWithDeps) {
    Path generatedFile=buildFileWithDeps.getCellPath().resolve(buildFileWithDeps.getBasePath()).resolve(autodepsFileName);
    SortedMap<String,Object> deps=new TreeMap<>();
    for (    DepsForBuildFiles.DepsForRule depsForRule : buildFileWithDeps) {
      Iterable<BuildTarget> depsAsBuildTargets=depsForRule;
      List<String> depsAsStrings=FluentIterable.from(depsAsBuildTargets).transform(Functions.toStringFunction()).toList();
      deps.put(depsForRule.getShortName(),depsAsStrings);
    }
    if (writeSignedFile(deps,generatedFile,mapper)) {
      numWritten++;
    }
  }
  return numWritten;
}
