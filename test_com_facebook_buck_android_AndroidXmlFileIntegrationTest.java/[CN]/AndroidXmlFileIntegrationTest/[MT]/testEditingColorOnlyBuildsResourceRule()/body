{
  String layoutXmlFileContents=workspace.getFileContents(PATH_TO_LAYOUT_XML);
  layoutXmlFileContents=layoutXmlFileContents.replace("white","black");
  workspace.writeContentsToPath(layoutXmlFileContents,PATH_TO_LAYOUT_XML);
  workspace.resetBuildLogFile();
  workspace.runBuckCommand("build",MAIN_BUILD_TARGET);
  Map<BuildTarget,Optional<BuildRuleSuccess.Type>> successTypes=workspace.getBuildRuleSuccessTypes();
  assertEquals(BuildRuleSuccess.Type.MATCHING_DEPS_ABI_AND_RULE_KEY_NO_DEPS,successTypes.get(BuildTargetFactory.newInstance(MAIN_BUILD_TARGET)).get());
  assertEquals(BuildRuleSuccess.Type.MATCHING_DEPS_ABI_AND_RULE_KEY_NO_DEPS,successTypes.get(BuildTargetFactory.newInstance("//java/com/sample/lib:lib#dummy_r_dot_java")).get());
  assertEquals(BuildRuleSuccess.Type.BUILT_LOCALLY,successTypes.get(BuildTargetFactory.newInstance("//res/com/sample/top:top")).get());
  assertEquals(BuildRuleSuccess.Type.MATCHING_RULE_KEY,successTypes.get(BuildTargetFactory.newInstance("//res/com/sample/base:base")).get());
}
