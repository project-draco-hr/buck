{
  this.service=service;
  this.buildMode=buildMode;
  this.depFiles=depFiles;
  this.pathResolver=pathResolver;
  this.fileHashCaches=createFileHashCacheLoader(fileHashCache);
  this.ruleKeyFactories=CacheBuilder.newBuilder().build(new CacheLoader<ProjectFilesystem,RuleKeyFactories>(){
    @Override public RuleKeyFactories load(    ProjectFilesystem filesystem) throws Exception {
      return ruleKeyFactoriesFunction.apply(filesystem);
    }
  }
);
}
