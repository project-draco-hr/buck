{
  Preconditions.checkState(useDependencyFileRuleKey(rule));
  if (!depFile.isPresent()) {
    return Optional.absent();
  }
  RuleKeyFactories cellData=this.ruleKeyFactories;
  Preconditions.checkNotNull(cellData);
  ImmutableList<Path> inputs=FluentIterable.from(depFile.get()).transform(MorePaths.TO_PATH).toList();
  RuleKeyBuilder builder=cellData.depFileRuleKeyBuilderFactory.newInstance(rule);
  for (  Path input : inputs) {
    try {
      builder.setPath(rule.getProjectFilesystem().resolve(input),input);
    }
 catch (    NoSuchFileException e) {
      if (!allowMissingInputs) {
        throw e;
      }
      return Optional.absent();
    }
  }
  return Optional.of(builder.build());
}
