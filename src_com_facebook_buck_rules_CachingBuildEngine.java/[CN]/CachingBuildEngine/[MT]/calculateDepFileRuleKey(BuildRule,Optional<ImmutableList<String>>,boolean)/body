{
  Preconditions.checkState(useDependencyFileRuleKey(rule));
  if (!depFile.isPresent()) {
    return Optional.absent();
  }
  ImmutableList<Path> inputs=FluentIterable.from(depFile.get()).transform(MorePaths.TO_PATH).toList();
  RuleKey.Builder builder=depFileRuleKeyBuilderFactory.newInstance(rule);
  for (  Path input : inputs) {
    try {
      builder.setPath(input);
    }
 catch (    NoSuchFileException e) {
      if (!allowMissingInputs) {
        throw e;
      }
      return Optional.absent();
    }
  }
  return Optional.of(builder.build());
}
