{
  BuildTarget other;
  try {
    other=parser.parse(input,BuildTargetPatternParser.forBaseName(target.getBaseName()));
  }
 catch (  BuildTargetParseException e) {
    throw new MacroException(e.getMessage(),e);
  }
  Optional<BuildRule> rule=resolver.getRuleOptional(other);
  if (!rule.isPresent()) {
    throw new MacroException(String.format("no rule %s",other));
  }
  return expand(filesystem,rule.get());
}
