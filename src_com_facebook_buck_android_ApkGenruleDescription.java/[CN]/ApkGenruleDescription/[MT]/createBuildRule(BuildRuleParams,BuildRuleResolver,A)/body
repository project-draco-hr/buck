{
  if (!(args.apk instanceof InstallableApk)) {
    throw new HumanReadableException("The 'apk' argument of %s, %s, must correspond to an " + "installable rule, such as android_binary() or apk_genrule().",params.getBuildTarget(),args.apk.getFullyQualifiedName());
  }
  InstallableApk installableApk=(InstallableApk)args.apk;
  ImmutableList<SourcePath> srcs=args.srcs.get();
  ImmutableSortedSet<BuildRule> extraDeps=ImmutableSortedSet.<BuildRule>naturalOrder().addAll(SourcePaths.filterBuildRuleInputs(srcs)).add(installableApk).build();
  return new ApkGenrule(params.copyWithExtraDeps(extraDeps),srcs,args.cmd,args.bash,args.cmdExe,params.getPathAbsolutifier(),installableApk);
}
