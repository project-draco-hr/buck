{
  String excludedLabel="exclude_me";
  BuckConfig config=new BuckConfig(ImmutableMap.<String,Map<String,String>>of("test",ImmutableMap.of("excluded_labels",excludedLabel)),null);
  assertThat(config.getDefaultExcludedLabels(),contains(excludedLabel));
  TestCommandOptions options=new TestCommandOptions(config);
  new CmdLineParserAdditionalOptions(options).parseArgument("//example:test");
  FakeTestRule rule=new FakeTestRule(new BuildRuleType("java_test"),ImmutableSet.of(excludedLabel),BuildTargetFactory.newInstance("//example:test"),ImmutableSortedSet.<BuildRule>of(),ImmutableSet.<BuildTargetPattern>of());
  Iterable<TestRule> filtered=TestCommand.filterTestRules(options,ImmutableSet.<TestRule>of(rule));
  assertEquals(rule,Iterables.getOnlyElement(filtered));
}
