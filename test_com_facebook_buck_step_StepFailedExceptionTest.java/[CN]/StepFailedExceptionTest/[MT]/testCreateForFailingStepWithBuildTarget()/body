{
  final int exitCode=17;
  Step step=new FakeStep("cp","cp foo bar",exitCode);
  ExecutionContext context=TestExecutionContext.newInstance();
  BuildTarget buildTarget=new BuildTarget("//foo","bar");
  StepFailedException exception=StepFailedException.createForFailingStepWithException(step,context,new IOException("Copy failed!"),Optional.of(buildTarget));
  assertEquals(step,exception.getStep());
  assertEquals(1,exception.getExitCode());
  assertEquals("//foo:bar failed on step cp with an exception:\nCopy failed!",exception.getMessage());
}
