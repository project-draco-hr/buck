{
  if (rule.getType().equals(AppleBundleDescription.TYPE)) {
    AppleBundle bundle=(AppleBundle)rule;
    AppleBundleExtension extension=bundle.getExtensionValue().or(AppleBundleExtension.BUNDLE);
switch (extension) {
case FRAMEWORK:
      return Optional.of(PBXCopyFilesBuildPhase.Destination.FRAMEWORKS);
case APPEX:
case PLUGIN:
    return Optional.of(PBXCopyFilesBuildPhase.Destination.PLUGINS);
case APP:
  return Optional.of(PBXCopyFilesBuildPhase.Destination.EXECUTABLES);
default :
return Optional.of(PBXCopyFilesBuildPhase.Destination.PRODUCTS);
}
}
 else if (rule.getType().equals(IosLibraryDescription.TYPE)) {
IosLibrary library=(IosLibrary)rule;
if (library.getLinkedDynamically()) {
return Optional.of(PBXCopyFilesBuildPhase.Destination.FRAMEWORKS);
}
 else {
return Optional.absent();
}
}
 else {
throw new RuntimeException("Unexpected type: " + rule.getType());
}
}
