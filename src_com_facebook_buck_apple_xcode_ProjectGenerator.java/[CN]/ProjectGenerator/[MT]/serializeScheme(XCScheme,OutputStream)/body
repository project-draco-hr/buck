{
  DocumentBuilder docBuilder;
  Transformer transformer;
  try {
    docBuilder=DocumentBuilderFactory.newInstance().newDocumentBuilder();
    transformer=TransformerFactory.newInstance().newTransformer();
  }
 catch (  ParserConfigurationException|TransformerConfigurationException e) {
    throw new RuntimeException(e);
  }
  DOMImplementation domImplementation=docBuilder.getDOMImplementation();
  Document doc=domImplementation.createDocument(null,"Scheme",null);
  doc.setXmlVersion("1.0");
  Element rootElem=doc.getDocumentElement();
  rootElem.setAttribute("LastUpgradeVersion","0500");
  rootElem.setAttribute("version","1.7");
  Element buildActionElem=doc.createElement("BuildAction");
  rootElem.appendChild(buildActionElem);
  buildActionElem.setAttribute("parallelizeBuildables","NO");
  buildActionElem.setAttribute("buildImplicitDependencies","NO");
  Element buildActionEntriesElem=doc.createElement("BuildActionEntries");
  buildActionElem.appendChild(buildActionEntriesElem);
  for (  XCScheme.BuildActionEntry entry : scheme.getBuildAction()) {
    Element entryElem=doc.createElement("BuildActionEntry");
    buildActionEntriesElem.appendChild(entryElem);
    entryElem.setAttribute("buildForRunning","YES");
    entryElem.setAttribute("buildForTesting","YES");
    entryElem.setAttribute("buildForProfiling","YES");
    entryElem.setAttribute("buildForArchiving","YES");
    entryElem.setAttribute("buildForAnalyzing","YES");
    Element refElem=doc.createElement("BuildableReference");
    entryElem.appendChild(refElem);
    refElem.setAttribute("BuildableIdentifier","primary");
    refElem.setAttribute("BlueprintIdentifier",entry.getBlueprintIdentifier());
    refElem.setAttribute("referencedContainer","container:" + entry.getContainerRelativePath());
  }
  DOMSource source=new DOMSource(doc);
  StreamResult result=new StreamResult(stream);
  try {
    transformer.transform(source,result);
  }
 catch (  TransformerException e) {
    throw new RuntimeException(e);
  }
}
