{
  ImmutableList.Builder<SourceTreePath> sourceTreePathBuilder=ImmutableList.builder();
  for (  String framework : frameworks) {
    Path path=Paths.get(framework);
    String firstElement=Preconditions.checkNotNull(Iterables.getFirst(path,Paths.get(""))).toString();
    if (firstElement.charAt(0) == '$') {
      Optional<PBXReference.SourceTree> sourceTree=PBXReference.SourceTree.fromBuildSetting(firstElement);
      if (sourceTree.isPresent() && (sourceTree.get() == PBXReference.SourceTree.BUILT_PRODUCTS_DIR || sourceTree.get() == PBXReference.SourceTree.ABSOLUTE)) {
        Path sdkRootRelativePath=path.subpath(1,path.getNameCount());
        sourceTreePathBuilder.add(new SourceTreePath(sourceTree.get(),sdkRootRelativePath));
      }
    }
 else {
      sourceTreePathBuilder.add(new SourceTreePath(PBXReference.SourceTree.GROUP,relativizeBuckRelativePathToGeneratedProject(buildTarget,path.toString())));
    }
  }
  addCopyFilesBuildPhase(target,sharedFrameworksGroup,PBXCopyFilesBuildPhase.Destination.FRAMEWORKS,"",sourceTreePathBuilder.build());
}
