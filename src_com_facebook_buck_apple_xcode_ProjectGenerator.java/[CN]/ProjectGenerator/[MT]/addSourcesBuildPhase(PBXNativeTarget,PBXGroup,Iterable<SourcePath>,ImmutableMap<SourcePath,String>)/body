{
  PBXGroup sourcesGroup=targetGroup.getOrCreateChildGroupByName("Sources");
  PBXSourcesBuildPhase sourcesBuildPhase=new PBXSourcesBuildPhase();
  target.getBuildPhases().add(sourcesBuildPhase);
  for (  SourcePath sourcePath : sources) {
    Path path=sourcePath.resolve(partialGraph.getDependencyGraph());
    PBXFileReference fileReference=sourcesGroup.getOrCreateFileReferenceBySourceTreePath(SourceTreePath.absolute(projectFilesystem.getPathForRelativePath(path)));
    PBXBuildFile buildFile=new PBXBuildFile(fileReference);
    sourcesBuildPhase.getFiles().add(buildFile);
    String customFlags=sourceFlags.get(sourcePath);
    if (customFlags != null) {
      NSDictionary settings=new NSDictionary();
      settings.put("COMPILER_FLAGS",customFlags);
      buildFile.setSettings(Optional.of(settings));
    }
  }
}
