{
  BuildRule binary=bundle.getBinary();
  if (bundle.getExtensionValue().isPresent()) {
    AppleBundleExtension extension=bundle.getExtensionValue().get();
    if (binary.getType().equals(AppleLibraryDescription.TYPE)) {
      AppleLibrary library=(AppleLibrary)binary;
      if (library.getLinkedDynamically()) {
switch (extension) {
case FRAMEWORK:
          return PBXTarget.ProductType.FRAMEWORK;
case APPEX:
        return PBXTarget.ProductType.APP_EXTENSION;
case BUNDLE:
      return PBXTarget.ProductType.BUNDLE;
case OCTEST:
    return PBXTarget.ProductType.BUNDLE;
case XCTEST:
  return PBXTarget.ProductType.UNIT_TEST;
}
}
 else {
switch (extension) {
case FRAMEWORK:
return PBXTarget.ProductType.STATIC_FRAMEWORK;
}
}
}
 else if (binary.getType().equals(AppleBinaryDescription.TYPE)) {
switch (extension) {
case APP:
return PBXTarget.ProductType.APPLICATION;
}
}
}
return PBXTarget.ProductType.BUNDLE;
}
