{
  ActionGraphEvent.Started started=ActionGraphEvent.started();
  eventBus.post(started);
  Pair<TargetGraph,ActionGraphAndResolver> newActionGraph=new Pair<TargetGraph,ActionGraphAndResolver>(targetGraph,createActionGraph(eventBus,new DefaultTargetNodeToBuildRuleTransformer(),targetGraph));
  if (lastActionGraph != null && lastActionGraph.getFirst().equals(targetGraph)) {
    cacheHitCounter.inc();
  }
 else {
    cacheMissCounter.inc();
  }
  lastActionGraph=newActionGraph;
  eventBus.post(ActionGraphEvent.finished(started));
  return lastActionGraph.getSecond();
}
