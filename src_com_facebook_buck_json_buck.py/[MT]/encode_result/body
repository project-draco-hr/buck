def encode_result(values, diagnostics):
    result = {'values': values, }
    if diagnostics:
        encoded_diagnostics = []
        for d in diagnostics:
            encoded_diagnostics.append({'message': d.message, 'level': d.level, })
        result['diagnostics'] = encoded_diagnostics
    return bser.dumps(result)
