{
  if (resources.isEmpty()) {
    return;
  }
  PBXGroup resourcesGroup=targetGroup.getOrCreateChildGroupByName("Resources");
  for (  AppleResourceDescription.Arg resource : resources) {
    Iterable<Path> paths=Iterables.transform(Iterables.concat(resource.files,resource.dirs),sourcePathResolver);
    for (    Path path : paths) {
      PBXFileReference fileReference=resourcesGroup.getOrCreateFileReferenceBySourceTreePath(new SourceTreePath(PBXReference.SourceTree.SOURCE_ROOT,pathRelativizer.outputDirToRootRelative(path)));
      resourceCallback.apply(fileReference);
    }
    Map<String,PBXVariantGroup> variantGroups=Maps.newHashMap();
    for (    SourcePath variantSourcePath : resource.variants.get()) {
      String lprojSuffix=".lproj";
      Path variantFilePath=sourcePathResolver.apply(variantSourcePath);
      Path variantDirectory=variantFilePath.getParent();
      if (variantDirectory == null || !variantDirectory.toString().endsWith(lprojSuffix)) {
        throw new HumanReadableException("Variant files have to be in a directory with name ending in '.lproj', " + "but '%s' is not.",variantFilePath);
      }
      String variantDirectoryName=variantDirectory.getFileName().toString();
      String variantLocalization=variantDirectoryName.substring(0,variantDirectoryName.length() - lprojSuffix.length());
      String variantFileName=variantFilePath.getFileName().toString();
      PBXVariantGroup variantGroup=variantGroups.get(variantFileName);
      if (variantGroup == null) {
        variantGroup=resourcesGroup.getOrCreateChildVariantGroupByName(variantFileName);
        variantGroupCallback.apply(variantGroup);
        variantGroups.put(variantFileName,variantGroup);
      }
      SourceTreePath sourceTreePath=new SourceTreePath(PBXReference.SourceTree.SOURCE_ROOT,pathRelativizer.outputPathToSourcePath(variantSourcePath));
      variantGroup.getOrCreateVariantFileReferenceByNameAndSourceTreePath(variantLocalization,sourceTreePath);
    }
  }
}
