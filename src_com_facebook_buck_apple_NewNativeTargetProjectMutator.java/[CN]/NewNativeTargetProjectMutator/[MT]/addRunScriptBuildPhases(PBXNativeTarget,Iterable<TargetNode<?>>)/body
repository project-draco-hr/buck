{
  for (  TargetNode<?> node : nodes) {
    PBXShellScriptBuildPhase shellScriptBuildPhase=new PBXShellScriptBuildPhase();
    target.getBuildPhases().add(shellScriptBuildPhase);
    if (GenruleDescription.TYPE.equals(node.getType())) {
      GenruleDescription.Arg arg=(GenruleDescription.Arg)node.getConstructorArg();
      for (      Path path : Iterables.transform(arg.srcs.get(),sourcePathResolver)) {
        shellScriptBuildPhase.getInputPaths().add(pathRelativizer.outputDirToRootRelative(path).toString());
      }
      if (arg.cmd.isPresent() && !arg.cmd.get().isEmpty()) {
        shellScriptBuildPhase.setShellScript(arg.cmd.get());
      }
 else       if (arg.bash.isPresent() || arg.cmdExe.isPresent()) {
        throw new IllegalStateException("Shell script phase only supports cmd for genrule.");
      }
      if (!arg.out.isEmpty()) {
        shellScriptBuildPhase.getOutputPaths().add(arg.out);
      }
    }
 else     if (XcodePrebuildScriptDescription.TYPE.equals(node.getType())) {
      XcodePrebuildScriptDescription.Arg arg=(XcodePrebuildScriptDescription.Arg)node.getConstructorArg();
      shellScriptBuildPhase.setShellScript(arg.cmd);
    }
 else     if (XcodePostbuildScriptDescription.TYPE.equals(node.getType())) {
      XcodePostbuildScriptDescription.Arg arg=(XcodePostbuildScriptDescription.Arg)node.getConstructorArg();
      shellScriptBuildPhase.setShellScript(arg.cmd);
    }
 else     if (IosReactNativeLibraryDescription.TYPE.equals(node.getType())) {
      shellScriptBuildPhase.setShellScript(generateXcodeShellScript(node));
    }
 else {
      throw new IllegalStateException("Invalid rule type for shell script build phase");
    }
  }
}
