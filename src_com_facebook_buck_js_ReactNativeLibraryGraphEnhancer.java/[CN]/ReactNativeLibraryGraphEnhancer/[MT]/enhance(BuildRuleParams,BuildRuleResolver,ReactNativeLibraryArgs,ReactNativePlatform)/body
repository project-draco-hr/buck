{
  BuildTarget originalBuildTarget=params.getBuildTarget();
  SourcePathResolver sourcePathResolver=new SourcePathResolver(resolver);
  boolean devMode=ReactNativeFlavors.isDevMode(originalBuildTarget);
  SourcePath packager=getPackager();
  BuildTarget depsFinderTarget=BuildTarget.builder(originalBuildTarget).addFlavors(REACT_NATIVE_DEPS_FLAVOR).build();
  BuildRuleParams paramsForDepsFinder=params.copyWithBuildTarget(depsFinderTarget);
  ReactNativeDeps depsFinder=new ReactNativeDeps(paramsForDepsFinder,sourcePathResolver,packager,args.srcs.get(),args.entryPath,platform);
  resolver.addToIndex(depsFinder);
  return new ReactNativeLibrary(params.copyWithExtraDeps(Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of(depsFinder))),new SourcePathResolver(resolver),args.entryPath,devMode,args.bundleName,packager,platform,depsFinder);
}
