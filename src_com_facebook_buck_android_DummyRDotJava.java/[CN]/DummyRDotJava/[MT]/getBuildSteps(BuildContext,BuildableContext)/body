{
  ImmutableList.Builder<Step> steps=ImmutableList.builder();
  final Path rDotJavaSrcFolder=getRDotJavaSrcFolder(getBuildTarget());
  steps.add(new MakeCleanDirectoryStep(rDotJavaSrcFolder));
  Set<Path> javaSourceFilePaths;
  if (androidResourceDeps.isEmpty()) {
    Path emptyRDotJava=rDotJavaSrcFolder.resolve("com/facebook/R.java");
    steps.add(new MakeCleanDirectoryStep(emptyRDotJava.getParent()));
    steps.add(new WriteFileStep(getProjectFilesystem(),"package com.facebook;\n public class R {}\n",emptyRDotJava,false));
    javaSourceFilePaths=ImmutableSet.of(emptyRDotJava);
  }
 else {
    MergeAndroidResourcesStep mergeStep=MergeAndroidResourcesStep.createStepForDummyRDotJava(getProjectFilesystem(),androidResourceDeps,rDotJavaSrcFolder);
    steps.add(mergeStep);
    javaSourceFilePaths=ImmutableSet.copyOf(mergeStep.getRDotJavaFiles());
  }
  final Path rDotJavaClassesFolder=getRDotJavaBinFolder();
  steps.add(new MakeCleanDirectoryStep(rDotJavaClassesFolder));
  Path pathToAbiOutputDir=getPathToAbiOutputDir(getBuildTarget());
  steps.add(new MakeCleanDirectoryStep(pathToAbiOutputDir));
  Path pathToAbiOutputFile=pathToAbiOutputDir.resolve("abi.jar");
  final JavacStep javacStep=RDotJava.createJavacStepForDummyRDotJavaFiles(javaSourceFilePaths,rDotJavaClassesFolder,javacOptions,getBuildTarget(),getResolver());
  steps.add(javacStep);
  buildableContext.recordArtifact(rDotJavaClassesFolder);
  steps.add(new CalculateAbiStep(buildableContext,rDotJavaClassesFolder,pathToAbiOutputFile));
  return steps.build();
}
