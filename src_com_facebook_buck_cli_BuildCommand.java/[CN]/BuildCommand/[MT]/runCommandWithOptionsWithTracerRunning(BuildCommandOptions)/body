{
  Verbosity verbosity=options.getVerbosity();
  Logging.setLoggingLevelForVerbosity(verbosity);
  if (isDaemon) {
    if (filesystemWatcher == null) {
      fileChangeEventBus=new EventBus("file-change-events");
      filesystemWatcher=new ProjectFilesystemWatcher(getProjectFilesystem(),fileChangeEventBus,options.getBuckConfig().getIgnoredDirectories(),FileSystems.getDefault().newWatchService());
      fileChangeEventBus.register(this);
    }
 else {
      filesystemWatcher.postEvents();
    }
  }
  if (buildFiles == null) {
    buildFiles=BuildFileTree.constructBuildFileTree(getProjectFilesystem());
    parser=new Parser(getProjectFilesystem(),getBuildRuleTypes(),getArtifactCache(),buildFiles);
  }
  try {
    buildTargets=getBuildTargets(parser,options.getArgumentsFormattedAsBuildTargets());
  }
 catch (  NoSuchBuildTargetException e) {
    console.printFailureWithoutStacktrace(e);
    return 1;
  }
  if (buildTargets.isEmpty()) {
    console.printFailure("Must specify at least one build target.");
    return 1;
  }
  DependencyGraph dependencyGraph;
  try {
    dependencyGraph=parser.parseBuildFilesForTargets(buildTargets,options.getDefaultIncludes());
  }
 catch (  NoSuchBuildTargetException e) {
    console.printFailureWithoutStacktrace(e);
    return 1;
  }
  this.build=options.createBuild(dependencyGraph,getProjectFilesystem(),console);
  getStdErr().printf("BUILDING %s\n",Joiner.on(' ').join(buildTargets));
  int exitCode=executeBuildAndPrintAnyFailuresToConsole(build,console);
  if (exitCode != 0) {
    return exitCode;
  }
  Tracer.addComment("Build targets built");
  console.getAnsi().printlnHighlightedSuccessText(getStdErr(),"BUILD SUCCESSFUL");
  return 0;
}
