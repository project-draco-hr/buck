{
  ArtifactCache artifactCache=params.getArtifactCache();
  if (isArtifactCacheDisabled()) {
    artifactCache=new NoopArtifactCache();
  }
  try (Build build=createBuild(params.getBuckConfig(),actionGraphAndResolver.getActionGraph(),actionGraphAndResolver.getResolver(),params.getAndroidPlatformTargetSupplier(),new CachingBuildEngine(executor,params.getFileHashCache(),getBuildEngineMode().or(params.getBuckConfig().getBuildEngineMode()),params.getBuckConfig().getDependencySchedulingOrder(),params.getBuckConfig().getBuildDepFiles(),params.getBuckConfig().getBuildMaxDepFileCacheEntries(),params.getBuckConfig().getBuildArtifactCacheSizeLimit(),params.getObjectMapper(),actionGraphAndResolver.getResolver()),artifactCache,params.getConsole(),params.getBuckEventBus(),Optional.<TargetDevice>absent(),params.getPlatform(),params.getEnvironment(),params.getObjectMapper(),params.getClock(),Optional.<AdbOptions>absent(),Optional.<TargetDeviceOptions>absent(),params.getExecutors())){
    lastBuild=build;
    return build.executeAndPrintFailuresToEventBus(buildTargets,isKeepGoing(),params.getBuckEventBus(),params.getConsole(),getPathToBuildReport(params.getBuckConfig()));
  }
 }
