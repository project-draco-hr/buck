{
  RDotTxtEntryBuilder entriesBuilder=new RDotTxtEntryBuilder();
  String sharedPackageName="com.facebook.abc";
  entriesBuilder.add(new RDotTxtEntry(sharedPackageName,"a-R.txt",ImmutableList.of("int id a1 0x7f010001","int id a2 0x7f010002","int string a1 0x7f020001")));
  entriesBuilder.add(new RDotTxtEntry(sharedPackageName,"b-R.txt",ImmutableList.of("int id b1 0x7f010001","int id b2 0x7f010002")));
  entriesBuilder.add(new RDotTxtEntry(sharedPackageName,"c-R.txt",ImmutableList.of("int attr c1 0x7f010001","int[] styleable c1 { 0x7f010001 }")));
  SortedSetMultimap<String,Resource> packageNameToResources=MergeAndroidResourcesStep.sortSymbols(entriesBuilder.buildFilePathToPackageNameSet(),entriesBuilder.getProjectFilesystem(),true);
  assertEquals(1,packageNameToResources.keySet().size());
  SortedSet<Resource> resources=packageNameToResources.get(sharedPackageName);
  assertEquals(7,resources.size());
  Set<String> uniqueEntries=Sets.newHashSet();
  for (  Resource resource : resources) {
    if (!resource.type.equals("styleable")) {
      assertFalse("Duplicate ids should be fixed by renumerate=true; duplicate was: " + resource.idValueToWrite,uniqueEntries.contains(resource.idValueToWrite));
      uniqueEntries.add(resource.idValueToWrite);
    }
  }
  assertEquals(6,uniqueEntries.size());
}
