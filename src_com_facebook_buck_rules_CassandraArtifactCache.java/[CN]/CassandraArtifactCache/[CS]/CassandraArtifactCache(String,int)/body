{
  AstyanaxContext<Keyspace> context=new AstyanaxContext.Builder().forCluster(clusterName).forKeyspace(keyspaceName).withAstyanaxConfiguration(new AstyanaxConfigurationImpl().setCqlVersion("3.0.0").setTargetCassandraVersion("1.2").setDiscoveryType(NodeDiscoveryType.RING_DESCRIBE)).withConnectionPoolConfiguration(new ConnectionPoolConfigurationImpl(poolName).setSeeds(hosts).setPort(port).setMaxConnsPerHost(1)).withConnectionPoolMonitor(new CountingConnectionPoolMonitor()).buildKeyspace(ThriftFamilyFactory.getInstance());
  context.start();
  this.keyspace=context.getClient();
  verifyMagic();
  this.ttl=getTtl();
}
