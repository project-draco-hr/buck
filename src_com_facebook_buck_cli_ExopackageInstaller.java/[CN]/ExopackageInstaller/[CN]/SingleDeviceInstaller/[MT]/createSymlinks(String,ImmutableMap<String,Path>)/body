{
  try (TraceEventLogger ignored=TraceEventLogger.start(eventBus,"create_symlinks_native")){
    int maxSize=MAX_ADB_COMMAND_SIZE - AdbHelper.ECHO_COMMAND_SUFFIX.length();
    Path abiDir=dataRoot.resolve(NATIVE_LIBS_DIR).resolve(abi);
    String commandPrefix=String.format("cd %s",abiDir.toString());
    String command=commandPrefix;
    for (    Map.Entry<String,Path> entry : libraries.entrySet()) {
      String target=entry.getValue().getFileName().toString();
      String source=String.format("native-%s.so",entry.getKey());
      String nextToken=String.format(" && ln -s %s %s",source,target);
      if (command.length() + nextToken.length() > maxSize) {
        LOG.debug("Executing symlink command: " + command);
        AdbHelper.executeCommandWithErrorChecking(device,command);
        command=commandPrefix + nextToken;
      }
 else {
        command+=nextToken;
      }
    }
    if (!command.equals(commandPrefix)) {
      AdbHelper.executeCommandWithErrorChecking(device,command);
    }
  }
 }
