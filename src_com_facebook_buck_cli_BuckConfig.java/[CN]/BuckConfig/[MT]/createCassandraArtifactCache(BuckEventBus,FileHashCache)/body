{
  final boolean doStore=readCacheMode("cassandra_mode",DEFAULT_CASSANDRA_MODE);
  String cacheHosts=getValue("cache","hosts").or("");
  int port=Integer.parseInt(getValue("cache","port").or(DEFAULT_CASSANDRA_PORT));
  int timeoutSeconds=Integer.parseInt(getValue("cache","connection_timeout_seconds").or(DEFAULT_CASSANDRA_TIMEOUT_SECONDS));
  try {
    return new CassandraArtifactCache("cassandra",cacheHosts,port,timeoutSeconds,doStore,buckEventBus,fileHashCache);
  }
 catch (  ConnectionException e) {
    buckEventBus.post(ThrowableConsoleEvent.create(e,"Cassandra cache connection failure."));
    return null;
  }
}
