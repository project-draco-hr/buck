{
  Pattern compiledPattern;
  try {
    compiledPattern=Pattern.compile(getPattern(args));
  }
 catch (  IllegalArgumentException e) {
    throw new QueryException(expression,"illegal pattern regexp in '" + this + "': "+ e.getMessage());
  }
  QueryExpression argument=args.get(args.size() - 1).getExpression();
  Set<T> result=new LinkedHashSet<>();
  for (  T target : argument.eval(env)) {
    for (    String str : getFilterStrings(env,args,target)) {
      if ((str != null) && compiledPattern.matcher(str).find()) {
        result.add(target);
        break;
      }
    }
  }
  return result;
}
