{
  File androidSdkDir=tempDir.newFolder();
  AndroidDirectoryResolver androidDirectoryResolver=new FakeAndroidDirectoryResolver(Optional.of(androidSdkDir.toPath()),Optional.<Path>absent(),"");
  File buildToolsDir=new File(androidSdkDir,"build-tools");
  buildToolsDir.mkdir();
  File addOnsLibsDir=new File(androidSdkDir,"add-ons/addon-google_apis-google-17/libs");
  addOnsLibsDir.mkdirs();
  Files.touch(new File(addOnsLibsDir,"effects.jar"));
  Files.touch(new File(addOnsLibsDir,"maps.jar"));
  Files.touch(new File(addOnsLibsDir,"usb.jar"));
  new File(buildToolsDir,"android-4.2.2").mkdir();
  new File(buildToolsDir,"android-4.1").mkdir();
  new File(buildToolsDir,"android-4.0.0").mkdir();
  new File(buildToolsDir,"17.0.0").mkdir();
  new File(buildToolsDir,"16.0.0").mkdir();
  Optional<AndroidPlatformTarget> androidPlatformTargetOption=AndroidPlatformTarget.getTargetForId("Google Inc.:Google APIs:17",androidDirectoryResolver);
  assertTrue(androidPlatformTargetOption.isPresent());
  assertEquals("android-4.2.2 should be used as the build directory",new File(androidSdkDir,"build-tools/android-4.2.2/aapt"),androidPlatformTargetOption.get().getAaptExecutable());
}
