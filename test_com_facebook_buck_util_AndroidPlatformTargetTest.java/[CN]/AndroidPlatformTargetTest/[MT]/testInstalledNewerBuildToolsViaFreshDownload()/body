{
  File androidSdkDir=tempDir.newFolder();
  AndroidDirectoryResolver androidDirectoryResolver=new FakeAndroidDirectoryResolver(Optional.of(androidSdkDir.toPath()),Optional.<Path>absent(),"");
  File buildToolsDir=new File(androidSdkDir,"build-tools");
  buildToolsDir.mkdir();
  File buildToolsDirFromFreshDownload=new File(buildToolsDir,"android-4.2.2");
  buildToolsDirFromFreshDownload.mkdir();
  File addOnsLibsDir=new File(androidSdkDir,"add-ons/addon-google_apis-google-17/libs");
  addOnsLibsDir.mkdirs();
  Files.touch(new File(addOnsLibsDir,"effects.jar"));
  Files.touch(new File(addOnsLibsDir,"maps.jar"));
  Files.touch(new File(addOnsLibsDir,"usb.jar"));
  String platformId="Google Inc.:Google APIs:17";
  Optional<AndroidPlatformTarget> androidPlatformTargetOption=AndroidPlatformTarget.getTargetForId(platformId,androidDirectoryResolver);
  assertTrue(androidPlatformTargetOption.isPresent());
  AndroidPlatformTarget androidPlatformTarget=androidPlatformTargetOption.get();
  assertEquals(platformId,androidPlatformTarget.getName());
  assertEquals(ImmutableList.of(MorePaths.newPathInstance(new File(androidSdkDir,"platforms/android-17/android.jar")),MorePaths.newPathInstance(new File(androidSdkDir,"add-ons/addon-google_apis-google-17/libs/effects.jar")),MorePaths.newPathInstance(new File(androidSdkDir,"add-ons/addon-google_apis-google-17/libs/maps.jar")),MorePaths.newPathInstance(new File(androidSdkDir,"add-ons/addon-google_apis-google-17/libs/usb.jar"))),androidPlatformTarget.getBootclasspathEntries());
  assertEquals(new File(androidSdkDir,"platforms/android-17/android.jar"),androidPlatformTarget.getAndroidJar());
  assertEquals(new File(androidSdkDir,"build-tools/android-4.2.2/aapt"),androidPlatformTarget.getAaptExecutable());
  assertEquals(new File(androidSdkDir,"platform-tools/adb"),androidPlatformTarget.getAdbExecutable());
  assertEquals(new File(androidSdkDir,"build-tools/android-4.2.2/aidl"),androidPlatformTarget.getAidlExecutable());
  assertEquals(new File(androidSdkDir,"build-tools/android-4.2.2/dx"),androidPlatformTarget.getDxExecutable());
  assertEquals(new File(androidSdkDir,"tools/zipalign"),androidPlatformTarget.getZipalignExecutable());
}
