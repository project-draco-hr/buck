{
  List<Callable<Void>> callables=Lists.transform(steps,new Function<Step,Callable<Void>>(){
    @Override public Callable<Void> apply(    final Step command){
      return new Callable<Void>(){
        @Override public Void call() throws Exception {
          runStep(command);
          return null;
        }
      }
;
    }
  }
);
  try {
    MoreFutures.getAllUninterruptibly(getListeningExecutorService(),callables);
  }
 catch (  ExecutionException e) {
    Throwable cause=e.getCause();
    Throwables.propagateIfInstanceOf(cause,StepFailedException.class);
    throw new RuntimeException(cause);
  }
}
