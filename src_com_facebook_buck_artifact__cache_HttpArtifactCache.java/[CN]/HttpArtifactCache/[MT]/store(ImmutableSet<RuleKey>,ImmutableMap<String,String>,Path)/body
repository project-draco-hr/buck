{
  if (!isStoreSupported()) {
    return;
  }
  Started startedEvent=HttpArtifactCacheEvent.newStoreStartedEvent(ruleKeys);
  buckEventBus.post(startedEvent);
  Finished.Builder finishedEventBuilder=HttpArtifactCacheEvent.newFinishedEventBuilder(startedEvent).setRuleKeys(ruleKeys);
  try {
    storeImpl(ruleKeys,metadata,output,finishedEventBuilder);
    buckEventBus.post(finishedEventBuilder.build());
  }
 catch (  IOException e) {
    reportFailure(e,"store(%s, %s): %s: %s",uri,ruleKeys,e.getClass().getName(),e.getMessage());
    buckEventBus.post(finishedEventBuilder.setWasUploadSuccessful(false).setErrorMessage(e.toString()).build());
  }
}
