{
  return CxxDescriptionEnhancer.createErrorMessagePathProcessor(new Function<String,String>(){
    @Override public String apply(    String original){
      Path path=Paths.get(original);
      if (operation == Operation.COMPILE) {
        path=Paths.get(sanitizer.restore(Optional.of(workingDir),original));
      }
      String result=Optional.fromNullable(replacementPaths.get(path)).transform(Escaper.PATH_FOR_C_INCLUDE_STRING_ESCAPER).or(Escaper.escapePathForCIncludeString(path));
      if (shouldReportAbsolutePaths) {
        result=filesystem.getAbsolutifier().apply(Paths.get(result)).toString();
      }
      return result;
    }
  }
);
}
