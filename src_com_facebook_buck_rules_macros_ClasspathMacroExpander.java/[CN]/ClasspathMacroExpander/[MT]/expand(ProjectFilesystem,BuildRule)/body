{
  if (!(rule instanceof HasClasspathEntries)) {
    throw new MacroException(String.format("%s used in classpath macro does not correspond to a rule with a java classpath",rule.getBuildTarget()));
  }
  HasClasspathEntries hasEntries=(HasClasspathEntries)rule;
  return Joiner.on(File.pathSeparator).join(FluentIterable.from(hasEntries.getTransitiveClasspathEntries().values()).transform(filesystem.getAbsolutifier()).transform(Functions.toStringFunction()).toSortedSet(Ordering.natural()));
}
