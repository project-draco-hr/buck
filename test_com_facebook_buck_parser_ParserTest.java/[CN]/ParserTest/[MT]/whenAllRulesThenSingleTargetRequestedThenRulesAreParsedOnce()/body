{
  TestProjectBuildFileParserFactory buildFileParserFactory=new TestProjectBuildFileParserFactory(filesystem,buildRuleTypes);
  Parser parser=createParser(emptyBuildTargets(),buildFileParserFactory);
  parser.filterAllTargetsInProject(filesystem,Lists.<String>newArrayList(),Predicates.<TargetNode<?>>alwaysTrue(),new TestConsole(),ImmutableMap.<String,String>of(),BuckEventBusFactory.newInstance(),false);
  BuildTarget foo=BuildTarget.builder("//java/com/facebook","foo").build();
  parser.buildTargetGraph(ImmutableList.of(foo),Lists.<String>newArrayList(),BuckEventBusFactory.newInstance(),new TestConsole(),ImmutableMap.<String,String>of());
  assertEquals("Should have cached build rules.",1,buildFileParserFactory.calls);
}
