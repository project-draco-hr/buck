{
  TestProjectBuildFileParserFactory buildFileParserFactory=new TestProjectBuildFileParserFactory(filesystem.getRootPath(),buildRuleTypes);
  BuckConfig buckConfig=new FakeBuckConfig("[project]","check_package_boundary = false","temp_files = ''");
  Parser parser=createParser(ofInstance(new FilesystemBackedBuildFileTree(filesystem,"BUCK")),emptyBuildTargets(),new TestProjectBuildFileParserFactory(filesystem.getRootPath(),buildRuleTypes),buckConfig);
  Path testAncestorBuildFile=tempDir.newFile("java/BUCK").toPath().toRealPath();
  Files.write("java_library(name = 'root')\n",testAncestorBuildFile.toFile(),Charsets.UTF_8);
  parseBuildFile(testAncestorBuildFile,parser,buildFileParserFactory);
  WatchEvent<Path> event=createPathEvent(Paths.get("java/com/facebook/SomeClass.java"),StandardWatchEventKinds.ENTRY_CREATE);
  parser.onFileSystemChange(event);
  parseBuildFile(testAncestorBuildFile,parser,buildFileParserFactory);
  assertEquals("Should have invalidated cache.",2,buildFileParserFactory.calls);
}
