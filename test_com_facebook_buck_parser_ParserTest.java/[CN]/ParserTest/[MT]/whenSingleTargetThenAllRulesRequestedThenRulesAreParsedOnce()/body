{
  TestProjectBuildFileParserFactory buildFileParserFactory=new TestProjectBuildFileParserFactory(filesystem.getRootPath(),buildRuleTypes);
  Parser parser=createParser(emptyBuildTargets(),buildFileParserFactory);
  BuildTarget foo=BuildTarget.builder("//java/com/facebook","foo").build();
  BuckConfig config=new FakeBuckConfig();
  parser.buildTargetGraphForBuildTargets(ImmutableList.of(foo),new ParserConfig(config),BuckEventBusFactory.newInstance(),new TestConsole(),config.getEnvironment(),false);
  parser.filterAllTargetsInProject(filesystem,new ParserConfig(config),Predicates.<TargetNode<?>>alwaysTrue(),new TestConsole(),config.getEnvironment(),BuckEventBusFactory.newInstance(),false);
  assertEquals("Should have replaced build rules",1,buildFileParserFactory.calls);
}
