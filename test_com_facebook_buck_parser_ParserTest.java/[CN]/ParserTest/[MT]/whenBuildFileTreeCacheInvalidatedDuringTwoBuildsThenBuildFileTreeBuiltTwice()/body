{
  BuckEvent mockEvent=createMock(BuckEvent.class);
  expect(mockEvent.getEventName()).andReturn("CommandStarted").anyTimes();
  expect(mockEvent.getBuildId()).andReturn(new BuildId("BUILD1"));
  expect(mockEvent.getBuildId()).andReturn(new BuildId("BUILD2"));
  BuildFileTree mockBuildFileTree=createMock(BuildFileTree.class);
  Supplier<BuildFileTree> mockSupplier=createMock(Supplier.class);
  expect(mockSupplier.get()).andReturn(mockBuildFileTree).times(2);
  replay(mockEvent,mockSupplier,mockBuildFileTree);
  Parser.BuildFileTreeCache cache=new Parser.BuildFileTreeCache(mockSupplier);
  cache.onCommandStartedEvent(mockEvent);
  cache.invalidateIfStale();
  cache.get();
  cache.onCommandStartedEvent(mockEvent);
  cache.invalidateIfStale();
  cache.get();
  verify(mockEvent,mockSupplier);
}
