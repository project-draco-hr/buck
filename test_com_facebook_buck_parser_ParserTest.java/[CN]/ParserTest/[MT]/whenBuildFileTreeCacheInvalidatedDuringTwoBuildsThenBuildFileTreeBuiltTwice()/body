{
  BuckEvent mockEvent=createMock(BuckEvent.class);
  expect(mockEvent.getEventName()).andReturn("CommandStarted").anyTimes();
  expect(mockEvent.getBuildId()).andReturn("BUILD1");
  expect(mockEvent.getBuildId()).andReturn("BUILD2");
  BuildFileTree mockBuildFileTree=createMock(BuildFileTree.class);
  InputSupplier<BuildFileTree> mockSupplier=createMock(InputSupplier.class);
  expect(mockSupplier.getInput()).andReturn(mockBuildFileTree).times(2);
  replay(mockEvent,mockSupplier,mockBuildFileTree);
  Parser.BuildFileTreeCache cache=new Parser.BuildFileTreeCache(mockSupplier);
  cache.onCommandStartedEvent(mockEvent);
  cache.invalidateIfStale();
  cache.getInput();
  cache.onCommandStartedEvent(mockEvent);
  cache.invalidateIfStale();
  cache.getInput();
  verify(mockEvent,mockSupplier);
}
