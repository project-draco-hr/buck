{
  Parser parser=createParser(emptyBuildTargets());
  tempDir.newFolder("foo");
  Path testFooBuckFile=tempDir.newFile("foo/BUCK");
  Files.write(testFooBuckFile,"java_library(name = 'lib')\n".getBytes(UTF_8));
  BuildTarget fooLibTarget=BuildTarget.builder(cellRoot,"//foo","lib").build();
  TargetNode<?> targetNode=parser.getOrLoadTargetNode(fooLibTarget,BuckEventBusFactory.newInstance(),new TestConsole(),false);
  assertThat(targetNode.getBuildTarget(),Matchers.equalTo(fooLibTarget));
  BuckConfig config=FakeBuckConfig.builder().build();
  SortedMap<String,Object> rules=parser.getOrLoadTargetNodeRules(targetNode,new ParserConfig(config),BuckEventBusFactory.newInstance(),new TestConsole(),config.getEnvironment());
  assertThat(rules,Matchers.hasKey("name"));
  assertThat((String)rules.get("name"),Matchers.equalTo(targetNode.getBuildTarget().getShortName()));
}
