{
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"build_then_test",temporaryFolder);
  workspace.setUp();
  ProcessResult buildResult=workspace.runBuckCommand("build","//:example");
  buildResult.assertExitCode("Successful build should exit with 0.",0);
  ProcessResult testResult=workspace.runBuckCommand("test","//:example");
  assertEquals("",testResult.getStdout());
  ImmutableList<String> resultList=ImmutableList.copyOf(Splitter.on("\n").split(testResult.getStderr()));
  assertEquals(6,resultList.size());
  assertTrue(resultList.get(0).startsWith("[-] PARSING BUILD FILES...FINISHED"));
  assertTrue(resultList.get(1).startsWith("[-] BUILDING...FINISHED"));
  assertEquals(ImmutableList.of("TESTING //:example","PASS <100ms  1 Passed   0 Failed   com.example.MyTest","TESTS PASSED"),resultList.subList(2,5));
  testResult.assertExitCode("Passing tests should exit with 0.",0);
  workspace.verify();
}
