{
  File file=target.file;
  Files.write(target.source,file,UTF_8);
  JavaCompiler compiler=ToolProvider.getSystemJavaCompiler();
  StandardJavaFileManager fileManager=compiler.getStandardFileManager(null,null,null);
  Iterable<? extends JavaFileObject> sourceObjects=fileManager.getJavaFileObjectsFromFiles(ImmutableSet.of(file));
  List<String> args=Lists.newArrayList("-g","-d",outputDir.getAbsolutePath());
  if (!classpath.isEmpty()) {
    args.add("-classpath");
    args.add(Joiner.on(File.pathSeparator).join(classpath));
  }
  AbiWriter processor=new AbiWriter();
  JavaCompiler.CompilationTask compilation=compiler.getTask(null,fileManager,null,args,null,sourceObjects);
  compilation.setProcessors(ImmutableSet.of(processor));
  Boolean result=compilation.call();
  assertNotNull(result);
  assertTrue(result);
  return processor.getSummaries();
}
