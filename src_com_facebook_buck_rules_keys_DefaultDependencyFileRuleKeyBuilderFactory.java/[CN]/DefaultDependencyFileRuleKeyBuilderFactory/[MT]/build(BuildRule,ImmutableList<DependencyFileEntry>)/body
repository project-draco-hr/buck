{
  Builder builder=newInstance(rule);
  ImmutableSet<DependencyFileEntry> inputSet=ImmutableSet.copyOf(inputs);
  ImmutableMultimap.Builder<DependencyFileEntry,SourcePath> entryToSourcePathsBuilder=ImmutableMultimap.builder();
  for (  SourcePath input : builder.getInputsSoFar()) {
    DependencyFileEntry entry=DependencyFileEntry.fromSourcePath(input,pathResolver);
    if (inputSet.contains(entry)) {
      entryToSourcePathsBuilder.put(entry,input);
    }
  }
  final ImmutableMultimap<DependencyFileEntry,SourcePath> entryToSourcePaths=entryToSourcePathsBuilder.build();
  for (  DependencyFileEntry input : inputs) {
    ImmutableCollection<SourcePath> sourcePaths=entryToSourcePaths.get(input);
    if (sourcePaths.isEmpty()) {
      throw new NoSuchFileException(String.format("%s: could not find any inputs matching the relative path `%s`",rule.getBuildTarget(),input));
    }
    for (    SourcePath sourcePath : sourcePaths) {
      builder.setPath(pathResolver.getAbsolutePath(sourcePath),pathResolver.getRelativePath(sourcePath));
    }
  }
  return builder.build();
}
