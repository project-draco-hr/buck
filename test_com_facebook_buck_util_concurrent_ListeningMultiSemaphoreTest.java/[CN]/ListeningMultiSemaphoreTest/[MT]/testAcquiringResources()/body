{
  ImmutableMap<String,Integer> values=ImmutableMap.of("cpu",2);
  ListeningMultiSemaphore array=new ListeningMultiSemaphore(values);
  ListenableFuture<Void> future=array.acquire(ImmutableMap.of("cpu",1));
  assertThat(future.isDone(),Matchers.equalTo(true));
  assertThat(array.getQueueLength(),Matchers.equalTo(0));
  assertThat(array.getAvailableResources(),Matchers.equalTo(ImmutableMap.of("cpu",1)));
}
