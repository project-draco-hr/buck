{
  Optional<Path> stubBinaryPath=getStubBinaryPath(params,args);
  if (shouldUseStubBinary(params) && stubBinaryPath.isPresent()) {
    try {
      return new WriteFile(params,new SourcePathResolver(resolver),Files.readAllBytes(stubBinaryPath.get()),BuildTargets.getGenPath(params.getBuildTarget(),"%s"),true);
    }
 catch (    IOException e) {
      throw new HumanReadableException("Could not read stub binary " + stubBinaryPath.get());
    }
  }
 else {
    Optional<BuildRule> existingRule=resolver.getRuleOptional(params.getBuildTarget());
    if (existingRule.isPresent()) {
      return existingRule.get();
    }
 else {
      CxxBinaryDescription.Arg delegateArg=delegate.createUnpopulatedConstructorArg();
      AppleDescriptions.populateCxxBinaryDescriptionArg(new SourcePathResolver(resolver),delegateArg,args,params.getBuildTarget());
      return delegate.createBuildRule(targetGraph,params,resolver,delegateArg);
    }
  }
}
