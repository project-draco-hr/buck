{
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  TargetSources targetSources=TargetSources.ofAppleSources(pathResolver,args.srcs.get());
  Optional<BuildRule> flavoredRule=AbstractAppleNativeTargetBuildRuleDescriptions.createFlavoredRule(params,resolver,args,appleConfig,pathResolver,targetSources);
  if (flavoredRule.isPresent()) {
    return flavoredRule.get();
  }
  CxxLibraryDescription.Arg delegateArg=delegate.createUnpopulatedConstructorArg();
  delegateArg.srcs=Optional.of(Either.<ImmutableList<SourcePath>,ImmutableMap<String,SourcePath>>ofLeft(ImmutableList.copyOf(targetSources.srcPaths)));
  delegateArg.headers=Optional.of(Either.<ImmutableList<SourcePath>,ImmutableMap<String,SourcePath>>ofLeft(ImmutableList.copyOf(targetSources.headerPaths)));
  delegateArg.compilerFlags=Optional.of(ImmutableList.<String>of());
  delegateArg.preprocessorFlags=Optional.of(ImmutableList.<String>of());
  delegateArg.langPreprocessorFlags=Optional.of(ImmutableMap.<CxxSource.Type,ImmutableList<String>>of());
  delegateArg.lexSrcs=Optional.of(ImmutableList.<SourcePath>of());
  delegateArg.yaccSrcs=Optional.of(ImmutableList.<SourcePath>of());
  delegateArg.deps=args.deps;
  delegateArg.headerNamespace=args.headerPathPrefix.or(Optional.of(params.getBuildTarget().getShortNameOnly()));
  delegateArg.exportedPreprocessorFlags=Optional.of(ImmutableList.<String>of());
  delegateArg.exportedLangPreprocessorFlags=Optional.of(ImmutableMap.<CxxSource.Type,ImmutableList<String>>of());
  delegateArg.soname=Optional.absent();
  delegateArg.linkWhole=Optional.of(!isDynamicLibraryTarget(params.getBuildTarget()));
  return delegate.createBuildRule(params,resolver,delegateArg);
}
