{
  BuildInfoRecorder buildInfoRecorder=createBuildInfoRecorder(new FakeProjectFilesystem(){
    @Override public void createZip(    Collection<Path> pathsToIncludeInZip,    Path out,    ImmutableMap<Path,String> additionalFileContents) throws IOException {
      writeBytesToPath(out.toString().getBytes(),out);
    }
  }
);
  DebuggableTemporaryFolder cacheDir=new DebuggableTemporaryFolder();
  ArtifactCache artifactCache=TestArtifactCaches.createDirCacheForTest(cacheDir);
  buildInfoRecorder.performUploadToArtifactCache(ImmutableSet.of(new RuleKey(RULE_KEY)),artifactCache,new BuckEventBus(new DefaultClock(),new BuildId()));
  assertTrue(cacheDir.getRootPath().resolve(DirArtifactCacheTestUtil.getPathForRuleKey(artifactCache,new RuleKey(RULE_KEY),Optional.<String>absent())).toFile().exists());
}
