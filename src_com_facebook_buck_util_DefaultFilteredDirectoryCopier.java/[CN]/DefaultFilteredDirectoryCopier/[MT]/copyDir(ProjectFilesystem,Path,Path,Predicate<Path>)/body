{
  if (filesystem.exists(destDir)) {
    filesystem.deleteRecursivelyIfExists(destDir);
  }
  filesystem.mkdirs(destDir);
  final Path absoluteSrcDir=filesystem.resolve(srcDir);
  final Path absoluteDestDir=filesystem.resolve(destDir);
  filesystem.walkFileTree(absoluteSrcDir,new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult visitFile(    Path absoluteSrcPath,    BasicFileAttributes attributes) throws IOException {
      if (pred.apply(filesystem.getRootPath().relativize(absoluteSrcPath))) {
        Path destPath=absoluteDestDir.resolve(absoluteSrcDir.relativize(absoluteSrcPath));
        filesystem.createParentDirs(destPath);
        filesystem.copy(absoluteSrcPath,destPath,ProjectFilesystem.CopySourceMode.FILE);
      }
      return FileVisitResult.CONTINUE;
    }
  }
);
}
