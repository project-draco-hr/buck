{
  Pair<ProjectWorkspace,ProjectWorkspace> cells=prepare("inter-cell/visibility/primary","inter-cell/visibility/secondary");
  ProjectWorkspace primary=cells.getFirst();
  ProjectWorkspace secondary=cells.getSecond();
  registerCell(secondary,"primary",primary);
  TypeCoercerFactory coercerFactory=new DefaultTypeCoercerFactory();
  Parser parser=new Parser(new ParserConfig(cells.getFirst().asCell().getBuckConfig()),coercerFactory,new ConstructorArgMarshaller(coercerFactory));
  BuckEventBus eventBus=BuckEventBusFactory.newInstance();
  Cell primaryCell=primary.asCell();
  BuildTarget namedTarget=BuildTargetFactory.newInstance(primaryCell.getFilesystem(),targetName);
  parser.buildTargetGraph(eventBus,primaryCell,false,Executors.newSingleThreadExecutor(),ImmutableSet.of(namedTarget));
}
