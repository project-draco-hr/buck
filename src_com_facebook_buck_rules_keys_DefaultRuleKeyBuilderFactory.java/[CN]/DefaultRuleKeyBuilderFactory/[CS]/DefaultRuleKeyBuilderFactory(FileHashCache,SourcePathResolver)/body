{
  this(hashCache,pathResolver,new Function<Pair<RuleKeyBuilder,BuildRule>,RuleKeyBuilder>(){
    @Override public RuleKeyBuilder apply(    Pair<RuleKeyBuilder,BuildRule> input){
      if (input.getSecond() instanceof AbstractBuildRule) {
        AbstractBuildRule abstractBuildRule=(AbstractBuildRule)input.getSecond();
        return input.getFirst().setReflectively("buck.extraDeps",abstractBuildRule.deprecatedGetExtraDeps()).setReflectively("buck.declaredDeps",abstractBuildRule.getDeclaredDeps());
      }
 else {
        return input.getFirst().setReflectively("buck.deps",input.getSecond().getDeps());
      }
    }
  }
);
}
