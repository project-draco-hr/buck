{
  BuildRuleResolver resolver=new BuildRuleResolver();
  HumanReadableException exception=null;
  try {
    AppleBinaryBuilder.createBuilder(BuildTarget.builder("//foo","xctest").addFlavors(ImmutableFlavor.of("iphoneos-i386"),ImmutableFlavor.of("macosx-x86_64")).build()).build(resolver);
  }
 catch (  HumanReadableException e) {
    exception=e;
  }
  assertThat(exception,notNullValue());
  assertThat("Should throw exception about different architectures",exception.getHumanReadableErrorMessage(),endsWith("Fat binaries can only be generated from binaries compiled for the same SDK."));
}
