{
  Map<String,BuildRule> buildRuleIndex=Maps.newHashMap();
  BuildTarget processorTarget=BuildTargetFactory.newInstance("//java/processor:processor");
  JavaLibraryRule processorRule=DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(processorTarget).addSrc("java/processor/processor.java").build(buildRuleIndex);
  buildRuleIndex.put(processorRule.getFullyQualifiedName(),processorRule);
  BuildTarget libTarget=BuildTargetFactory.newInstance("//java/lib:lib");
  AndroidLibraryRule.Builder builder=new AndroidLibraryRule.Builder().setBuildTarget(libTarget);
  builder.getAnnotationProcessingBuilder().addAllProcessors(ImmutableList.of("MyProcessor")).addProcessorBuildTarget(processorTarget);
  AndroidLibraryRule rule=builder.build(buildRuleIndex);
  AnnotationProcessingData processingData=rule.getAnnotationProcessingData();
  assertNotNull(processingData.getGeneratedSourceFolderName());
}
