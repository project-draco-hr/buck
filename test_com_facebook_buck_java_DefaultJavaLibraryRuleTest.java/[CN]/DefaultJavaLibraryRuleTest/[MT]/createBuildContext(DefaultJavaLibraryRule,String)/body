{
  DependencyGraph graph=RuleMap.createGraphFromSingleRule(javaLibrary);
  BuildContext context=EasyMock.createMock(BuildContext.class);
  EasyMock.expect(context.getDependencyGraph()).andReturn(graph);
  EasyMock.expectLastCall().anyTimes();
  EasyMock.expect(context.getAndroidBootclasspathSupplier()).andReturn(Suppliers.ofInstance(bootclasspath));
  EasyMock.expect(context.getJavaPackageFinder()).andReturn(EasyMock.createMock(JavaPackageFinder.class));
  EasyMock.expect(context.getBuildDependencies()).andReturn(BuildDependencies.TRANSITIVE);
  EasyMock.expectLastCall().anyTimes();
  EasyMock.replay(context);
  return context;
}
