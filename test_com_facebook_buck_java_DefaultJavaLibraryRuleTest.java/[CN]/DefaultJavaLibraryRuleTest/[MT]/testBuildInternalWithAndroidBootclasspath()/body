{
  String folder="android/java/src/com/facebook";
  tmp.newFolder(folder.split("/"));
  BuildTarget buildTarget=BuildTargetFactory.newInstance("//" + folder + ":fb");
  Path src=Paths.get(folder,"Main.java");
  tmp.newFile(src.toString());
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  ProjectFilesystem projectFilesystem=new ProjectFilesystem(tmp.getRoot());
  DefaultJavaLibraryRule javaLibrary=ruleResolver.buildAndAddToIndex(AndroidLibraryRule.newAndroidLibraryRuleBuilder(new DefaultBuildRuleBuilderParams(projectFilesystem,new FakeRuleKeyBuilderFactory())).setBuildTarget(buildTarget).addSrc(src));
  String bootclasspath="effects.jar:maps.jar:usb.jar:";
  BuildContext context=createBuildContext(javaLibrary,bootclasspath,projectFilesystem);
  List<Step> steps=javaLibrary.getBuildSteps(context,new FakeBuildableContext());
  Step step=Iterables.find(steps,new Predicate<Step>(){
    @Override public boolean apply(    Step command){
      return command instanceof JavacInMemoryStep;
    }
  }
);
  assertNotNull("Expected a JavacInMemoryCommand in the command list.",step);
  JavacInMemoryStep javac=(JavacInMemoryStep)step;
  assertEquals("Should compile Main.java rather than generated R.java.",ImmutableSet.of(src),javac.getSrcs());
}
