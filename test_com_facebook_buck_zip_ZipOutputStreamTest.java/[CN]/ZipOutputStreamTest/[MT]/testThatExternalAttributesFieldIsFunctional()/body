{
  final ImmutableList<String> samples=ImmutableList.of("rwxrwxrwx","rw-r--r--","--x--x--x","---------");
  for (  String stringMode : samples) {
    long mode=MorePosixFilePermissions.toMode(PosixFilePermissions.fromString(stringMode));
    try (CustomZipOutputStream out=ZipOutputStreams.newOutputStream(output,OVERWRITE_EXISTING)){
      CustomZipEntry entry=new CustomZipEntry("test");
      entry.setTime(System.currentTimeMillis());
      entry.setExternalAttributes(mode << 16);
      out.putNextEntry(entry);
      out.write(new byte[0]);
    }
     try (ZipFile in=new ZipFile(output.toFile())){
      Enumeration<ZipArchiveEntry> entries=in.getEntries();
      ZipArchiveEntry entry=entries.nextElement();
      assertEquals(mode,entry.getExternalAttributes() >> 16);
      assertFalse(entries.hasMoreElements());
    }
   }
}
