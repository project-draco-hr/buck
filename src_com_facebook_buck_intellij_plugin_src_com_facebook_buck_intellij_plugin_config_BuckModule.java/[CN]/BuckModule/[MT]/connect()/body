{
  mConnecting=true;
  ApplicationManager.getApplication().executeOnPooledThread(new Runnable(){
    @Override public void run(){
      if (!mClient.isConnected()) {
        BuckWSServerPortUtils wsPortUtils=new BuckWSServerPortUtils();
        try {
          int port=wsPortUtils.getPort(BuckModule.this.mProject.getBasePath());
          if (port == BuckWSServerPortUtils.CONNECTION_FAILED) {
            BuckToolWindowFactory.outputConsoleMessage(mProject,"Your buck server may be turned off.\n" + "It's possible that it can't get a port.\n" + "Try adding to your '.buckconfig.local' file:\n"+ "[httpserver]\n"+ "    port = 0\n"+ "After that press the 'Connect to buck' button.\n",ConsoleViewContentType.ERROR_OUTPUT);
          }
 else {
            mClient=new BuckClient(port,mEventHandler);
            BuckModule.this.mClient.connect();
          }
        }
 catch (        NumberFormatException e) {
          LOG.error(e);
          mConnecting=false;
        }
catch (        ExecutionException e) {
          LOG.error(e);
          mConnecting=false;
        }
catch (        IOException e) {
          LOG.error(e);
          mConnecting=false;
        }
      }
      mConnecting=false;
    }
  }
);
}
