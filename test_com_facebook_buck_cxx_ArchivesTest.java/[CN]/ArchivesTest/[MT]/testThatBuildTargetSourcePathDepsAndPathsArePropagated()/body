{
  BuildRuleResolver resolver=new BuildRuleResolver();
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  Genrule genrule1=(Genrule)GenruleBuilder.newGenruleBuilder(BuildTargetFactory.newInstance("//:genrule")).setOut("foo/bar.o").build(resolver);
  Genrule genrule2=(Genrule)GenruleBuilder.newGenruleBuilder(BuildTargetFactory.newInstance("//:genrule2")).setOut("foo/test.o").build(resolver);
  Archive archive=Archives.createArchiveRule(new SourcePathResolver(resolver),target,params,DEFAULT_ARCHIVER,DEFAULT_OUTPUT,ImmutableList.<SourcePath>of(new TestSourcePath("simple.o"),new BuildTargetSourcePath(genrule1.getBuildTarget()),new BuildTargetSourcePath(genrule2.getBuildTarget())));
  assertEquals(ImmutableSortedSet.<BuildRule>of(genrule1,genrule2),archive.getDeps());
}
