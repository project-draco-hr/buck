{
  expect(watchService.poll()).andReturn(null);
  replay(filesystem,eventBus,watchService,path,key,event);
  watcher=new WatchServiceWatcher(filesystem,eventBus,ImmutableSet.<Path>of(),watchService);
  visitor.getValue().preVisitDirectory(path,null);
  watcher.postEvents();
  verify(filesystem,eventBus,watchService,path,key,event);
}
