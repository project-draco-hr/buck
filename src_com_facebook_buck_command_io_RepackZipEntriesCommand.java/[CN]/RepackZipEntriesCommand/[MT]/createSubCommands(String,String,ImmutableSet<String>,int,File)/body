{
  if (workingDirectory == null) {
    workingDirectory=Files.createTempDir();
    workingDirectory.deleteOnExit();
  }
  ShellCommand unzip=new UnzipCommand(inputFile,workingDirectory.getAbsolutePath(),true,entries);
  ShellCommand cp=new CopyCommand(inputFile,outputFile);
  ShellCommand zip=new ZipCommand(ZipCommand.Mode.ADD,new File(outputFile).getAbsolutePath(),entries,false,compressionLevel,workingDirectory.getAbsoluteFile());
  return ImmutableList.of(unzip,cp,zip);
}
