{
  tmpDir.newFolder("ndk-dir-r9a");
  Path expectedPath=tmpDir.newFolder("ndk-dir-r9b").toPath();
  tmpDir.newFolder("ndk-dir-r9c");
  File releaseFile=tmpDir.newFile("ndk-dir-r9a/RELEASE.TXT");
  MoreFiles.writeLinesToFile(ImmutableList.of("r9a"),releaseFile);
  releaseFile=tmpDir.newFile("ndk-dir-r9b/RELEASE.TXT");
  MoreFiles.writeLinesToFile(ImmutableList.of("r9b"),releaseFile);
  releaseFile=tmpDir.newFile("ndk-dir-r9c/RELEASE.TXT");
  MoreFiles.writeLinesToFile(ImmutableList.of("r9c"),releaseFile);
  PropertyFinder propertyFinder=new FakePropertyFinder(ImmutableMap.of("ndk.dir",Optional.<Path>absent(),"ndk.repository",Optional.of(tmpDir.getRoot().toPath())));
  DefaultAndroidDirectoryResolver androidDirectoryResolver=new DefaultAndroidDirectoryResolver(new ProjectFilesystem(tmpDir.getRoot()),Optional.of("r9b"),propertyFinder);
  assertEquals(Optional.of(expectedPath),androidDirectoryResolver.findAndroidNdkDir());
}
