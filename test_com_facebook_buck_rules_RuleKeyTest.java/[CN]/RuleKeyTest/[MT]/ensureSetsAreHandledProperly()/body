{
  BuildTarget target=BuildTargetFactory.newInstance("//foo/bar:baz");
  FakeBuildRule rule=new FakeBuildRule(new BuildRuleType("example"),target,new SourcePathResolver(new BuildRuleResolver()));
  rule.setRuleKey(RuleKey.TO_RULE_KEY.apply("cafebabe"));
  rule.setOutputFile("cheese.txt");
  ImmutableSortedSet<SourcePath> sourcePaths=ImmutableSortedSet.<SourcePath>of(new BuildRuleSourcePath(rule),new TestSourcePath("alpha/beta"));
  ImmutableSet<String> strings=ImmutableSet.of("one","two");
  RuleKey.Builder.RuleKeyPair reflective=createEmptyRuleKey().setReflectively("sourcePaths",sourcePaths).setReflectively("strings",strings).build();
  RuleKey.Builder.RuleKeyPair manual=createEmptyRuleKey().setSourcePaths("sourcePaths",sourcePaths).set("strings",strings).build();
  assertEquals(manual.getTotalRuleKey(),reflective.getTotalRuleKey());
}
