{
  this.config=Preconditions.checkNotNull(config);
  this.console=Preconditions.checkNotNull(console);
  this.hashCache=new DefaultFileHashCache(projectFilesystem,console);
  Repository repository=new Repository("default",projectFilesystem,knownBuildRuleTypes,config);
  this.parser=new Parser(repository,console,environment,config.getPythonInterpreter(),config.getTempFilePatterns(),createRuleKeyBuilderFactory(hashCache));
  this.androidDirectoryResolver=Preconditions.checkNotNull(androidDirectoryResolver);
  this.logConfigFilesWatcher=new LogConfigFilesWatcher();
  this.fileEventBus=new EventBus("file-change-events");
  this.filesystemWatcher=createWatcher(projectFilesystem);
  fileEventBus.register(parser);
  fileEventBus.register(hashCache);
  fileEventBus.register(logConfigFilesWatcher);
  webServer=createWebServer(config,console,projectFilesystem);
  JavaUtilsLoggingBuildListener.ensureLogFileIsWritten(projectFilesystem);
}
