{
  this.config=Preconditions.checkNotNull(config);
  this.console=Preconditions.checkNotNull(console);
  ConcurrentMapFileHashCache hashCache=new ConcurrentMapFileHashCache(projectFilesystem,console);
  this.parser=new Parser(projectFilesystem,new KnownBuildRuleTypes(),console,config.getPythonInterpreter(),config.getTempFilePatterns(),createRuleKeyBuilderFactory(config,hashCache));
  this.fileEventBus=new EventBus("file-change-events");
  this.filesystemWatcher=new ProjectFilesystemWatcher(projectFilesystem,fileEventBus,config.getIgnorePaths(),FileSystems.getDefault().newWatchService());
  fileEventBus.register(parser);
  fileEventBus.register(hashCache);
  webServer=createWebServer(config,console);
}
