{
  this.repository=repositoryFactory.getRootRepository();
  this.clock=clock;
  this.objectMapper=objectMapper;
  this.hashCache=new DefaultFileHashCache(repository.getFilesystem());
  ParserConfig parserConfig=new ParserConfig(repository.getBuckConfig());
  PythonBuckConfig pythonBuckConfig=new PythonBuckConfig(repository.getBuckConfig(),new ExecutableFinder());
  this.parser=Parser.createParser(repositoryFactory,pythonBuckConfig.getPythonInterpreter(),parserConfig.getAllowEmptyGlobs(),parserConfig.getEnforceBuckPackageBoundary(),parserConfig.getTempFilePatterns(),parserConfig.getBuildFileName(),parserConfig.getDefaultIncludes(),createRuleKeyBuilderFactory(hashCache));
  this.fileEventBus=new EventBus("file-change-events");
  this.filesystemWatcher=createWatcher(repository.getFilesystem());
  fileEventBus.register(parser);
  fileEventBus.register(hashCache);
  webServer=createWebServer(repository.getBuckConfig(),repository.getFilesystem());
  JavaUtilsLoggingBuildListener.ensureLogFileIsWritten(repository.getFilesystem());
}
