{
  if (daemon == null) {
    daemon=new Daemon(filesystem,config,console);
  }
 else {
    File parserRoot=daemon.getParser().getProjectRoot();
    if (!filesystem.getProjectRoot().equals(parserRoot)) {
      throw new HumanReadableException(String.format("Unsupported root path change from %s to %s",filesystem.getProjectRoot(),parserRoot));
    }
    if (!daemon.getConfig().equals(config)) {
      daemon.close();
      daemon=new Daemon(filesystem,config,console);
    }
  }
  return daemon;
}
