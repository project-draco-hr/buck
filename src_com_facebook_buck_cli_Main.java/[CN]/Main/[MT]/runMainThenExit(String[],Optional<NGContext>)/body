{
  installUncaughtExceptionHandler(context);
  Path projectRoot=Paths.get(".");
  int exitCode=FAIL_EXIT_CODE;
  BuildId buildId=getBuildId(context);
  ImmutableMap<String,String> clientEnvironment=getClientEnvironment(context);
  try {
    exitCode=tryRunMainWithExitCode(buildId,projectRoot,context,clientEnvironment,CommandMode.RELEASE,args);
  }
 catch (  Throwable t) {
    LOG.error(t,"Uncaught exception at top level");
  }
 finally {
    LogConfig.flushLogs();
    System.exit(exitCode);
  }
}
