{
  if (target.getCell().isPresent()) {
    ProjectFilesystem filesystem=nameResolver.apply(target.getCell());
    return Optional.of(ruleResolvers.getUnchecked(filesystem));
  }
  ProjectFilesystem filesystem=null;
  for (  ProjectFilesystem pfs : ruleResolvers.asMap().keySet()) {
    if (pfs.getRootPath().equals(target.getCellPath())) {
      filesystem=pfs;
      break;
    }
  }
  if (filesystem == null) {
    return Optional.absent();
  }
  return Optional.of(ruleResolvers.getUnchecked(filesystem));
}
