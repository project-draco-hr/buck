{
  BuildRuleFactoryParams ruleFactoryParams=targetNode.getRuleFactoryParams();
  Description<T> description=targetNode.getDescription();
  T arg=targetNode.getConstructorArg();
  BuildRuleParams params=new BuildRuleParams(targetNode.getBuildTarget(),Suppliers.ofInstance(ruleResolver.requireAllRules(targetNode.getDeclaredDeps())),Suppliers.ofInstance(ruleResolver.requireAllRules(targetNode.getExtraDeps())),ruleFactoryParams.getProjectFilesystem(),targetNode.getCellNames());
  if (description instanceof MixedWithSwift) {
    @SuppressWarnings("unchecked") Optional<BuildRule> swiftCompanionTarget=((MixedWithSwift<T>)description).generateSwiftBuildRule(params,ruleResolver,arg);
    if (swiftCompanionTarget.isPresent()) {
      params=params.appendExtraDeps(ImmutableSet.of(ruleResolver.addToIndex(swiftCompanionTarget.get())));
    }
  }
  return description.createBuildRule(targetGraph,params,ruleResolver,arg);
}
