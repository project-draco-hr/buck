{
  final List<LuaPackageComponents> components=new ArrayList<>();
  new AbstractBreadthFirstTraversal<BuildRule>(deps){
    @Override public ImmutableSet<BuildRule> visit(    BuildRule rule){
      if (rule instanceof LuaPackageable) {
        components.add(((LuaPackageable)rule).getLuaPackageComponents());
        return rule.getDeps();
      }
      return ImmutableSet.of();
    }
  }
.start();
  return components;
}
