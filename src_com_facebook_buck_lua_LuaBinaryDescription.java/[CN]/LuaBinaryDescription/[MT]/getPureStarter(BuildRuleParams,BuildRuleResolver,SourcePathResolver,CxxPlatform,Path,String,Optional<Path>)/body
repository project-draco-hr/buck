{
  BuildTarget target=BuildTarget.builder(baseParams.getBuildTarget()).addFlavors(ImmutableFlavor.of("pure-starter")).build();
  final Tool lua=luaConfig.getLua(ruleResolver);
  ruleResolver.addToIndex(WriteStringTemplateRule.from(baseParams,pathResolver,target,output,new PathSourcePath(baseParams.getProjectFilesystem(),LuaBinaryDescription.class + "/" + STARTER,new PackagedResource(baseParams.getProjectFilesystem(),LuaBinaryDescription.class,STARTER)),ImmutableMap.of("SHEBANG",lua.getCommandPrefix(pathResolver).get(0),"MAIN_MODULE",Escaper.escapeAsPythonString(mainModule),"MODULES_DIR",relativeModulesDir.isPresent() ? Escaper.escapeAsPythonString(relativeModulesDir.get().toString()) : "nil","EXT_SUFFIX",Escaper.escapeAsPythonString(cxxPlatform.getSharedLibraryExtension())),true));
  return new BuildTargetSourcePath(target);
}
