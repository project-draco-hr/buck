{
  ProjectFilesystem projectFilesystem=new FakeProjectFilesystem();
  ExecutionContext context=TestExecutionContext.newBuilder().setProjectFilesystem(projectFilesystem).build();
  ImmutableList<String> linker=ImmutableList.of("linker");
  Path output=Paths.get("output");
  ImmutableList<String> args=ImmutableList.of("-rpath","hello","a.o","libb.a");
  Path frameworkRoot=Paths.get("/System/Frameworks");
  final Path librarySearchPath=Paths.get("/System/libraries");
  final String library="z";
  CxxLinkStep cxxLinkStep=new CxxLinkStep(projectFilesystem.getRootPath(),linker,output,args,ImmutableSet.of(frameworkRoot),ImmutableSet.of(librarySearchPath),ImmutableSet.of(library));
  ImmutableList<String> expected=ImmutableList.<String>builder().addAll(linker).add("-o",output.toString()).add("-F",frameworkRoot.toString()).add("-L",librarySearchPath.toString()).add("-l" + library).addAll(args).build();
  ImmutableList<String> actual=cxxLinkStep.getShellCommand(context);
  assertEquals(expected,actual);
}
