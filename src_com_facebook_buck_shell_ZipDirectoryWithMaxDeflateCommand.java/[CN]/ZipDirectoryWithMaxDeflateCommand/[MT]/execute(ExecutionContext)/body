{
  File inputDirectory=new File(inputDirectoryPath);
  Preconditions.checkState(inputDirectory.exists() && inputDirectory.isDirectory());
  Closer closer=Closer.create();
  try {
    ZipOutputStream outputStream=closer.register(new ZipOutputStream(new BufferedOutputStream(new FileOutputStream(outputZipPath))));
    addDirectoryToZip(inputDirectory,"",outputStream);
  }
 catch (  IOException e) {
    e.printStackTrace(context.getStdErr());
    return 1;
  }
 finally {
    try {
      closer.close();
    }
 catch (    IOException e) {
      Throwables.propagate(e);
    }
  }
  return 0;
}
