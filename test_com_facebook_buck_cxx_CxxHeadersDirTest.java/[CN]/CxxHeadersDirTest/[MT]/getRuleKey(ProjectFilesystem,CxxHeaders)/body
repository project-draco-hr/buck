{
  SourcePathResolver pathResolver=new SourcePathResolver(new BuildRuleResolver(TargetGraph.EMPTY,new DefaultTargetNodeToBuildRuleTransformer()));
  FileHashCache fileHashCache=new DefaultFileHashCache(filesystem);
  DefaultRuleKeyBuilderFactory factory=new DefaultRuleKeyBuilderFactory(fileHashCache,pathResolver);
  RuleKeyBuilder builder=new RuleKeyBuilder(pathResolver,fileHashCache,factory);
  cxxHeaders.appendToRuleKey(builder);
  return builder.build();
}
