{
  ImmutableSortedSet.Builder<SourcePath> files=ImmutableSortedSet.naturalOrder();
  ImmutableMap.Builder<SourcePath,String> perFileCompileFlags=ImmutableMap.builder();
  ImmutableList<Either<SourcePath,Pair<SourcePath,String>>> input=ImmutableList.of(newEntry("foo.m"),newEntry("bar.m","-flag1 -flag2"),newEntry("baz.m"),newEntry("quox.m","-flag1"));
  RuleUtils.extractSourcePaths(files,perFileCompileFlags,input);
  assertEquals(ImmutableSortedSet.<SourcePath>of(new FileSourcePath("foo.m"),new FileSourcePath("bar.m"),new FileSourcePath("baz.m"),new FileSourcePath("quox.m")),files.build());
  assertEquals(ImmutableMap.<SourcePath,String>of(new FileSourcePath("bar.m"),"-flag1 -flag2",new FileSourcePath("quox.m"),"-flag1"),perFileCompileFlags.build());
}
