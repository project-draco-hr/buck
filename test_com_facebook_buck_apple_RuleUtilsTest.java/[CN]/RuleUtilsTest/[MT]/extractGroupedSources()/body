{
  ImmutableSortedSet.Builder<SourceWithFlags> sourcePaths=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> publicHeaderPaths=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> privateHeaderPaths=ImmutableSortedSet.naturalOrder();
  ImmutableList<SourceWithFlags> input=ImmutableList.of(SourceWithFlags.of(new TestSourcePath("Group1/foo.m")),SourceWithFlags.of(new TestSourcePath("Group1/bar.m"),ImmutableList.of("-Wall")),SourceWithFlags.of(new TestSourcePath("Group2/baz.m")),SourceWithFlags.of(new TestSourcePath("Group2/blech.m"),ImmutableList.of("-fobjc-arc")));
  SourcePathResolver resolver=new SourcePathResolver(new BuildRuleResolver());
  RuleUtils.extractSourcePaths(sourcePaths,publicHeaderPaths,privateHeaderPaths,input,ImmutableSortedSet.<SourcePath>of(),ImmutableSortedSet.<SourcePath>of());
  ImmutableList<GroupedSource> sources=RuleUtils.createGroupsFromSourcePaths(resolver,sourcePaths.build(),publicHeaderPaths.build(),privateHeaderPaths.build());
  assertEquals(ImmutableList.of(GroupedSource.ofSourceGroup("Group1",ImmutableList.of(GroupedSource.ofSourceWithFlags(SourceWithFlags.of(new TestSourcePath("Group1/bar.m"),ImmutableList.of("-Wall"))),GroupedSource.ofSourceWithFlags(SourceWithFlags.of(new TestSourcePath("Group1/foo.m"))))),GroupedSource.ofSourceGroup("Group2",ImmutableList.of(GroupedSource.ofSourceWithFlags(SourceWithFlags.of(new TestSourcePath("Group2/baz.m"))),GroupedSource.ofSourceWithFlags(SourceWithFlags.of(new TestSourcePath("Group2/blech.m"),ImmutableList.of("-fobjc-arc")))))),sources);
}
