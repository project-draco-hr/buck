{
  BuildTarget target=BuildTargetFactory.newInstance("//src/com/facebook:Main");
  BuildRuleFactoryParams params=new BuildRuleFactoryParams(null,filesystem,tree,parser,target,new FakeRuleKeyBuilderFactory());
  @SuppressWarnings("rawtypes") AbstractBuildRuleBuilder builder=createMock(AbstractBuildRuleBuilder.class);
  expect(builder.addDep(new BuildTarget("//src/com/facebook","A"))).andReturn(builder);
  replay(builder);
  SourcePath first=params.asSourcePath("//src/com/facebook:A",builder);
  assertTrue(first instanceof BuildTargetSourcePath);
  assertEquals("//src/com/facebook:A",first.asReference());
  verify(builder);
}
