{
  Set<String> testClassNames=getClassNamesForSources();
  Iterable<String> reorderedTestClasses=reorderClasses(testClassNames,options.isShufflingTests());
  ImmutableList<String> properVmArgs=amendVmArgs(this.vmArgs,executionContext.getTargetDeviceOptional());
  return new JUnitStep(getProjectFilesystem(),ImmutableSet.of("@" + getProjectFilesystem().resolve(getClassPathFile())),reorderedTestClasses,properVmArgs,nativeLibsEnvironment,outDir,getBuildTarget().getBasePath(),tempDir,executionContext.isCodeCoverageEnabled(),executionContext.isDebugEnabled(),executionContext.getBuckEventBus().getBuildId(),options.getTestSelectorList(),options.isDryRun(),testType,testRuleTimeoutMs,stdOutLogLevel,stdErrLogLevel,options.getPathToJavaAgent());
}
