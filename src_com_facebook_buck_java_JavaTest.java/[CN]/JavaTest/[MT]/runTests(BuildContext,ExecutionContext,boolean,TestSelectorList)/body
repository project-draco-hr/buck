{
  Set<String> testClassNames=getClassNamesForSources(executionContext);
  if (testClassNames.isEmpty()) {
    return ImmutableList.of();
  }
  ImmutableList.Builder<Step> steps=ImmutableList.builder();
  Path pathToTestOutput=getPathToTestOutputDirectory();
  Path tmpDirectory=getPathToTmpDirectory();
  steps.add(new MakeCleanDirectoryStep(pathToTestOutput));
  steps.add(new MakeCleanDirectoryStep(tmpDirectory));
  ImmutableSet<Path> classpathEntries=ImmutableSet.<Path>builder().addAll(getTransitiveClasspathEntries().values()).addAll(additionalClasspathEntries).addAll(getBootClasspathEntries(executionContext)).build();
  Step junit=new JUnitStep(classpathEntries,testClassNames,amendVmArgs(vmArgs,executionContext.getTargetDeviceOptional()),pathToTestOutput,tmpDirectory,executionContext.isCodeCoverageEnabled(),executionContext.isDebugEnabled(),executionContext.getBuckEventBus().getBuildId(),testSelectorList,isDryRun,testType);
  steps.add(junit);
  return steps.build();
}
