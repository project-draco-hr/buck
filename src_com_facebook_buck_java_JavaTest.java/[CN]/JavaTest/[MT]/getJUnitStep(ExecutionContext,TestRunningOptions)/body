{
  Set<String> testClassNames=getClassNamesForSources();
  Iterable<String> reorderedTestClasses=reorderClasses(testClassNames,options.isShufflingTests());
  ImmutableSet<Path> classpathEntries=ImmutableSet.<Path>builder().addAll(getTransitiveClasspathEntries().values()).addAll(additionalClasspathEntries).addAll(getBootClasspathEntries(executionContext)).build();
  ImmutableList<String> properVmArgs=amendVmArgs(this.vmArgs,executionContext.getTargetDeviceOptional());
  return new JUnitStep(getProjectFilesystem(),classpathEntries,reorderedTestClasses,properVmArgs,nativeLibsEnvironment,getPathToTestOutputDirectory(),getBuildTarget().getBasePath(),getPathToTmpDirectory(),executionContext.isCodeCoverageEnabled(),executionContext.isDebugEnabled(),executionContext.getBuckEventBus().getBuildId(),options.getTestSelectorList(),options.isDryRun(),testType,testRuleTimeoutMs,stdOutLogLevel,stdErrLogLevel,options.getPathToJavaAgent());
}
