{
  BuildRuleResolver resolver=new BuildRuleResolver();
  BuildTarget bundleLoaderTarget=BuildTargetFactory.newInstance("//foo:bundleLoader");
  BuildRuleParams bundleLoaderParams=BuildRuleParamsFactory.createTrivialBuildRuleParams(bundleLoaderTarget);
  CxxLink bundleLoaderRule=CxxLinkableEnhancer.createCxxLinkableBuildRule(CXX_PLATFORM,bundleLoaderParams,new SourcePathResolver(resolver),ImmutableList.<String>of(),bundleLoaderTarget,Linker.LinkType.EXECUTABLE,Optional.<String>absent(),DEFAULT_OUTPUT,ImmutableList.<SourcePath>of(new TestSourcePath("simple.o")),Linker.LinkableDepType.STATIC,EMPTY_DEPS,Optional.<Linker.CxxRuntimeType>absent(),Optional.<SourcePath>absent());
  resolver.addToIndex(bundleLoaderRule);
  BuildTarget bundleTarget=BuildTargetFactory.newInstance("//foo:bundle");
  BuildRuleParams bundleParams=BuildRuleParamsFactory.createTrivialBuildRuleParams(bundleTarget);
  CxxLink bundleRule=CxxLinkableEnhancer.createCxxLinkableBuildRule(CXX_PLATFORM,bundleParams,new SourcePathResolver(resolver),ImmutableList.<String>of(),bundleTarget,Linker.LinkType.MACH_O_BUNDLE,Optional.<String>absent(),DEFAULT_OUTPUT,ImmutableList.<SourcePath>of(new TestSourcePath("another.o")),Linker.LinkableDepType.STATIC,EMPTY_DEPS,Optional.<Linker.CxxRuntimeType>absent(),Optional.<SourcePath>of(new BuildTargetSourcePath(bundleLoaderRule.getBuildTarget())));
  assertThat(bundleRule.getDeps(),hasItem(bundleLoaderRule));
}
