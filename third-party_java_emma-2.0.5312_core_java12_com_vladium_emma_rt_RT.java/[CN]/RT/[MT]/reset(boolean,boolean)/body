{
  ClassLoader loader=RT.class.getClassLoader();
  if (loader == null)   loader=ClassLoader.getSystemClassLoader();
  IProperties appProperties=null;
  try {
    appProperties=EMMAProperties.getAppProperties(loader);
  }
 catch (  Throwable t) {
    t.printStackTrace(System.out);
  }
  s_appProperties=appProperties;
  if (EXIT_HOOK_MANAGER != null) {
    if (s_exitHook != null) {
      EXIT_HOOK_MANAGER.removeExitHook(s_exitHook);
      s_exitHook=null;
    }
  }
  ICoverageData cdata=s_cdata;
  if (createCoverageData) {
    cdata=DataFactory.newCoverageData();
    s_cdata=cdata;
  }
 else {
    s_cdata=null;
  }
  if (EXIT_HOOK_MANAGER != null) {
    if (createExitHook && (cdata != null)) {
      final Runnable exitHook=new RTExitHook(RT.class,cdata,getCoverageOutFile(),getCoverageOutMerge());
      RTExitHook.createClassLoaderClosure();
      if (EXIT_HOOK_MANAGER.addExitHook(exitHook)) {
        s_exitHook=exitHook;
      }
    }
  }
  return cdata;
}
