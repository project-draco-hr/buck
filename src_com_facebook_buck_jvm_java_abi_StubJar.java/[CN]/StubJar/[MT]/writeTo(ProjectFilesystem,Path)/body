{
  Preconditions.checkState(!filesystem.exists(path),"Output file already exists: %s)",path);
  if (path.getParent() != null && !filesystem.exists(path.getParent())) {
    filesystem.createParentDirs(path);
  }
  Walker walker=Walkers.getWalkerFor(toMirror);
  try (OutputStream fos=filesystem.newFileOutputStream(path);JarOutputStream jar=new JarOutputStream(fos)){
    final CreateStubAction createStubAction=new CreateStubAction(jar);
    walker.walk(createStubAction);
    createStubAction.finish();
  }
 }
