{
  String targetName=finishedTest.getBuildTarget().getFullyQualifiedName();
  Preconditions.checkState(allTestResults.containsKey(finishedTest),"Unexpected test results found for test '%s'",targetName);
  Preconditions.checkState(allTestResults.get(finishedTest) == null,"Duplicate test results found for test '%s'",targetName);
  allTestResults.put(finishedTest,testResults);
  pendingTestRules.add(finishedTest);
  return ImmutableMap.copyOf(flush());
}
