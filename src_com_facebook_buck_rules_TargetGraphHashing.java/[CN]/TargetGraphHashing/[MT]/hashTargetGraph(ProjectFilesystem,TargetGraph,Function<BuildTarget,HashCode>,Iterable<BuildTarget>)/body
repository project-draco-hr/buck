{
  try {
    Map<BuildTarget,HashCode> buildTargetHashes=new HashMap<>();
    TargetGraphHashingTraversal traversal=new TargetGraphHashingTraversal(projectFilesystem,targetGraph,buildTargetToRuleHashCode,buildTargetHashes);
    traversal.traverse(targetGraph.getAll(roots));
    return ImmutableMap.copyOf(buildTargetHashes);
  }
 catch (  CycleException|InterruptedException e) {
    throw new RuntimeException(e);
  }
}
