{
  SourcePathResolver pathResolver=new SourcePathResolver(new BuildRuleResolver());
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  RuleKeyBuilderFactory ruleKeyBuilderFactory=new FakeRuleKeyBuilderFactory(FakeFileHashCache.createFromStrings(ImmutableMap.of("lex",Strings.repeat("a",40),"input",Strings.repeat("b",40),"different",Strings.repeat("c",40))));
  RuleKey.Builder.RuleKeyPair defaultRuleKey=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,DEFAULT_LEX,DEFAULT_FLAGS,DEFAULT_OUTPUT_SOURCE,DEFAULT_OUTPUT_HEADER,DEFAULT_INPUT));
  RuleKey.Builder.RuleKeyPair lexChange=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,new TestSourcePath("different"),DEFAULT_FLAGS,DEFAULT_OUTPUT_SOURCE,DEFAULT_OUTPUT_HEADER,DEFAULT_INPUT));
  assertNotEquals(defaultRuleKey.getTotalRuleKey(),lexChange.getTotalRuleKey());
  RuleKey.Builder.RuleKeyPair flagsChange=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,DEFAULT_LEX,ImmutableList.of("-different"),DEFAULT_OUTPUT_SOURCE,DEFAULT_OUTPUT_HEADER,DEFAULT_INPUT));
  assertNotEquals(defaultRuleKey.getTotalRuleKey(),flagsChange.getTotalRuleKey());
  RuleKey.Builder.RuleKeyPair outputSourceChange=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,DEFAULT_LEX,DEFAULT_FLAGS,Paths.get("different"),DEFAULT_OUTPUT_HEADER,DEFAULT_INPUT));
  assertNotEquals(defaultRuleKey.getTotalRuleKey(),outputSourceChange.getTotalRuleKey());
  RuleKey.Builder.RuleKeyPair outputHeaderChange=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,DEFAULT_LEX,DEFAULT_FLAGS,DEFAULT_OUTPUT_SOURCE,Paths.get("different"),DEFAULT_INPUT));
  assertNotEquals(defaultRuleKey.getTotalRuleKey(),outputHeaderChange.getTotalRuleKey());
  RuleKey.Builder.RuleKeyPair inputChange=generateRuleKey(ruleKeyBuilderFactory,new Lex(params,pathResolver,DEFAULT_LEX,DEFAULT_FLAGS,DEFAULT_OUTPUT_SOURCE,DEFAULT_OUTPUT_HEADER,new TestSourcePath("different")));
  assertNotEquals(defaultRuleKey.getTotalRuleKey(),inputChange.getTotalRuleKey());
}
