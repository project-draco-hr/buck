{
  assumeTrue(Platform.detect() == Platform.MACOS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"apple_test_dependencies_test",tmp);
  workspace.setUp();
  workspace.copyRecursively(TestDataHelper.getTestDataDirectory(this).resolve("xctool"),Paths.get("xctool"));
  ProjectWorkspace.ProcessResult result=workspace.runBuckCommand("test","//:App");
  result.assertSuccess();
  ProcessExecutor.Result hasSymbol=workspace.runCommand("nm",workspace.getPath(BuildTargets.getGenPath(filesystem,workspace.newBuildTarget("//:AppTests#apple-test-library,iphonesimulator-x86_64,mach-o-bundle"),"%s/libAppTests#apple-test-library.dylib")).toString());
  assertThat(hasSymbol.getExitCode(),equalTo(0));
  assertThat(hasSymbol.getStdout().get(),containsString("U _OBJC_CLASS_$_Library"));
}
