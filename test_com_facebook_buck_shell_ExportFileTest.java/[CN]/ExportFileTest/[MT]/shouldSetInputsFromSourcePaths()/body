{
  ProjectFilesystem projectFilesystem=new FakeProjectFilesystem();
  ExportFileBuilder builder=ExportFileBuilder.newExportFileBuilder(target).setSrc(new TestSourcePath("chips")).setOut("cake");
  ExportFile exportFile=(ExportFile)builder.build(new BuildRuleResolver());
  assertIterablesEquals(singleton(Paths.get("chips")),exportFile.getSource());
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  FakeBuildRule rule=new FakeBuildRule(BuildTargetFactory.newInstance("//example:one"),new SourcePathResolver(ruleResolver));
  builder.setSrc(new BuildTargetSourcePath(projectFilesystem,rule.getBuildTarget()));
  exportFile=(ExportFile)builder.build(ruleResolver);
  assertTrue(Iterables.isEmpty(exportFile.getSource()));
  builder.setSrc(null);
  exportFile=(ExportFile)builder.build(new BuildRuleResolver());
  assertIterablesEquals(singleton(Paths.get("example.html")),exportFile.getSource());
}
