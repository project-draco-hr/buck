{
  ProjectFilesystem projectFilesystem=FakeProjectFilesystem.createJavaOnlyFilesystem();
  ExportFile exportFile=(ExportFile)ExportFileBuilder.newExportFileBuilder(target).setSrc(new PathSourcePath(projectFilesystem,Paths.get("chips"))).setOut("fish").build(new BuildRuleResolver(TargetGraph.EMPTY,new BuildTargetNodeToBuildRuleTransformer()),projectFilesystem);
  List<Step> steps=exportFile.getBuildSteps(context,new FakeBuildableContext());
  MoreAsserts.assertSteps("The output directory should be created and then the file should be copied there.",ImmutableList.of("mkdir -p /opt/src/buck/buck-out/gen","rm -r -f /opt/src/buck/buck-out/gen/fish","cp " + projectFilesystem.resolve("chips") + " buck-out/gen/fish"),steps,TestExecutionContext.newInstance());
  assertEquals(Paths.get("buck-out/gen/fish"),exportFile.getPathToOutput());
}
