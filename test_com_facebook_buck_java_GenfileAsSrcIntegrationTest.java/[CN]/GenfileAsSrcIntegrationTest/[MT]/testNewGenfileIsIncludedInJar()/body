{
  final Charset charsetForTest=Charsets.UTF_8;
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"genfile_as_src_test",tmp);
  workspace.setUp();
  ProcessResult result=workspace.runBuckCommand("test","//:test");
  result.assertExitCode(0);
  File testFile=workspace.getFile("resource.base.txt");
  Files.write("Different text",testFile,charsetForTest);
  ProcessResult result2=workspace.runBuckCommand("test","//:test");
  result2.assertExitCode(1);
  assertThat("`buck test` should fail because testStringFromGenfile() failed.",result2.getStderr(),containsString("FAILURE testStringFromGenfile"));
}
