{
  ProjectFilesystem filesystem=new ProjectFilesystem(tmp.getRoot().toPath());
  ObjectMapper objectMapper=new ObjectMapper();
  ProcessExecutor fakeProcessExecutor=new FakeProcessExecutor(new Function<ProcessExecutorParams,FakeProcess>(){
    @Override public FakeProcess apply(    ProcessExecutorParams params){
      return new FakeProcess(0);
    }
  }
,new TestConsole());
  Object daemon=Main.getDaemon(new TestRepositoryBuilder().setBuckConfig(new FakeBuckConfig(ImmutableMap.of("somesection",ImmutableMap.of("somename","somevalue")))).setFilesystem(filesystem).build(),new FakeClock(0),objectMapper,fakeProcessExecutor);
  assertEquals("Daemon should not be replaced when config equal.",daemon,Main.getDaemon(new TestRepositoryBuilder().setBuckConfig(new FakeBuckConfig(ImmutableMap.of("somesection",ImmutableMap.of("somename","somevalue")))).setFilesystem(filesystem).build(),new FakeClock(0),objectMapper,fakeProcessExecutor));
  assertNotEquals("Daemon should be replaced when config not equal.",daemon,Main.getDaemon(new TestRepositoryBuilder().setBuckConfig(new FakeBuckConfig(ImmutableMap.of("somesection",ImmutableMap.of("somename","someothervalue")))).setFilesystem(filesystem).build(),new FakeClock(0),objectMapper,fakeProcessExecutor));
}
