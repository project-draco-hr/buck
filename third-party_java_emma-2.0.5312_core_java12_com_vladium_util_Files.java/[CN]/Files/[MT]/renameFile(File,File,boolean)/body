{
  if ((source == null) || !source.exists())   throw new IllegalArgumentException("invalid input source: [" + source + "]");
  if (target == null)   throw new IllegalArgumentException("null input: target");
  final boolean targetExists;
  if (!(targetExists=target.exists()) || overwrite) {
    if (targetExists) {
      target.delete();
    }
 else {
      final File targetDir=target.getParentFile();
      if ((targetDir != null) && !targetDir.equals(source.getParentFile()))       targetDir.mkdirs();
    }
    return source.renameTo(target);
  }
  return false;
}
