{
  SettableFakeClock clock=new SettableFakeClock(0,0);
  FakeListeningProcessExecutor executor=new FakeListeningProcessExecutor(ImmutableMultimap.<ProcessExecutorParams,FakeListeningProcessState>builder().putAll(ProcessExecutorParams.ofCommand(exe,"--output-encoding=bser","get-sockname"),FakeListeningProcessState.ofStdoutBytes(bserSerialized(ImmutableMap.of("version","3.8.0","sockname","/path/to/sock"))),FakeListeningProcessState.ofExit(0)).build(),clock);
  Watchman watchman=Watchman.build(executor,fakeWatchmanConnector(Paths.get("/path/to/sock"),0,ImmutableMap.of(ImmutableList.of("version",ImmutableMap.of("required",ImmutableSet.of("cmd-watch-project"),"optional",ImmutableSet.of("term-dirname","cmd-watch-project","wildmatch","wildmatch_multislash","glob_generator","cmd-clock"))),ImmutableMap.of("version","3.8.0","capabilities",ImmutableMap.<String,Boolean>builder().put("term-dirname",true).put("cmd-watch-project",true).put("wildmatch",true).put("wildmatch_multislash",true).put("glob_generator",false).put("cmd-clock",false).build()),ImmutableList.of("watch-project",root),ImmutableMap.of("version","3.8.0","watch",root))),Paths.get(root),env,finder,new TestConsole(),clock,Optional.<Long>absent());
  assertEquals(ImmutableSet.of(Watchman.Capability.DIRNAME,Watchman.Capability.SUPPORTS_PROJECT_WATCH,Watchman.Capability.WILDMATCH_GLOB,Watchman.Capability.WILDMATCH_MULTISLASH),watchman.getCapabilities());
  assertEquals(Optional.absent(),watchman.getClockId());
}
