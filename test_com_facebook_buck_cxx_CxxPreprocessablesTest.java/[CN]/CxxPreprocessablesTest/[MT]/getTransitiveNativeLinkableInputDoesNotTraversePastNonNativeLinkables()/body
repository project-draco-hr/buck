{
  String sentinal="bottom";
  CxxPreprocessorInput bottomInput=new CxxPreprocessorInput(ImmutableSet.<BuildTarget>of(),ImmutableList.of(sentinal),ImmutableList.<String>of(),ImmutableList.<Path>of(),ImmutableList.<Path>of());
  BuildRule bottom=createFakeCxxPreprocessorDep("//:bottom",bottomInput);
  BuildRule middle=new FakeBuildRule("//:middle",bottom);
  CxxPreprocessorInput topInput=new CxxPreprocessorInput(ImmutableSet.<BuildTarget>of(),ImmutableList.<String>of(),ImmutableList.<String>of(),ImmutableList.<Path>of(),ImmutableList.<Path>of());
  BuildRule top=createFakeCxxPreprocessorDep("//:top",topInput,middle);
  CxxPreprocessorInput totalInput=CxxPreprocessables.getTransitiveCxxPreprocessorInput(ImmutableList.of(top));
  assertTrue(bottomInput.getCppflags().contains(sentinal));
  assertFalse(totalInput.getCppflags().contains(sentinal));
}
