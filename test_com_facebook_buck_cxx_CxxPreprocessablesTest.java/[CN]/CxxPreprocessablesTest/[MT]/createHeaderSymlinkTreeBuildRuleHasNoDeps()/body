{
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  FakeBuildRule dep=createFakeBuildRule(BuildTargetFactory.newInstance("//random:dep"),pathResolver);
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=new FakeBuildRuleParamsBuilder(target).setDeclaredDeps(ImmutableSortedSet.<BuildRule>of(dep)).build();
  Path root=Paths.get("root");
  Genrule genrule=(Genrule)GenruleBuilder.newGenruleBuilder(BuildTargetFactory.newInstance("//:genrule")).setOut("foo/bar.o").build(resolver);
  ImmutableMap<Path,SourcePath> links=ImmutableMap.<Path,SourcePath>of(Paths.get("link1"),new TestSourcePath("hello"),Paths.get("link2"),new BuildTargetSourcePath(genrule.getBuildTarget()));
  HeaderSymlinkTree symlinkTree=CxxPreprocessables.createHeaderSymlinkTreeBuildRule(pathResolver,target,params,root,Optional.<Path>absent(),links);
  assertTrue(symlinkTree.getDeps().isEmpty());
}
