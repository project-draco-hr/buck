{
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  BuildRuleResolver resolver=new BuildRuleResolver();
  String name="foo/bar.ii";
  FakeBuildRule dep=createFakeBuildRule("//:test",new SourcePathResolver(resolver));
  resolver.addToIndex(dep);
  SourcePath input=new BuildTargetSourcePath(PROJECT_FILESYSTEM,dep.getBuildTarget());
  CxxSource cxxSource=ImmutableCxxSource.of(CxxSource.Type.CXX_CPP_OUTPUT,input,ImmutableList.<String>of());
  CxxCompile cxxCompile=CxxCompilableEnhancer.createCompileBuildRule(params,resolver,CXX_PLATFORM,ImmutableList.<String>of(),false,name,cxxSource);
  assertEquals(ImmutableSortedSet.<BuildRule>of(dep),cxxCompile.getDeps());
}
