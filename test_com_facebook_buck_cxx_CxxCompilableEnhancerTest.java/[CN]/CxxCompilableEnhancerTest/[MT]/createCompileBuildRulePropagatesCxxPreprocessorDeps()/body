{
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  BuildRuleResolver resolver=new BuildRuleResolver();
  FakeBuildRule dep=resolver.addToIndex(createFakeBuildRule("//:dep1"));
  CxxPreprocessorInput cxxPreprocessorInput=new CxxPreprocessorInput(ImmutableSet.of(dep.getBuildTarget()),ImmutableList.<String>of(),ImmutableList.<String>of(),ImmutableList.<Path>of(),ImmutableList.<Path>of());
  String name="foo/bar.cpp";
  SourcePath input=new PathSourcePath(target.getBasePath().resolve(name));
  Path output=CxxCompilableEnhancer.getCompileOutputPath(target,name);
  CxxSource cxxSource=new CxxSource(name,input,output);
  CxxCompile cxxCompile=CxxCompilableEnhancer.createCompileBuildRule(params,resolver,CxxCompilables.DEFAULT_CXX_COMPILER,cxxPreprocessorInput,ImmutableList.<String>of(),cxxSource);
  assertEquals(ImmutableSortedSet.<BuildRule>of(dep),cxxCompile.getDeps());
}
