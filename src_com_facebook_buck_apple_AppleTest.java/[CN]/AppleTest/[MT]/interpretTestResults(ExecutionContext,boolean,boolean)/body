{
  return new Callable<TestResults>(){
    @Override public TestResults call() throws Exception {
      List<TestCaseSummary> testCaseSummaries;
      if (xctoolStdoutReader.isPresent()) {
        testCaseSummaries=xctoolStdoutReader.get().getTestCaseSummaries();
      }
 else {
        Path resolvedOutputPath=getProjectFilesystem().resolve(testOutputPath);
        try (BufferedReader reader=Files.newBufferedReader(resolvedOutputPath,StandardCharsets.UTF_8)){
          if (useXctest) {
            testCaseSummaries=XctestOutputParsing.parseOutputFromReader(reader);
          }
 else {
            TestCaseSummariesBuildingXctoolEventHandler xctoolEventHandler=new TestCaseSummariesBuildingXctoolEventHandler(NOOP_REPORTING_CALLBACK);
            XctoolOutputParsing.streamOutputFromReader(reader,xctoolEventHandler);
            testCaseSummaries=xctoolEventHandler.getTestCaseSummaries();
          }
        }
       }
      return TestResults.of(getBuildTarget(),testCaseSummaries,contacts,FluentIterable.from(labels).transform(Functions.toStringFunction()).toSet());
    }
  }
;
}
