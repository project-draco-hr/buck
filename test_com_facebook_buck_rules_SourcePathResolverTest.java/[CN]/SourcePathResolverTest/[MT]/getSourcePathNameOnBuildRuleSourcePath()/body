{
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  String out="test/blah.txt";
  Genrule genrule=(Genrule)GenruleBuilder.newGenruleBuilder(BuildTargetFactory.newInstance("//:genrule")).setOut(out).build(resolver);
  BuildRuleSourcePath buildRuleSourcePath1=new BuildRuleSourcePath(genrule);
  String actual1=pathResolver.getSourcePathName(BuildTargetFactory.newInstance("//:test"),buildRuleSourcePath1);
  assertEquals(out,actual1);
  BuildTarget fakeBuildTarget=BuildTargetFactory.newInstance("//:fake");
  FakeBuildRule fakeBuildRule=new FakeBuildRule(new FakeBuildRuleParamsBuilder(fakeBuildTarget).build(),pathResolver);
  BuildRuleSourcePath buildRuleSourcePath2=new BuildRuleSourcePath(fakeBuildRule);
  String actual2=pathResolver.getSourcePathName(BuildTargetFactory.newInstance("//:test"),buildRuleSourcePath2);
  assertEquals(fakeBuildTarget.getShortNameOnly(),actual2);
}
