{
  BuildRuleResolver buildRuleResolver=new BuildRuleResolver();
  BuildTarget target=BuildTargetFactory.newInstance("//:target");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  ProjectFilesystem filesystem=new AllExistingProjectFilesystem();
  FakeBuckConfig buckConfig=new FakeBuckConfig(filesystem);
  CxxPlatform platform=DefaultCxxPlatforms.build(new CxxBuckConfig(buckConfig));
  CxxSourceRuleFactory cxxSourceRuleFactory=new CxxSourceRuleFactory(params,buildRuleResolver,new SourcePathResolver(buildRuleResolver),platform,ImmutableList.<CxxPreprocessorInput>of(),ImmutableList.<String>of());
  String objcSourceName="test.m";
  CxxSource objcSource=CxxSource.of(CxxSource.Type.OBJC,new TestSourcePath(objcSourceName),ImmutableList.<String>of());
  CxxPreprocessAndCompile objcCompile=cxxSourceRuleFactory.requirePreprocessAndCompileBuildRule(buildRuleResolver,objcSourceName,objcSource,CxxSourceRuleFactory.PicType.PDC,CxxPreprocessMode.SEPARATE);
  CxxPreprocessAndCompile objcCompile2=cxxSourceRuleFactory.requirePreprocessAndCompileBuildRule(buildRuleResolver,objcSourceName,objcSource,CxxSourceRuleFactory.PicType.PDC,CxxPreprocessMode.SEPARATE);
  assertEquals(objcCompile.getBuildTarget(),objcCompile2.getBuildTarget());
}
