{
  Path tasty=Paths.get("python/tastypy.py");
  BuildTarget pyLibraryTarget=BuildTargetFactory.newInstance("//:py_library");
  PythonLibrary pyLibrary=new PythonLibrary(pyLibraryTarget,ImmutableSortedSet.<SourcePath>of(new TestSourcePath(tasty.toString())),ImmutableSortedSet.<SourcePath>of());
  BuildRule pyLibraryRule=createBuildRule(pyLibrary,pyLibraryTarget);
  PythonBinary buildable=new PythonBinary(new BuildTarget("//","python_binary"),ImmutableSortedSet.<BuildRule>of(pyLibraryRule),tasty);
  try {
    buildable.getAllComponents();
  }
 catch (  HumanReadableException e) {
    assertThat(e.getHumanReadableErrorMessage(),containsString("found duplicate entries for module " + tasty.toString()));
  }
}
