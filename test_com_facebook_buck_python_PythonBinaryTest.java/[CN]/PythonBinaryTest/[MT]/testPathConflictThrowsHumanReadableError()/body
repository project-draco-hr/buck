{
  Path tasty=Paths.get("python/tastypy.py");
  BuildTarget pyLibraryTarget=BuildTargetFactory.newInstance("//:py_library");
  PythonLibrary pyLibrary=new PythonLibrary(new FakeBuildRuleParamsBuilder(pyLibraryTarget).build(),ImmutableSortedSet.<SourcePath>of(new TestSourcePath(tasty.toString())),ImmutableSortedSet.<SourcePath>of());
  PythonBinary buildable=new PythonBinary(new FakeBuildRuleParamsBuilder(BuildTarget.builder("//","python_binary").build()).setDeps(ImmutableSortedSet.<BuildRule>of(pyLibrary)).build(),tasty);
  try {
    buildable.getAllComponents();
  }
 catch (  HumanReadableException e) {
    assertThat(e.getHumanReadableErrorMessage(),containsString("found duplicate entries for module " + tasty.toString()));
  }
}
