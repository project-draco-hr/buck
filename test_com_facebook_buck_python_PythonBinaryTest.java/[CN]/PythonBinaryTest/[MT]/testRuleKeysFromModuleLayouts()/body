{
  SourcePathResolver resolver=new SourcePathResolver(new BuildRuleResolver());
  Path main=tmpDir.newFile().toPath();
  Files.write(main,"main".getBytes(Charsets.UTF_8));
  Path source1=tmpDir.newFile().toPath();
  Files.write(source1,"hello world".getBytes(Charsets.UTF_8));
  Path source2=tmpDir.newFile().toPath();
  Files.write(source2,"goodbye world".getBytes(Charsets.UTF_8));
  Path mainRelative=MorePaths.relativize(tmpDir.getRoot().toPath(),main);
  Path source1Relative=MorePaths.relativize(tmpDir.getRoot().toPath(),source1);
  Path source2Relative=MorePaths.relativize(tmpDir.getRoot().toPath(),source2);
  RuleKeyBuilderFactory ruleKeyBuilderFactory=new DefaultRuleKeyBuilderFactory(FakeFileHashCache.createFromStrings(ImmutableMap.of(mainRelative.toString(),Strings.repeat("a",40),source1Relative.toString(),Strings.repeat("b",40),source2Relative.toString(),Strings.repeat("c",40))),resolver);
  RuleKeyPair pair1=getRuleKeyForModuleLayout(ruleKeyBuilderFactory,resolver,"main.py",mainRelative,"module/one.py",source1Relative,"module/two.py",source2Relative);
  RuleKeyPair pair2=getRuleKeyForModuleLayout(ruleKeyBuilderFactory,resolver,"main.py",mainRelative,"module/two.py",source2Relative,"module/one.py",source1Relative);
  RuleKeyPair pair3=getRuleKeyForModuleLayout(ruleKeyBuilderFactory,resolver,"main.py",mainRelative,"module/one.py",source2Relative,"module/two.py",source1Relative);
  RuleKeyPair pair4=getRuleKeyForModuleLayout(ruleKeyBuilderFactory,resolver,"main.py",mainRelative,"module/two.py",source1Relative,"module/one.py",source2Relative);
  assertEquals(pair1.getTotalRuleKey(),pair2.getTotalRuleKey());
  assertEquals(pair3.getTotalRuleKey(),pair4.getTotalRuleKey());
  assertNotEquals(pair1.getTotalRuleKey(),pair3.getTotalRuleKey());
}
