{
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"gtest",tmp);
  workspace.setUp();
  ImmutableList<String> samples=ImmutableList.of("malformed_output","malformed_results","multisuite_success","no_tests","simple_success","simple_failure","simple_failure_with_output","simple_disabled");
  BuildTarget target=BuildTargetFactory.newInstance("//:test");
  ProjectFilesystem filesystem=new ProjectFilesystem(tmp.getRoot().toPath());
  CxxGtestTest test=new CxxGtestTest(new FakeBuildRuleParamsBuilder(target).setProjectFilesystem(filesystem).build(),new SourcePathResolver(new BuildRuleResolver()),new CommandTool.Builder().addArg(new TestSourcePath("")).build(),ImmutableMap.<String,String>of(),ImmutableSortedSet.<BuildRule>of(),ImmutableSet.<Label>of(),ImmutableSet.<String>of(),ImmutableSet.<BuildRule>of(),false);
  ExecutionContext context=TestExecutionContext.newBuilder().setProjectFilesystem(filesystem).build();
  for (  String sample : samples) {
    Path exitCode=Paths.get("unused");
    Path output=workspace.resolve(Paths.get(sample)).resolve("output");
    Path results=workspace.resolve(Paths.get(sample)).resolve("results");
    Path summaries=workspace.resolve(Paths.get(sample)).resolve("summaries");
    List<TestResultSummary> expectedSummaries=mapper.readValue(summaries.toFile(),SUMMARIES_REFERENCE);
    ImmutableList<TestResultSummary> actualSummaries=test.parseResults(context,exitCode,output,results);
    assertEquals(sample,expectedSummaries,actualSummaries);
  }
}
