{
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"gtest",tmp);
  workspace.setUp();
  ImmutableList<String> samples=ImmutableList.of("big_output","malformed_output","malformed_results","multisuite_success","no_tests","simple_success","simple_failure","simple_failure_with_output","simple_disabled");
  BuildTarget target=BuildTargetFactory.newInstance("//:test");
  ProjectFilesystem filesystem=new ProjectFilesystem(tmp.getRoot().toPath());
  SourcePathResolver pathResolver=new SourcePathResolver(new BuildRuleResolver(TargetGraph.EMPTY,new BuildTargetNodeToBuildRuleTransformer()));
  CxxGtestTest test=new CxxGtestTest(new FakeBuildRuleParamsBuilder(target).setProjectFilesystem(filesystem).build(),pathResolver,new CxxLink(new FakeBuildRuleParamsBuilder(BuildTargetFactory.newInstance("//:link")).build(),pathResolver,CxxPlatformUtils.DEFAULT_PLATFORM.getLd(),Paths.get("output"),ImmutableList.<Arg>of()),new CommandTool.Builder().addArg(new FakeSourcePath("")).build(),Suppliers.ofInstance(ImmutableMap.<String,String>of()),Suppliers.ofInstance(ImmutableList.<String>of()),Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of()),ImmutableSet.<Label>of(),ImmutableSet.<String>of(),ImmutableSet.<BuildRule>of(),false,Optional.<Long>absent(),100L);
  ExecutionContext context=TestExecutionContext.newInstance();
  for (  String sample : samples) {
    Path exitCode=Paths.get("unused");
    Path output=workspace.resolve(Paths.get(sample)).resolve("output");
    Path results=workspace.resolve(Paths.get(sample)).resolve("results");
    Path summaries=workspace.resolve(Paths.get(sample)).resolve("summaries");
    List<TestResultSummary> expectedSummaries=mapper.readValue(summaries.toFile(),SUMMARIES_REFERENCE);
    ImmutableList<TestResultSummary> actualSummaries=test.parseResults(context,exitCode,output,results);
    assertEquals(sample,expectedSummaries,actualSummaries);
  }
}
