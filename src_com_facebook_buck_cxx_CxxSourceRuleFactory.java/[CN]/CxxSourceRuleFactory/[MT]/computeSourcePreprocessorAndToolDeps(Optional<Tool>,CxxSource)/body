{
  ImmutableCollection<BuildRule> toolInputs=toolOptional.isPresent() ? toolOptional.get().getInputs(pathResolver) : ImmutableSet.<BuildRule>of();
  return ImmutableSortedSet.<BuildRule>naturalOrder().addAll(toolInputs).addAll(pathResolver.filterBuildRuleInputs(source.getPath())).addAll(preprocessDeps.get()).build();
}
