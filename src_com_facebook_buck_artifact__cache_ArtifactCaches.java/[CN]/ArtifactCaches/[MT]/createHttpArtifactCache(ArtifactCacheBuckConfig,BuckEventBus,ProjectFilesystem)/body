{
  URI uri=buckConfig.getHttpCacheUrl();
  int timeoutSeconds=buckConfig.getHttpCacheTimeoutSeconds();
  boolean doStore=buckConfig.getHttpCacheReadMode();
  final String host=buckConfig.getHostToReportToRemoteCacheServer();
  OkHttpClient client=new OkHttpClient();
  client.networkInterceptors().add(new Interceptor(){
    @Override public Response intercept(    Chain chain) throws IOException {
      return chain.proceed(chain.request().newBuilder().addHeader("X-BuckCache-User",System.getProperty("user.name","<unknown>")).addHeader("X-BuckCache-Host",host).build());
    }
  }
);
  client.setConnectTimeout(timeoutSeconds,TimeUnit.SECONDS);
  client.setConnectionPool(new ConnectionPool(200,TimeUnit.MINUTES.toMillis(5)));
  OkHttpClient fetchClient=client.clone();
  fetchClient.setReadTimeout(timeoutSeconds,TimeUnit.SECONDS);
  return new HttpArtifactCache("http",fetchClient,client,uri,doStore,projectFilesystem,buckEventBus);
}
