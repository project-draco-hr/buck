{
  FakeOutputStream outputStream=new FakeOutputStream();
  ConcurrentHashMap<Long,String> threadIdToCommandId=new ConcurrentHashMap<>();
  ConcurrentHashMap<String,OutputStreamWriter> commandIdToConsoleWriter=new ConcurrentHashMap<>();
  ConcurrentHashMap<String,Level> commandIdToLevel=new ConcurrentHashMap<>();
  ConsoleHandler handler=new ConsoleHandler(ConsoleHandler.utf8OutputStreamWriter(outputStream),new MessageOnlyFormatter(),Level.INFO,threadIdToCommandId,commandIdToConsoleWriter,commandIdToLevel);
  handler.publish(new LogRecord(Level.SEVERE,"Severe"));
  assertThat(outputStream.getLastFlushSize(),equalTo(6));
}
