{
  LOG.debug("Getting target hash for %s",targetGraphAndBuildTargets.getBuildTargets());
  TargetGraphAndBuildTargets targetsAndGraph=computeTargetsAndGraphToShowTargetHash(params,executor,targetGraphAndBuildTargets);
  Iterable<BuildTarget> matchingBuildTargetsWithTests=targetsAndGraph.getBuildTargets();
  TargetGraph targetGraphWithTests=targetsAndGraph.getTargetGraph();
  FileHashLoader fileHashLoader=createOrGetFileHashLoader(params);
  ImmutableMap<BuildTarget,HashCode> buildTargetHashes=TargetGraphHashing.hashTargetGraph(params.getCell(),targetGraphWithTests,fileHashLoader,matchingBuildTargetsWithTests);
  for (  BuildTarget target : targetGraphAndBuildTargets.getBuildTargets()) {
    processTargetHash(targetGraphWithTests,target,buildTargetHashes,showRulesResult);
  }
}
