{
  LOG.debug("Getting target hash for %s",targetGraphAndTargetNodes.getTargetNodes());
  TargetGraphAndTargetNodes targetGraphAndNodes=computeTargetsAndGraphToShowTargetHash(params,executor,targetGraphAndTargetNodes);
  TargetGraph targetGraphWithTests=targetGraphAndNodes.getTargetGraph();
  FileHashLoader fileHashLoader=createOrGetFileHashLoader(params);
  ImmutableMap<TargetNode<?>,HashCode> buildTargetHashes=TargetGraphHashing.hashTargetGraph(params.getCell(),targetGraphWithTests,fileHashLoader,targetGraphAndNodes.getTargetNodes());
  ImmutableMap<TargetNode<?>,HashCode> finalHashes=rehashWithTestsIfNeeded(targetGraphWithTests,targetGraphAndTargetNodes.getTargetNodes(),buildTargetHashes);
  for (  TargetNode<?> targetNode : targetGraphAndTargetNodes.getTargetNodes()) {
    processTargetHash(targetNode,showRulesResult,finalHashes);
  }
}
