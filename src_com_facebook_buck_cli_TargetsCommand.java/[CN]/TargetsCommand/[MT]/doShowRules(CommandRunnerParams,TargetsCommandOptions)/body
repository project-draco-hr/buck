{
  if (options.getArguments().isEmpty()) {
    params.getConsole().printBuildFailure("Must specify at least one build target.");
    return 1;
  }
  ImmutableSet<BuildTarget> matchingBuildTargets;
  TargetGraph targetGraph;
  try {
    Pair<ImmutableSet<BuildTarget>,TargetGraph> result=params.getParser().buildTargetGraphForTargetNodeSpecs(options.parseArgumentsAsTargetNodeSpecs(params.getBuckConfig(),params.getRepository().getFilesystem().getIgnorePaths(),options.getArguments()),new ParserConfig(params.getBuckConfig()),params.getBuckEventBus(),params.getConsole(),params.getEnvironment(),options.getEnableProfiling());
    matchingBuildTargets=result.getFirst();
    targetGraph=result.getSecond();
  }
 catch (  BuildTargetException|BuildFileParseException e) {
    params.getConsole().printBuildFailureWithoutStacktrace(e);
    return 1;
  }
  if (options.isShowTargetHash()) {
    return doShowTargetHash(params,options,matchingBuildTargets);
  }
 else {
    Optional<ActionGraph> actionGraph;
    if (options.isShowRuleKey() || options.isShowOutput()) {
      TargetGraphTransformer<ActionGraph> targetGraphTransformer=new TargetGraphToActionGraph(params.getBuckEventBus(),new BuildTargetNodeToBuildRuleTransformer());
      actionGraph=Optional.of(targetGraphTransformer.apply(targetGraph));
    }
 else {
      actionGraph=Optional.absent();
    }
    for (    BuildTarget target : ImmutableSortedSet.copyOf(matchingBuildTargets)) {
      ImmutableList.Builder<String> builder=ImmutableList.builder();
      builder.add(target.getFullyQualifiedName());
      if (actionGraph.isPresent()) {
        BuildRule rule=Preconditions.checkNotNull(actionGraph.get().findBuildRuleByTarget(target));
        if (options.isShowRuleKey()) {
          builder.add(rule.getRuleKey().toString());
        }
        if (options.isShowOutput()) {
          Path outputPath=rule.getPathToOutputFile();
          if (outputPath != null) {
            builder.add(outputPath.toString());
          }
        }
      }
      params.getConsole().getStdOut().println(Joiner.on(' ').join(builder.build()));
    }
  }
  return 0;
}
