{
  Matcher matcher=MACRO_PATTERN.matcher(blob);
  if (matcher.matches()) {
    if (!macros.contains(matcher.group(1))) {
      throw new MacroException(String.format("expanding %s: no such macro \"%s\"",matcher.group(),matcher.group(1)));
    }
    MacroMatchResult.Builder result=MacroMatchResult.builder();
    result.setMacroType(matcher.group(1));
    if (matcher.group(2) != null) {
      result.addAllMacroInput(Splitter.on(' ').trimResults().split(matcher.group(2)));
    }
    result.setStartIndex(0);
    result.setEndIndex(blob.length());
    return Optional.of(result.build());
  }
  return Optional.absent();
}
