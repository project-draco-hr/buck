{
  BuckEventBus eventBus=BuckEventBusFactory.newInstance();
  CapturingConsoleEventListener listener=new CapturingConsoleEventListener();
  eventBus.register(listener);
  BuildContext buildContext=BuildContext.builder().setActionGraph(createMock(ActionGraph.class)).setStepRunner(createMock(StepRunner.class)).setProjectFilesystem(createMock(ProjectFilesystem.class)).setArtifactCache(createMock(ArtifactCache.class)).setJavaPackageFinder(createMock(JavaPackageFinder.class)).setClock(createMock(Clock.class)).setBuildId(createMock(BuildId.class)).setEventBus(eventBus).build();
  buildContext.logError(new RuntimeException(),"Error detail: %s","BUILD_ID");
  assertEquals(ImmutableList.of("Error detail: BUILD_ID\njava.lang.RuntimeException"),listener.getLogMessages());
}
