{
  BuckEventBus eventBus=BuckEventBusFactory.newInstance();
  CapturingLogEventListener listener=new CapturingLogEventListener();
  eventBus.register(listener);
  BuildContext buildContext=BuildContext.builder().setDependencyGraph(createMock(DependencyGraph.class)).setStepRunner(createMock(StepRunner.class)).setProjectFilesystem(createMock(ProjectFilesystem.class)).setBuildEngine(createMock(BuildEngine.class)).setArtifactCache(createMock(ArtifactCache.class)).setJavaPackageFinder(createMock(JavaPackageFinder.class)).setEventBus(eventBus).build();
  buildContext.logError(new RuntimeException(),"Error detail: %s","BUILD_ID");
  assertEquals(ImmutableList.of("Error detail: BUILD_ID"),listener.getLogMessages());
}
