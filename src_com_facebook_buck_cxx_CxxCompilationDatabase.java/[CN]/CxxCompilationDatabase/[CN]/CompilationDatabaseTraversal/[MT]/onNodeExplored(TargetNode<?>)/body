{
  UnflavoredBuildTarget unflavoredTarget=node.getBuildTarget().getUnflavoredBuildTarget();
  Iterator<BuildRule> allBuildRulesIterator=buildRuleResolver.getBuildRules().iterator();
  while (allBuildRulesIterator.hasNext()) {
    BuildRule buildRule=allBuildRulesIterator.next();
    BuildTarget target=buildRule.getBuildTarget();
    if (unflavoredTarget.equals(target.getUnflavoredBuildTarget())) {
      if (CxxSourceRuleFactory.isCompileFlavoredBuildTarget(target)) {
        compileRules.add((CxxPreprocessAndCompile)buildRule);
      }
 else       if (!Sets.intersection(HEADER_SYMLINK_FLAVORS,target.getFlavors()).isEmpty()) {
        deps.add(buildRule);
      }
    }
  }
}
