{
  if (directories.size() == 1) {
    return Iterables.getOnlyElement(directories);
  }
  List<File> androidVersionDirectories=Lists.newArrayList();
  List<File> apiVersionDirectories=Lists.newArrayList();
  for (  File dir : directories) {
    if (dir.getName().startsWith("android-")) {
      androidVersionDirectories.add(dir);
    }
 else {
      apiVersionDirectories.add(dir);
    }
  }
  final VersionStringComparator comparator=new VersionStringComparator();
  if (!androidVersionDirectories.isEmpty()) {
    Collections.sort(androidVersionDirectories,new Comparator<File>(){
      @Override public int compare(      File a,      File b){
        String versionA=a.getName().substring("android-".length());
        String versionB=b.getName().substring("android-".length());
        return comparator.compare(versionA,versionB);
      }
    }
);
    return androidVersionDirectories.get(androidVersionDirectories.size() - 1);
  }
 else {
    Collections.sort(apiVersionDirectories,new Comparator<File>(){
      @Override public int compare(      File a,      File b){
        String versionA=a.getName();
        String versionB=b.getName();
        return comparator.compare(versionA,versionB);
      }
    }
);
    return apiVersionDirectories.get(apiVersionDirectories.size() - 1);
  }
}
