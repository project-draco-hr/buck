{
  ProjectFilesystem projectFilesystem=new ProjectFilesystem(tmpDir.getRoot().toPath());
  ChromeTraceBuildListener listener=new ChromeTraceBuildListener(projectFilesystem,new FakeClock(1409702151000000000L),new ObjectMapper(),Locale.US,TimeZone.getTimeZone("America/Los_Angeles"),3);
  try {
    tmpDir.getRoot().setReadOnly();
    listener.outputTrace(new BuildId("BUILD_ID"));
    fail("Expected an exception.");
  }
 catch (  HumanReadableException e) {
    assertEquals("Unable to write trace file: java.nio.file.AccessDeniedException: " + projectFilesystem.resolve(BuckConstant.BUCK_OUTPUT_PATH),e.getMessage());
  }
 finally {
    tmpDir.getRoot().setWritable(true);
  }
}
