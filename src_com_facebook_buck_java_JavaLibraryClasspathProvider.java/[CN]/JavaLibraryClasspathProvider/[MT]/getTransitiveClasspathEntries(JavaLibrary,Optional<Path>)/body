{
  final ImmutableSetMultimap.Builder<JavaLibrary,Path> classpathEntries=ImmutableSetMultimap.builder();
  ImmutableSetMultimap<JavaLibrary,Path> classpathEntriesForDeps=Classpaths.getClasspathEntries(javaLibraryRule.getDepsForTransitiveClasspathEntries());
  ImmutableSetMultimap<JavaLibrary,Path> classpathEntriesForExportedsDeps;
  if (javaLibraryRule instanceof ExportDependencies) {
    classpathEntriesForExportedsDeps=Classpaths.getClasspathEntries(((ExportDependencies)javaLibraryRule).getExportedDeps());
  }
 else {
    classpathEntriesForExportedsDeps=ImmutableSetMultimap.of();
  }
  classpathEntries.putAll(classpathEntriesForDeps);
  if (!classpathEntriesForExportedsDeps.isEmpty()) {
    classpathEntries.putAll(javaLibraryRule,classpathEntriesForExportedsDeps.values());
  }
  if (outputJar.isPresent()) {
    classpathEntries.put(javaLibraryRule,outputJar.get());
  }
  return classpathEntries.build();
}
