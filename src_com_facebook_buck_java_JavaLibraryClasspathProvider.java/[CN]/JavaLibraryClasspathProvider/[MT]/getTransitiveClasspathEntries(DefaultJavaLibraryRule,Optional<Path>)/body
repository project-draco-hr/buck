{
  final ImmutableSetMultimap.Builder<JavaLibraryRule,String> classpathEntries=ImmutableSetMultimap.builder();
  ImmutableSetMultimap<JavaLibraryRule,String> classpathEntriesForDeps=Classpaths.getClasspathEntries(javaLibraryRule.getDeps());
  ImmutableSetMultimap<JavaLibraryRule,String> classpathEntriesForExportedsDeps=Classpaths.getClasspathEntries(javaLibraryRule.getExportedDeps());
  classpathEntries.putAll(classpathEntriesForDeps);
  if (!classpathEntriesForExportedsDeps.isEmpty()) {
    classpathEntries.putAll(javaLibraryRule,classpathEntriesForExportedsDeps.values());
  }
  if (outputJar.isPresent()) {
    classpathEntries.put(javaLibraryRule,outputJar.get().toString());
  }
  return classpathEntries.build();
}
