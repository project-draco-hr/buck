{
  String type=object.get("type").getAsString();
  int timestamp=object.get("timestamp").getAsInt();
  String buildId=object.get("buildId").getAsString();
  int threadId=object.get("threadId").getAsInt();
  if (RULE_START.equals(type)) {
    String name=object.get("buildRule").getAsJsonObject().get("name").getAsString();
    return new RuleStart(timestamp,buildId,threadId,name);
  }
 else   if (RULE_END.equals(type)) {
    String name=object.get("buildRule").getAsJsonObject().get("name").getAsString();
    String status=object.get("status").getAsString();
    String cache=object.get("cacheResult").getAsString();
    return new RuleEnd(timestamp,buildId,threadId,name,status,cache.equals("HIT"));
  }
 else   if (TEST_RESULTS_AVAILABLE.equals(type)) {
    return TestResultsAvailable.factory(object,timestamp,buildId,threadId);
  }
 else {
    LOG.warn("Unhandled message: " + object.toString());
  }
  return null;
}
