{
  BuildRuleFactoryParams ruleFactoryParams=targetNode.getRuleFactoryParams();
  Description<T> description=targetNode.getDescription();
  T arg=targetNode.getConstructorArg();
  BuildRuleParams params=new BuildRuleParams(targetNode.getBuildTarget(),Suppliers.ofInstance(ruleResolver.getAllRules(targetNode.getDeclaredDeps())),Suppliers.ofInstance(ruleResolver.getAllRules(targetNode.getExtraDeps())),ruleFactoryParams.getProjectFilesystem(),targetNode.getCellNames(),ruleKeyBuilderFactory);
  BuildRule buildRule=description.createBuildRule(targetGraph,params,ruleResolver,arg);
  if (description instanceof FlavorableDescription && !targetNode.getBuildTarget().isFlavored()) {
    FlavorableDescription<T> flavorable=(FlavorableDescription<T>)description;
    flavorable.registerFlavors(arg,buildRule,targetNode.getCellNames(),ruleFactoryParams.getProjectFilesystem(),ruleKeyBuilderFactory,ruleResolver);
  }
  return buildRule;
}
