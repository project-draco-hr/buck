{
  List<Module> modules=Lists.newArrayList();
  ImmutableSet.Builder<Path> noDxJarsBuilder=ImmutableSet.builder();
  for (  ProjectConfig projectConfig : rules) {
    BuildRule srcRule=projectConfig.getSrcRule();
    if (srcRule instanceof AndroidBinary) {
      AndroidBinary androidBinary=(AndroidBinary)srcRule;
      AndroidPackageableCollection packageableCollection=androidBinary.getAndroidPackageableCollection();
      noDxJarsBuilder.addAll(packageableCollection.noDxClasspathEntries);
    }
    Module module=createModuleForProjectConfig(projectConfig);
    modules.add(module);
  }
  ImmutableSet<Path> noDxJars=noDxJarsBuilder.build();
  markNoDxJarsAsProvided(modules,noDxJars);
  return modules;
}
