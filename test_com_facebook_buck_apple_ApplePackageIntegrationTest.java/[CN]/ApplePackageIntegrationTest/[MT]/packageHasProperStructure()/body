{
  assumeTrue(Platform.detect() == Platform.MACOS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"simple_application_bundle",tmp);
  workspace.setUp();
  workspace.runBuckCommand("build","//:DemoApp").assertSuccess();
  workspace.getBuildLog().assertTargetBuiltLocally("//:DemoApp");
  workspace.runBuckCommand("clean").assertSuccess();
  workspace.runBuckCommand("build","//:DemoAppPackage").assertSuccess();
  workspace.getBuildLog().assertTargetWasFetchedFromCache("//:DemoApp");
  workspace.getBuildLog().assertTargetBuiltLocally("//:DemoAppPackage");
  Path templateDir=TestDataHelper.getTestDataScenario(this,"simple_application_bundle");
  ZipInspector zipInspector=new ZipInspector(workspace.getPath("buck-out/gen/DemoAppPackage.ipa"));
  zipInspector.assertFileExists(("Payload/DemoApp.app/DemoApp"));
  zipInspector.assertFileContents("Payload/DemoApp.app/PkgInfo",new String(Files.readAllBytes(templateDir.resolve("buck-out/gen/DemoApp#iphonesimulator-x86_64/DemoApp.app/PkgInfo.expected")),UTF_8));
}
