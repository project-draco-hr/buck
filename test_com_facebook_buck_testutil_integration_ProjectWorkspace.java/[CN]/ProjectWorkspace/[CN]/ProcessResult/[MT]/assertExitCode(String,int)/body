{
  if (exitCode == getExitCode()) {
    return;
  }
  String failureMessage=String.format("Expected exit code %d but was %d.",exitCode,getExitCode());
  System.err.println("=== " + failureMessage + " ===");
  System.err.println("=== STDERR ===");
  System.err.println(getStderr());
  System.err.println("=== STDOUT ===");
  System.err.println(getStdout());
  if (message != null) {
    fail(message);
  }
 else {
    fail(failureMessage);
  }
}
