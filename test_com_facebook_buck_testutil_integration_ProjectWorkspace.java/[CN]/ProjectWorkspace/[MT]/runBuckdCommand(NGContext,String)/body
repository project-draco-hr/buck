{
  assertTrue("setUp() must be run before this method is invoked",isSetUp);
  CapturingPrintStream stdout=new CapturingPrintStream();
  CapturingPrintStream stderr=new CapturingPrintStream();
  Main main=new Main(stdout,stderr);
  int exitCode=0;
  try {
    exitCode=main.runMainWithExitCode(destDir,Optional.<NGContext>of(context),args);
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    exitCode=Main.FAIL_EXIT_CODE;
  }
  return new ProcessResult(exitCode,stdout.getContentsAsString(Charsets.UTF_8),stderr.getContentsAsString(Charsets.UTF_8));
}
