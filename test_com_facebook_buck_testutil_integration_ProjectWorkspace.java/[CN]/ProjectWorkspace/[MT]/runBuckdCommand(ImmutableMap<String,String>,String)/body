{
  assertTrue("setUp() must be run before this method is invoked",isSetUp);
  CapturingPrintStream stdout=new CapturingPrintStream();
  CapturingPrintStream stderr=new CapturingPrintStream();
  NGContext context=new TestContext(environment);
  Main main=new Main(stdout,stderr);
  int exitCode=main.runMainWithExitCode(destDir,Optional.<NGContext>of(context),args);
  return new ProcessResult(exitCode,stdout.getContentsAsString(Charsets.UTF_8),stderr.getContentsAsString(Charsets.UTF_8));
}
