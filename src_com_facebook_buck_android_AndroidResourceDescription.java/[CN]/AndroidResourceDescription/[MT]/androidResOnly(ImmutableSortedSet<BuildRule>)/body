{
  return FluentIterable.from(deps).transform(new Function<BuildRule,BuildRule>(){
    @Override @Nullable public BuildRule apply(    BuildRule buildRule){
      if (buildRule instanceof AndroidResource) {
        return buildRule;
      }
 else       if (buildRule instanceof AndroidLibrary && ((AndroidLibrary)buildRule).isPrebuiltAar()) {
        return Iterables.getOnlyElement(FluentIterable.from(buildRule.getDeps()).filter(Predicates.instanceOf(AndroidResource.class)).toList());
      }
      return null;
    }
  }
).filter(Predicates.notNull()).toSortedSet(deps.comparator());
}
