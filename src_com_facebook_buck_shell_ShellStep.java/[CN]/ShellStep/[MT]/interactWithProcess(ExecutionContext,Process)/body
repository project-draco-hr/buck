{
  ImmutableSet.Builder<Option> options=ImmutableSet.builder();
  if (shouldFlushStdOutErrAsProgressIsMade()) {
    options.add(Option.PRINT_STD_OUT);
    options.add(Option.PRINT_STD_ERR);
  }
  if (context.getVerbosity() == Verbosity.SILENT) {
    options.add(Option.IS_SILENT);
  }
  ProcessExecutor executor=context.getProcessExecutor();
  ProcessExecutor.Result result=executor.execute(process,options.build(),getStdin());
  stdout=result.getStdout();
  stderr=result.getStderr();
  Verbosity verbosity=context.getVerbosity();
  if (!Strings.isNullOrEmpty(stdout) && shouldPrintStdout(verbosity)) {
    context.postEvent(ConsoleEvent.info("%s",stdout));
  }
  if (!Strings.isNullOrEmpty(stderr) && shouldPrintStderr(verbosity)) {
    context.postEvent(ConsoleEvent.severe("%s",stderr));
  }
  return result.getExitCode();
}
