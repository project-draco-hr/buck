{
  final MutableDirectedGraph<TargetNode<?>> subgraph=new MutableDirectedGraph<>();
  new AbstractBreadthFirstTraversal<TargetNode<?>>(roots){
    @Override public ImmutableSet<TargetNode<?>> visit(    TargetNode<?> node){
      subgraph.addNode(node);
      ImmutableSet<TargetNode<?>> dependencies=ImmutableSet.copyOf(getAll(node.getDeps()));
      for (      TargetNode<?> dependency : dependencies) {
        subgraph.addEdge(node,dependency);
      }
      return dependencies;
    }
  }
.start();
  return new TargetGraph(subgraph,buckEventBus);
}
