{
  assumeTrue(Platform.detect() != Platform.WINDOWS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"sh_binary_with_caching",temporaryFolder);
  workspace.setUp();
  ProcessResult buildResult=workspace.runBuckCommand("build","//:example_sh","-v","2");
  buildResult.assertSuccess();
  String outputPath="buck-out/gen/__example_sh__/example_sh.sh";
  File output=workspace.getFile(outputPath);
  assertTrue("Output file should be written to '" + outputPath + "'.",output.exists());
  assertTrue("Output file must be executable.",output.canExecute());
  File buckOutDir=workspace.getFile("buck-out");
  MoreFiles.rmdir(buckOutDir.toPath());
  buildResult=workspace.runBuckCommand("build","//:run_example","-v","2");
  buildResult.assertSuccess("Build failed when rerunning sh_binary from cache.");
  assertTrue("Output file must be retrieved from cache at '" + outputPath + ".",output.exists());
  assertTrue("Output file retrieved from cache must be executable.",output.canExecute());
}
