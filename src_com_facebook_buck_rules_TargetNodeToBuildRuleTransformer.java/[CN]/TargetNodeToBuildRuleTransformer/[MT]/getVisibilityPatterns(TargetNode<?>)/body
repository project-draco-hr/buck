{
  ImmutableSet.Builder<BuildTargetPattern> builder=ImmutableSet.builder();
  BuildRuleFactoryParams params=targetNode.getRuleFactoryParams();
  for (  String visibility : params.getOptionalListAttribute("visibility")) {
    builder.add(params.buildTargetPatternParser.parse(visibility,ParseContext.forVisibilityArgument()));
  }
  return builder.build();
}
