{
  BuildRuleResolver resolver=new BuildRuleResolver();
  FakeProjectFilesystem filesystem=new FakeProjectFilesystem();
  Path lexPath=Paths.get("lex");
  filesystem.touch(lexPath);
  Path yaccPath=Paths.get("yacc");
  filesystem.touch(yaccPath);
  FakeBuckConfig buckConfig=new FakeBuckConfig(ImmutableMap.<String,Map<String,String>>of("cxx",ImmutableMap.of("lex",lexPath.toString(),"yacc",yaccPath.toString())),filesystem);
  CxxBuckConfig cxxBuckConfig=new CxxBuckConfig(buckConfig);
  BuildTarget target=BuildTargetFactory.newInstance("//:test");
  BuildRuleParams params=BuildRuleParamsFactory.createTrivialBuildRuleParams(target);
  String lexSourceName="test.ll";
  BuildTarget genruleTarget=BuildTargetFactory.newInstance("//:genrule_lex");
  Genrule genrule=(Genrule)GenruleBuilder.newGenruleBuilder(genruleTarget).setOut(lexSourceName).build(resolver);
  SourcePath lexSource=new BuildRuleSourcePath(genrule);
  String yaccSourceName="test.yy";
  SourcePath yaccSource=new TestSourcePath(yaccSourceName);
  CxxHeaderSourceSpec actual=CxxDescriptionEnhancer.createLexYaccBuildRules(params,resolver,cxxBuckConfig,ImmutableList.<String>of(),ImmutableMap.of(lexSourceName,lexSource),ImmutableList.<String>of(),ImmutableMap.of(yaccSourceName,yaccSource));
  Lex lex=(Lex)resolver.get(CxxDescriptionEnhancer.createLexBuildTarget(target,lexSourceName));
  assertNotNull(lex);
  assertEquals(ImmutableSortedSet.<BuildRule>of(genrule),lex.getDeps());
  Yacc yacc=(Yacc)resolver.get(CxxDescriptionEnhancer.createYaccBuildTarget(target,yaccSourceName));
  assertNotNull(yacc);
  assertEquals(ImmutableSortedSet.<BuildRule>of(),yacc.getDeps());
  Path lexOutputSource=CxxDescriptionEnhancer.getLexSourceOutputPath(target,lexSourceName);
  Path lexOutputHeader=CxxDescriptionEnhancer.getLexHeaderOutputPath(target,lexSourceName);
  Path yaccOutputPrefix=CxxDescriptionEnhancer.getYaccOutputPrefix(target,yaccSourceName);
  Path yaccOutputSource=Yacc.getSourceOutputPath(yaccOutputPrefix);
  Path yaccOutputHeader=Yacc.getHeaderOutputPath(yaccOutputPrefix);
  CxxHeaderSourceSpec expected=new CxxHeaderSourceSpec(ImmutableMap.<Path,SourcePath>of(target.getBasePath().resolve(lexSourceName + ".h"),new BuildRuleSourcePath(lex,lexOutputHeader),target.getBasePath().resolve(yaccSourceName + ".h"),new BuildRuleSourcePath(yacc,yaccOutputHeader)),ImmutableList.of(new CxxSource(lexSourceName + ".cc",new BuildRuleSourcePath(lex,lexOutputSource)),new CxxSource(yaccSourceName + ".cc",new BuildRuleSourcePath(yacc,yaccOutputSource))));
  assertEquals(expected,actual);
}
