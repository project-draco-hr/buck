{
  ProjectFilesystem filesystem=FakeProjectFilesystem.createJavaOnlyFilesystem();
  BuckConfig buckConfig=new BuckConfig(new Config(ConfigBuilder.rawFromLines()),filesystem,Architecture.MIPSEL,Platform.UNKNOWN,ImmutableMap.<String,String>builder().putAll(System.getenv()).put("envKey","envValue").build());
  Cell cell=new TestCellBuilder().setFilesystem(filesystem).setBuckConfig(buckConfig).build();
  BuildJobState dump=DistributedBuildState.dump(buckConfig,emptyActionGraph(),defaultCodec(cell,Optional.<Parser>absent()),TargetGraph.EMPTY);
  DistributedBuildState distributedBuildState=new DistributedBuildState(dump);
  expectedException.expect(IllegalStateException.class);
  distributedBuildState.createBuckConfig(filesystem);
}
