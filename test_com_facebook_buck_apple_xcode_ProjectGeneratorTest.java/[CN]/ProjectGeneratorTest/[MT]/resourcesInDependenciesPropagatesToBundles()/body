{
  BuildTarget resourceTarget=BuildTarget.builder("//foo","res").build();
  TargetNode<?> resourceNode=AppleResourceBuilder.createBuilder(resourceTarget).setFiles(ImmutableSet.<SourcePath>of(new TestSourcePath("foo.png"))).setDirs(ImmutableSet.of(Paths.get("foodir"))).build();
  BuildTarget libraryTarget=BuildTarget.builder("//foo","lib").build();
  TargetNode<?> libraryNode=AppleLibraryBuilder.createBuilder(libraryTarget).setDeps(Optional.of(ImmutableSortedSet.of(resourceTarget))).build();
  BuildTarget bundleLibraryTarget=BuildTarget.builder("//foo","bundlelib").build();
  TargetNode<?> bundleLibraryNode=AppleLibraryBuilder.createBuilder(bundleLibraryTarget).setDeps(Optional.of(ImmutableSortedSet.of(libraryTarget))).build();
  BuildTarget bundleTarget=BuildTarget.builder("//foo","bundle").build();
  TargetNode<?> bundleNode=AppleBundleBuilder.createBuilder(bundleTarget).setExtension(Either.<AppleBundleExtension,String>ofLeft(AppleBundleExtension.BUNDLE)).setBinary(bundleLibraryTarget).build();
  ProjectGenerator projectGenerator=createProjectGeneratorForCombinedProject(ImmutableSet.of(resourceNode,libraryNode,bundleLibraryNode,bundleNode),ImmutableSet.of(bundleTarget));
  projectGenerator.createXcodeProjects();
  PBXProject generatedProject=projectGenerator.getGeneratedProject();
  PBXTarget target=assertTargetExistsAndReturnTarget(generatedProject,"//foo:bundle");
  assertHasSingletonResourcesPhaseWithEntries(target,"foo.png","foodir");
}
