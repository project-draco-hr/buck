{
  this.pathRelativeToProjectRoot=Preconditions.checkNotNull(pathRelativeToProjectRoot);
  this.field=Preconditions.checkNotNull(field);
  this.name=field.getName();
  Hint hint=field.getAnnotation(Hint.class);
  this.pyName=determinePyName(this.name,hint);
  Class<?> rawType=field.getType();
  Type genericType=field.getGenericType();
  this.isOptional=Optional.class.isAssignableFrom(rawType);
  if (List.class.isAssignableFrom(rawType) || Set.class.isAssignableFrom(rawType)) {
    this.containerType=rawType;
    if (!(genericType instanceof ParameterizedType)) {
      throw new IllegalArgumentException(String.format("Unable to detect type held in Collection. Field name was %s. Class was %s",field.getName(),genericType));
    }
    this.type=unwrapGenericType(genericType);
  }
 else   if (Optional.class.isAssignableFrom(rawType)) {
    this.type=unwrapGenericType(genericType);
    Class<?> container=null;
    if (genericType instanceof ParameterizedType) {
      Type containerType=((ParameterizedType)genericType).getActualTypeArguments()[0];
      if (containerType instanceof ParameterizedType) {
        Type rawContainerType=((ParameterizedType)containerType).getRawType();
        if (!(rawContainerType instanceof Class)) {
          throw new RuntimeException("Container type isn't a class: " + rawContainerType);
        }
        container=(Class<?>)rawContainerType;
        if (!Collection.class.isAssignableFrom(container)) {
          throw new RuntimeException("Cannot determine container type: " + container);
        }
      }
    }
    containerType=container;
  }
 else {
    this.containerType=null;
    this.type=Primitives.wrap(rawType);
  }
}
