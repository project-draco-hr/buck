{
  final Path sourceFolderPath=temporaryFolder.newFolder("source");
  Path stateFilePath=temporaryFolder.getRootPath().resolve("state_dump.bin");
  final Path destinationFolderPath=temporaryFolder.newFolder("destination");
  ProjectWorkspace sourceWorkspace=TestDataHelper.createProjectWorkspaceForScenario(this,"simple_java_target",new TemporaryRoot(){
    @Override public Path getRootPath(){
      return sourceFolderPath;
    }
  }
);
  sourceWorkspace.setUp();
  sourceWorkspace.runBuckBuild("//:lib","--distributed","--distributed-state-dump",stateFilePath.toString()).assertSuccess();
  ProjectWorkspace destinationWorkspace=TestDataHelper.createProjectWorkspaceForScenario(this,"empty",new TemporaryRoot(){
    @Override public Path getRootPath(){
      return destinationFolderPath;
    }
  }
);
  destinationWorkspace.setUp();
  destinationWorkspace.runBuckBuild("//:lib","--distributed","--distributed-state-dump",stateFilePath.toString()).assertSuccess();
}
