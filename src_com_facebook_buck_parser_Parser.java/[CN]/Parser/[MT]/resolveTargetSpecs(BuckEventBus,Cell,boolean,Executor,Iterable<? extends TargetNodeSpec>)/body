{
  ParserConfig parserConfig=new ParserConfig(rootCell.getBuckConfig());
  if (parserConfig.getEnableParallelParsing()) {
    Preconditions.checkState(permState instanceof ParallelDaemonicParserState);
    try (ParallelPerBuildState state=new ParallelPerBuildState((ParallelDaemonicParserState)permState,marshaller,eventBus,rootCell,enableProfiling)){
      return resolveTargetSpecsInParallel(state,rootCell,executor,parserConfig,specs);
    }
   }
  try (SerialPerBuildState state=new SerialPerBuildState(permState,marshaller,eventBus,rootCell,enableProfiling)){
    return resolveTargetSpecsSerially(state,rootCell,specs);
  }
 }
