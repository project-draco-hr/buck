{
  eventBus.post(ParseEvent.started(buildTargets));
  try (ProjectBuildFileParser buildFileParser=buildFileParserFactory.createParser(defaultIncludes)){
    if (!isCacheComplete(defaultIncludes)) {
      Set<File> buildTargetFiles=Sets.newHashSet();
      for (      BuildTarget buildTarget : buildTargets) {
        File buildFile=buildTarget.getBuildFile();
        boolean isNewElement=buildTargetFiles.add(buildFile);
        if (isNewElement) {
          parseBuildFile(buildFile,defaultIncludes,buildFileParser);
        }
      }
    }
    return findAllTransitiveDependencies(buildTargets,defaultIncludes,buildFileParser);
  }
  finally {
    eventBus.post(ParseEvent.finished(buildTargets));
  }
}
