{
  Preconditions.checkNotNull(filesystem);
  Preconditions.checkNotNull(includes);
  if (!projectFilesystem.getProjectRoot().equals(filesystem.getProjectRoot())) {
    throw new HumanReadableException(String.format("Unsupported root path change from %s to %s",projectFilesystem.getProjectRoot(),filesystem.getProjectRoot()));
  }
  if (!isCacheComplete(includes)) {
    knownBuildTargets.clear();
    parsedBuildFiles.clear();
    parseRawRulesInternal(buildFileParser.getAllRulesInProject(filesystem.getProjectRoot(),includes),null);
    allBuildFilesParsed=true;
  }
  return filterTargets(filter);
}
