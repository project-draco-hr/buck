{
  for (  Map<String,Object> map : rules) {
    if (isMetaRule(map)) {
      parseMetaRule(map);
      continue;
    }
    BuildRuleType buildRuleType=parseBuildRuleTypeFromRawRule(map);
    BuildTarget target=parseBuildTargetFromRawRule(map,source);
    BuildRuleFactory<?> factory=buildRuleTypes.getFactory(buildRuleType);
    if (factory == null) {
      throw new HumanReadableException("Unrecognized rule %s while parsing %s.",buildRuleType,target.getBuildFile());
    }
    BuildRuleBuilder<?> buildRuleBuilder=factory.newInstance(new BuildRuleFactoryParams(map,projectFilesystem,buildFileTreeCache.get(),buildTargetParser,target));
    Object existingRule=knownBuildTargets.put(target,buildRuleBuilder);
    if (existingRule != null) {
      throw new RuntimeException("Duplicate definition for " + target.getFullyQualifiedName());
    }
    parsedBuildFiles.put(normalize(target.getBuildFile().toPath()),map);
  }
}
