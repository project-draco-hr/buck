{
  ImmutableSet.Builder<Path> buildFiles=ImmutableSet.builder();
  for (  TargetNodeSpec spec : specs) {
    for (    Path buildFile : spec.getBuildFileSpec().findBuildFiles(cell)) {
      if (!cell.getFilesystem().isFile(buildFile)) {
        throw new MissingBuildFileException(spec,cell.getFilesystem().getRootPath().relativize(buildFile));
      }
      buildFiles.add(buildFile);
    }
  }
  state.startParsing(cell,buildFiles.build(),parserConfig,executor);
  ImmutableSet.Builder<BuildTarget> targets=ImmutableSet.builder();
  for (  TargetNodeSpec spec : specs) {
    for (    Path buildFile : spec.getBuildFileSpec().findBuildFiles(cell)) {
      ImmutableSet<TargetNode<?>> nodes=state.getAllTargetNodes(cell,buildFile);
      targets.addAll(spec.filter(nodes));
    }
  }
  return targets.build();
}
