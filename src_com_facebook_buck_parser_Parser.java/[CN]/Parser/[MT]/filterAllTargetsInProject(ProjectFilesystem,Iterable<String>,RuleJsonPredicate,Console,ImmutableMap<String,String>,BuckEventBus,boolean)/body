{
  Preconditions.checkNotNull(filesystem);
  Preconditions.checkNotNull(includes);
  ProjectFilesystem projectFilesystem=repository.getFilesystem();
  if (!projectFilesystem.getRootPath().equals(filesystem.getRootPath())) {
    throw new HumanReadableException(String.format("Unsupported root path change from %s to %s",projectFilesystem.getRootPath(),filesystem.getRootPath()));
  }
  buildTargetGraph(ImmutableList.of(new TargetNodePredicateSpec(new Predicate<TargetNode<?>>(){
    @Override public boolean apply(    TargetNode<?> input){
      return filter.isMatch(input.getRuleFactoryParams().getInstance(),input.getDescription().getBuildRuleType(),input.getBuildTarget());
    }
  }
,filesystem.getIgnorePaths())),includes,buckEventBus,console,environment,enableProfiling);
  return filterTargets(filter);
}
