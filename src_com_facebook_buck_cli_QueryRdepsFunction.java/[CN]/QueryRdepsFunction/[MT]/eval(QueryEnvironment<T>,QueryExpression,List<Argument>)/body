{
  Set<T> universeSet=args.get(0).getExpression().eval(env);
  env.buildTransitiveClosure(expression,universeSet,Integer.MAX_VALUE);
  final Predicate<T> inUniversePredicate=Predicates.in(env.getTransitiveClosure(universeSet));
  Set<T> visited=new LinkedHashSet<>();
  Set<T> argumentSet=args.get(1).getExpression().eval(env);
  Collection<T> current=argumentSet;
  int depthBound=args.size() > 2 ? args.get(2).getInteger() : Integer.MAX_VALUE;
  for (int i=0; i <= depthBound; i++) {
    Iterable<T> currentInUniverse=Iterables.filter(current,inUniversePredicate);
    Collection<T> next=env.getReverseDeps(Iterables.filter(currentInUniverse,Predicates.not(Predicates.in(visited))));
    Iterables.addAll(visited,currentInUniverse);
    if (next.isEmpty()) {
      break;
    }
    current=next;
  }
  return visited;
}
