{
  transport=new THttpClient(uri);
  transport.setReadTimeout(READ_TIMEOUT_MS);
  transport.setCustomHeader("X-Thrift-Protocol",type.toString());
  transport.open();
switch (type) {
case json:
    proto=new TJSONProtocol(transport);
  break;
case compact:
proto=new TCompactProtocol(transport);
break;
case binary:
default :
proto=new TBinaryProtocol(transport);
break;
}
}
