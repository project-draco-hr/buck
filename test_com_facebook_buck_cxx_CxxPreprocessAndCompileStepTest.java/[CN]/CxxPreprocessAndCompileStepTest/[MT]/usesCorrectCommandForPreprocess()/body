{
  ImmutableList<String> compiler=ImmutableList.of("compiler");
  ImmutableList<String> flags=ImmutableList.of("-Dtest=blah");
  Path output=Paths.get("test.ii");
  Path input=Paths.get("test.cpp");
  ImmutableMap<Path,Path> replacementPaths=ImmutableMap.of();
  CxxPreprocessAndCompileStep preprocessStep=new CxxPreprocessAndCompileStep(compiler,CxxPreprocessAndCompileStep.Operation.PREPROCESS,flags,output,input,replacementPaths,Optional.<DebugPathSanitizer>absent());
  ImmutableList<String> expectedPreprocessCommand=ImmutableList.<String>builder().addAll(compiler).add("-E").add("-Dtest=blah").add(input.toString()).build();
  ImmutableList<String> actualPreprocessCommand=preprocessStep.getCommand();
  assertEquals(expectedPreprocessCommand,actualPreprocessCommand);
}
