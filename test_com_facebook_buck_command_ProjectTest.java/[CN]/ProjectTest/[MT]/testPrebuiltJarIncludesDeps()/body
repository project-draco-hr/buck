{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  BuildRule cglib=PrebuiltJarBuilder.createBuilder(BuildTargetFactory.newInstance("//third_party/java/easymock:cglib")).setBinaryJar(Paths.get("third_party/java/easymock/cglib.jar")).build(ruleResolver);
  BuildRule objenesis=PrebuiltJarBuilder.createBuilder(BuildTargetFactory.newInstance("//third_party/java/easymock:objenesis")).setBinaryJar(Paths.get("third_party/java/easymock/objenesis.jar")).build(ruleResolver);
  BuildRule easymock=PrebuiltJarBuilder.createBuilder(BuildTargetFactory.newInstance("//third_party/java/easymock:easymock")).setBinaryJar(Paths.get("third_party/java/easymock/easymock.jar")).addDep(cglib).addDep(objenesis).build(ruleResolver);
  BuildTarget easyMockExampleTarget=BuildTargetFactory.newInstance("//third_party/java/easymock:example");
  BuildRule mockRule=ruleResolver.buildAndAddToIndex(AndroidLibrary.newAndroidLibraryRuleBuilder(new FakeBuildRuleBuilderParams()).setBuildTarget(easyMockExampleTarget).addDep(BuildTargetFactory.newInstance("//third_party/java/easymock:easymock")));
  BuildRule projectConfig=ProjectConfigBuilder.newProjectConfigRuleBuilder(BuildTargetFactory.newInstance("//third_party/java/easymock:project_config")).setSrcRule(mockRule).build(ruleResolver);
  ProjectWithModules projectWithModules=getModulesForPartialGraph(ruleResolver,ImmutableList.of(projectConfig),null);
  List<Module> modules=projectWithModules.modules;
  assertEquals("Should be one module for the android_library",1,modules.size());
  Module androidLibraryModule=Iterables.getOnlyElement(modules);
  assertListEquals(ImmutableList.of(DependentModule.newSourceFolder(),DependentModule.newLibrary(easymock.getBuildTarget(),"third_party_java_easymock_easymock_jar"),DependentModule.newLibrary(cglib.getBuildTarget(),"third_party_java_easymock_cglib_jar"),DependentModule.newLibrary(objenesis.getBuildTarget(),"third_party_java_easymock_objenesis_jar"),DependentModule.newInheritedJdk()),androidLibraryModule.dependencies);
}
