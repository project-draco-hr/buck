{
  BuildRuleBuilderParams buildRuleBuilderParams=new BuildRuleBuilderParams();
  PrebuiltJarRule cglib=buildRuleBuilderParams.buildAndAddToIndex(PrebuiltJarRule.newPrebuiltJarRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//third_party/java/easymock:cglib")).setBinaryJar("third_party/java/easymock/cglib.jar"));
  PrebuiltJarRule objenesis=buildRuleBuilderParams.buildAndAddToIndex(PrebuiltJarRule.newPrebuiltJarRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//third_party/java/easymock:objenesis")).setBinaryJar("third_party/java/easymock/objenesis.jar"));
  PrebuiltJarRule easymock=buildRuleBuilderParams.buildAndAddToIndex(PrebuiltJarRule.newPrebuiltJarRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//third_party/java/easymock:easymock")).setBinaryJar("third_party/java/easymock/easymock.jar").addDep(BuildTargetFactory.newInstance("//third_party/java/easymock:cglib")).addDep(BuildTargetFactory.newInstance("//third_party/java/easymock:objenesis")));
  BuildTarget easyMockExampleTarget=BuildTargetFactory.newInstance("//third_party/java/easymock:example");
  buildRuleBuilderParams.buildAndAddToIndex(AndroidLibraryRule.newAndroidLibraryRuleBuilder().setBuildTarget(easyMockExampleTarget).addDep(BuildTargetFactory.newInstance("//third_party/java/easymock:easymock")));
  ProjectConfigRule projectConfig=buildRuleBuilderParams.buildAndAddToIndex(ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//third_party/java/easymock:project_config")).setSrcTarget(Optional.of(easyMockExampleTarget)));
  ProjectWithModules projectWithModules=getModulesForPartialGraph(buildRuleBuilderParams,ImmutableList.of(projectConfig),null);
  List<Module> modules=projectWithModules.modules;
  assertEquals("Should be one module for the android_library",1,modules.size());
  Module androidLibraryModule=Iterables.getOnlyElement(modules);
  assertListEquals(ImmutableList.of(DependentModule.newSourceFolder(),DependentModule.newLibrary(easymock.getBuildTarget(),"easymock"),DependentModule.newLibrary(cglib.getBuildTarget(),"cglib"),DependentModule.newLibrary(objenesis.getBuildTarget(),"objenesis"),DependentModule.newInheritedJdk()),androidLibraryModule.dependencies);
}
