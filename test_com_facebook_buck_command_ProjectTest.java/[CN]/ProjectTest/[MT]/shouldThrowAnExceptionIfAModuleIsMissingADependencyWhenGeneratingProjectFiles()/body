{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  DefaultJavaLibraryRule ex1=ruleResolver.buildAndAddToIndex(DefaultJavaLibraryRule.newJavaLibraryRuleBuilder(new FakeAbstractBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//example/parent:ex1")).addSrc(Paths.get("DoesNotExist.java")).addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  DefaultJavaLibraryRule ex2=ruleResolver.buildAndAddToIndex(DefaultJavaLibraryRule.newJavaLibraryRuleBuilder(new FakeAbstractBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//example/child:ex2")).addSrc(Paths.get("AlsoDoesNotExist.java")).addDep(ex1.getBuildTarget()).addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  DefaultJavaLibraryRule tests=ruleResolver.buildAndAddToIndex(JavaTestRule.newJavaTestRuleBuilder(new FakeAbstractBuildRuleBuilderParams()).setBuildTarget(BuildTargetFactory.newInstance("//example/child:tests")).addSrc(Paths.get("SomeTestFile.java")).addDep(ex2.getBuildTarget()).addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  BuildRule config=ruleResolver.addToIndex(ProjectConfigBuilder.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//example/child:config")).setSrcRule(ex2).setTestRule(tests).build());
  ProjectWithModules projectWithModules=getModulesForPartialGraph(ruleResolver,ImmutableList.of(config),null);
  Module module=Iterables.getOnlyElement(projectWithModules.modules);
  List<Module> modules=projectWithModules.project.createModulesForProjectConfigs();
  Map<String,Module> map=projectWithModules.project.buildNameToModuleMap(modules);
  try {
    projectWithModules.project.writeProjectDotPropertiesFile(module,map);
    fail("Should have thrown a HumanReadableException");
  }
 catch (  HumanReadableException e) {
    assertEquals("You must define a project_config() in example/child/BUCK containing " + "//example/parent:ex1. The project_config() in //example/child:config transitively " + "depends on it.",e.getHumanReadableErrorMessage().replace("\\","/"));
  }
}
