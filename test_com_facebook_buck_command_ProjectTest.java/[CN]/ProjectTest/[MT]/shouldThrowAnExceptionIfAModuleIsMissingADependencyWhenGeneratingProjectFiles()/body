{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  DefaultJavaLibraryRule ex1=ruleResolver.buildAndAddToIndex(DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//example/parent:ex1")).addSrc("DoesNotExist.java").addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  DefaultJavaLibraryRule ex2=ruleResolver.buildAndAddToIndex(DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//example/child:ex2")).addSrc("AlsoDoesNotExist.java").addDep(ex1.getBuildTarget()).addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  DefaultJavaLibraryRule tests=ruleResolver.buildAndAddToIndex(JavaTestRule.newJavaTestRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//example/child:tests")).addSrc("SomeTestFile.java").addDep(ex2.getBuildTarget()).addVisibilityPattern(BuildTargetPattern.MATCH_ALL));
  ProjectConfigRule config=ruleResolver.buildAndAddToIndex(ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//example/child:config")).setSrcTarget(Optional.of(ex2.getBuildTarget())).setTestTarget(Optional.of(tests.getBuildTarget())));
  ProjectWithModules projectWithModules=getModulesForPartialGraph(ruleResolver,ImmutableList.of(config),null);
  Module module=Iterables.getOnlyElement(projectWithModules.modules);
  List<Module> modules=projectWithModules.project.createModulesForProjectConfigs();
  Map<String,Module> map=projectWithModules.project.buildNameToModuleMap(modules);
  try {
    projectWithModules.project.writeProjectDotPropertiesFile(module,map);
    fail("Should have thrown a HumanReadableException");
  }
 catch (  HumanReadableException e) {
    assertEquals("You must define a project_config() in example/child/BUCK containing " + "//example/parent:ex1. The project_config() in //example/child:config transitively " + "depends on it.",e.getHumanReadableErrorMessage());
  }
}
