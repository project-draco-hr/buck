{
  Map<String,BuildRule> buildRuleIndex=Maps.newHashMap();
  JavaLibraryRule rDotJavaRule=DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//buck-android/com/facebook:R")).addSrc("buck-android/com/facebook/R.java").addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(rDotJavaRule.getFullyQualifiedName(),rDotJavaRule);
  guava=PrebuiltJarRule.newPrebuiltJarRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//third_party/guava:guava")).setBinaryJar(PATH_TO_GUAVA_JAR).addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(guava.getFullyQualifiedName(),guava);
  AndroidResourceRule androidResourceRule=AndroidResourceRule.newAndroidResourceRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//android_res/base:res")).setRes("android_res/base/res").setRDotJavaPackage("com.facebook").addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(androidResourceRule.getFullyQualifiedName(),androidResourceRule);
  ProjectConfigRule projectConfigRuleForResource=ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//android_res/base:project_config")).setSrcTarget(Optional.of("//android_res/base:res")).setSrcRoots(ImmutableList.of("res")).build(buildRuleIndex);
  buildRuleIndex.put(projectConfigRuleForResource.getFullyQualifiedName(),projectConfigRuleForResource);
  JavaLibraryRule grandchildLib=DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/grandchild:grandchild")).addSrc("Grandchild.java").addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(grandchildLib.getFullyQualifiedName(),grandchildLib);
  JavaLibraryRule childLib=DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/child:child")).addSrc("Child.java").addDep("//java/src/com/facebook/grandchild:grandchild").addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(childLib.getFullyQualifiedName(),childLib);
  JavaLibraryRule exportingLib=DefaultJavaLibraryRule.newJavaLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/exportlib:exportlib")).addSrc("ExportLib.java").addDep("//third_party/guava:guava").setExportDeps(true).addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(exportingLib.getFullyQualifiedName(),exportingLib);
  AndroidLibraryRule androidLibraryRule=AndroidLibraryRule.newAndroidLibraryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/base:base")).addSrc("Base.java").addDep("//buck-android/com/facebook:R").addDep("//java/src/com/facebook/exportlib:exportlib").addDep("//java/src/com/facebook/child:child").addDep("//android_res/base:res").addVisibilityPattern(BuildTargetPattern.MATCH_ALL).build(buildRuleIndex);
  buildRuleIndex.put(androidLibraryRule.getFullyQualifiedName(),androidLibraryRule);
  ProjectConfigRule projectConfigRuleForLibrary=ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/base:project_config")).setSrcTarget(Optional.of("//java/src/com/facebook/base:base")).setSrcRoots(ImmutableList.of("src","src-gen")).build(buildRuleIndex);
  buildRuleIndex.put(projectConfigRuleForLibrary.getFullyQualifiedName(),projectConfigRuleForLibrary);
  ProjectConfigRule projectConfigRuleForExportLibrary=ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//java/src/com/facebook/exportlib:project_config")).setSrcTarget(Optional.of("//java/src/com/facebook/exportlib:exportlib")).setSrcRoots(ImmutableList.of("src")).build(buildRuleIndex);
  buildRuleIndex.put(projectConfigRuleForExportLibrary.getFullyQualifiedName(),projectConfigRuleForExportLibrary);
  AndroidBinaryRule androidBinaryRuleUsingNoDx=AndroidBinaryRule.newAndroidBinaryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//foo:app")).addDep("//java/src/com/facebook/base:base").setManifest("foo/AndroidManifest.xml").setTarget("Google Inc.:Google APIs:16").setKeystorePropertiesPath("foo/../keystore.properties").addBuildRuleToExcludeFromDex("//third_party/guava:guava").build(buildRuleIndex);
  buildRuleIndex.put(androidBinaryRuleUsingNoDx.getFullyQualifiedName(),androidBinaryRuleUsingNoDx);
  ProjectConfigRule projectConfigRuleUsingNoDx=ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//foo:project_config")).setSrcTarget(Optional.of("//foo:app")).build(buildRuleIndex);
  buildRuleIndex.put(projectConfigRuleUsingNoDx.getFullyQualifiedName(),projectConfigRuleUsingNoDx);
  AndroidBinaryRule androidBinaryRule=AndroidBinaryRule.newAndroidBinaryRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//bar:app")).addDep("//java/src/com/facebook/base:base").setManifest("foo/AndroidManifest.xml").setTarget("Google Inc.:Google APIs:16").setKeystorePropertiesPath("bar/../keystore.properties").build(buildRuleIndex);
  buildRuleIndex.put(androidBinaryRule.getFullyQualifiedName(),androidBinaryRule);
  ProjectConfigRule projectConfigRule=ProjectConfigRule.newProjectConfigRuleBuilder().setBuildTarget(BuildTargetFactory.newInstance("//bar:project_config")).setSrcTarget(Optional.of("//bar:app")).build(buildRuleIndex);
  buildRuleIndex.put(projectConfigRule.getFullyQualifiedName(),projectConfigRule);
  return getModulesForPartialGraph(buildRuleIndex,ImmutableList.of(projectConfigRuleForExportLibrary,projectConfigRuleForLibrary,projectConfigRuleForResource,projectConfigRuleUsingNoDx,projectConfigRule),javaPackageFinder);
}
