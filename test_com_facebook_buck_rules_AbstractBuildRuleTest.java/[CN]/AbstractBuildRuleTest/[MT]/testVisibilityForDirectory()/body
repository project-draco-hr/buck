{
  BuildTarget libTarget=BuildTargetFactory.newInstance("//lib","lib");
  BuildTarget targetInSpecifiedDirectory=BuildTargetFactory.newInstance("//src/com/facebook","test");
  BuildTarget targetUnderSpecifiedDirectory=BuildTargetFactory.newInstance("//src/com/facebook/buck","test");
  BuildTarget targetInOtherDirectory=BuildTargetFactory.newInstance("//src/com/instagram","test");
  BuildTarget targetInParentDirectory=BuildTargetFactory.newInstance("//","test");
  BuildRule directoryBuildRule=createRule(libTarget,noDeps,ImmutableSet.<BuildTargetPattern>of(new SubdirectoryBuildTargetPattern("src/com/facebook/")));
  assertTrue(directoryBuildRule.isVisibleTo(targetInSpecifiedDirectory));
  assertTrue(directoryBuildRule.isVisibleTo(targetUnderSpecifiedDirectory));
  assertFalse(directoryBuildRule.isVisibleTo(targetInOtherDirectory));
  assertFalse(directoryBuildRule.isVisibleTo(targetInParentDirectory));
  BuildRule pubicBuildRule=createRule(libTarget,noDeps,ImmutableSet.<BuildTargetPattern>of(new SubdirectoryBuildTargetPattern("")));
  assertTrue(pubicBuildRule.isVisibleTo(targetInSpecifiedDirectory));
  assertTrue(pubicBuildRule.isVisibleTo(targetUnderSpecifiedDirectory));
  assertTrue(pubicBuildRule.isVisibleTo(targetInOtherDirectory));
  assertTrue(pubicBuildRule.isVisibleTo(targetInParentDirectory));
}
