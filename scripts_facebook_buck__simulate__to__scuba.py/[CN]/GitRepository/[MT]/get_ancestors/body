def get_ancestors(self, rev, limit=None):
    command = [u'git', u'log', u'--format=%H %P', rev]
    command.extend([u'-n', str(limit)])
    history = self.run(command).split(u'\n')
    for line in history:
        if (not line):
            continue
        parts = line.split()
        commit = GitCommit(self, parts[0])
        commit._parents = []
        for parent in parts[1:]:
            commit._parents.append(GitCommit(self, parent))
        yield commit
