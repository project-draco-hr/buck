{
  if (args.length != 2) {
    printUsage();
    System.exit(STATUS_ERROR);
  }
  ZipFile jarOfRoots;
  try {
    jarOfRoots=new ZipFile(args[0]);
  }
 catch (  IOException e) {
    System.err.println("\"" + args[0] + "\" can not be read as a zip archive. ("+ e.getMessage()+ ")");
    System.exit(STATUS_ERROR);
    return;
  }
  Path path=null;
  try {
    path=new Path(args[1]);
    ClassReferenceListBuilder builder=new ClassReferenceListBuilder(path);
    builder.addRoots(jarOfRoots);
    printList(builder.toKeep);
  }
 catch (  IOException e) {
    System.err.println("A fatal error occured: " + e.getMessage());
    System.exit(STATUS_ERROR);
    return;
  }
 finally {
    try {
      jarOfRoots.close();
    }
 catch (    IOException e) {
    }
    if (path != null) {
      for (      ClassPathElement element : path.elements) {
        try {
          element.close();
        }
 catch (        IOException e) {
        }
      }
    }
  }
}
