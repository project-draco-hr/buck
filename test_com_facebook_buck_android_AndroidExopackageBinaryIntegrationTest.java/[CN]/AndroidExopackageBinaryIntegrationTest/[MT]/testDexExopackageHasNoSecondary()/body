{
  ZipInspector zipInspector=new ZipInspector(workspace.getPath("buck-out/gen/apps/multidex/app-dex-exo.apk"));
  zipInspector.assertFileDoesNotExist("assets/secondary-program-dex-jars/metadata.txt");
  zipInspector.assertFileDoesNotExist("assets/secondary-program-dex-jars/secondary-1.dex.jar");
  zipInspector.assertFileDoesNotExist("classes2.dex");
  zipInspector.assertFileExists("classes.dex");
  zipInspector.assertFileExists("lib/armeabi/libfakenative.so");
  Path secondaryDir=workspace.resolve(Paths.get("buck-out/bin/apps/multidex/_app-dex-exo#dex_merge_output" + "/jarfiles/assets/secondary-program-dex-jars"));
  try (DirectoryStream<Path> stream=Files.newDirectoryStream(secondaryDir)){
    List<Path> files=Lists.newArrayList(stream);
    assertEquals(2,files.size());
    Collections.sort(files);
    Path secondaryJar=files.get(0);
    ZipInspector zi=new ZipInspector(secondaryJar);
    zi.assertFileExists("classes.dex");
    long jarSize=Files.size(secondaryJar);
    long classesDexSize=zi.getSize("classes.dex");
    Path dexMeta=files.get(1);
    assertEquals(String.format("jar:%s dex:%s",jarSize,classesDexSize),new String(Files.readAllBytes(dexMeta),"US-ASCII"));
  }
 }
