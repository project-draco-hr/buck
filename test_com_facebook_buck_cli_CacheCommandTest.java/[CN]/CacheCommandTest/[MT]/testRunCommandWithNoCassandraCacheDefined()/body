{
  Console console=createMock(Console.class);
  console.printErrorText("No cassandra cache defined.");
  CommandRunnerParamsForTesting commandRunnerParams=CommandRunnerParamsForTesting.builder().setConsole(console).build();
  FileHashCache fileHashCache=FakeFileHashCache.createFromStrings(Maps.<String,String>newHashMap());
  CacheCommand cacheCommand=new CacheCommand(commandRunnerParams,fileHashCache);
  BuckConfig buckConfig=createMock(BuckConfig.class);
  Capture<BuckEventBus> buckEventBus=new Capture<>();
  expect(buckConfig.createCassandraArtifactCache(eq(Optional.<String>absent()),capture(buckEventBus),anyObject(FileHashCache.class))).andReturn(null);
  replayAll();
  CacheCommandOptions options=new CacheCommandOptions(buckConfig);
  options.setArguments(ImmutableList.of("b64009ae3762a42a1651c139ec452f0d18f48e21"));
  int exitCode=cacheCommand.runCommandWithOptionsInternal(options);
  assertEquals(1,exitCode);
  verifyAll();
}
