{
  SourcePathResolver resolver=new SourcePathResolver(new BuildRuleResolver(TargetGraph.EMPTY,new DefaultTargetNodeToBuildRuleTransformer()));
  ProjectFilesystem projectFilesystem=FakeProjectFilesystem.createJavaOnlyFilesystem("/opt/src/buck");
  BuildTarget buildTarget=BuildTarget.builder(projectFilesystem.getRootPath(),"//","base").build();
  BuildRule buildRule=new FakeBuildRule(buildTarget,resolver);
  SerializableModule module=new SerializableModule(buildRule,buildTarget);
  Project.addRootExcludes(module,buildRule,projectFilesystem);
  ImmutableSortedSet.Builder<SourceFolder> expectedExcludeFolders=ImmutableSortedSet.orderedBy(SerializableModule.ALPHABETIZER);
  for (  Path ignorePath : projectFilesystem.getIgnorePaths()) {
    expectedExcludeFolders.add(new SourceFolder("file://$MODULE_DIR$/" + ignorePath,false));
  }
  assertEquals("Specific subfolders of buck-out should be excluded rather than all of buck-out.",expectedExcludeFolders.build(),module.excludeFolders);
}
