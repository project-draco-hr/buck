{
  Map<String,?> config=ImmutableMap.of("visibility",ImmutableList.of(VISIBILITY_PUBLIC,"//...","//com/facebook/..."));
  BuildRuleFactoryParams params=NonCheckingBuildRuleFactoryParams.createNonCheckingBuildRuleFactoryParams(config,null,BuildTargetFactory.newInstance("//example:target"));
  assertEquals(ImmutableSet.of(BuildTargetPattern.MATCH_ALL,new SubdirectoryBuildTargetPattern(""),new SubdirectoryBuildTargetPattern("com/facebook/")),AbstractBuildRuleFactory.getVisibilityPatterns(params));
}
