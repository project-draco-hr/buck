{
  if (options.getIde() == ProjectCommandOptions.Ide.XCODE) {
    checkForAndKillXcodeIfRunning(params,options.getIdePrompt());
  }
  ImmutableSet<BuildTarget> passedInTargetsSet=getBuildTargets(params,options.getArgumentsFormattedAsBuildTargets());
  ProjectGraphParser projectGraphParser=ProjectGraphParsers.createProjectGraphParser(params.getParser(),new ParserConfig(options.getBuckConfig()),params.getBuckEventBus(),params.getConsole(),params.getEnvironment(),options.getEnableProfiling());
  TargetGraph projectGraph=projectGraphParser.buildTargetGraphForTargetNodeSpecs(getTargetNodeSpecsForIde(options.getIde(),passedInTargetsSet,params.getRepository().getFilesystem().getIgnorePaths()));
  ProjectPredicates projectPredicates=ProjectPredicates.forIde(options.getIde());
  ImmutableSet<BuildTarget> graphRoots;
  if (!passedInTargetsSet.isEmpty()) {
    ImmutableSet<BuildTarget> supplementalGraphRoots=getRootBuildTargetsForIntelliJ(options.getIde(),projectGraph,projectPredicates);
    graphRoots=Sets.union(passedInTargetsSet,supplementalGraphRoots).immutableCopy();
  }
 else {
    graphRoots=getRootsFromPredicate(projectGraph,projectPredicates.getProjectRootsPredicate());
  }
  TargetGraphAndTargets targetGraphAndTargets=createTargetGraph(projectGraph,graphRoots,projectGraphParser,projectPredicates.getAssociatedProjectPredicate(),options.isWithTests(),options.getIde(),params.getRepository().getFilesystem().getIgnorePaths());
  if (options.getDryRun()) {
    for (    TargetNode<?> targetNode : targetGraphAndTargets.getTargetGraph().getNodes()) {
      params.getConsole().getStdOut().println(targetNode.toString());
    }
    return 0;
  }
switch (options.getIde()) {
case INTELLIJ:
    return runIntellijProjectGenerator(params,projectGraph,targetGraphAndTargets,passedInTargetsSet,options);
case XCODE:
  return runXcodeProjectGenerator(params,targetGraphAndTargets,passedInTargetsSet,options);
default :
throw new IllegalStateException("'ide' should always be of type 'INTELLIJ' or 'XCODE'");
}
}
