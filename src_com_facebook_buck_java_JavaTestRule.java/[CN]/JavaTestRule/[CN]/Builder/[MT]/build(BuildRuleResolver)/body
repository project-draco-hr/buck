{
  ImmutableSet<JavaLibraryRule> sourceUnderTest=generateSourceUnderTest(sourcesUnderTest,ruleResolver);
  AnnotationProcessingParams processingParams=getAnnotationProcessingBuilder().build(ruleResolver);
  javacOptions.setAnnotationProcessingData(processingParams);
  BuildRuleParams buildRuleParams=createBuildRuleParams(ruleResolver);
  JavaLibraryGraphEnhancer.Result result=new JavaLibraryGraphEnhancer(buildTarget,buildRuleParams,params).createBuildableForAndroidResources(ruleResolver,false);
  return new JavaTestRule(result.getBuildRuleParams(),srcs,resources,result.getOptionalDummyRDotJava(),labels,contacts,proguardConfig,javacOptions.build(),vmArgs,sourceUnderTest);
}
