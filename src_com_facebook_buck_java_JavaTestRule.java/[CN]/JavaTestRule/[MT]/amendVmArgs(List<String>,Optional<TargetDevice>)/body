{
  if (!targetDevice.isPresent()) {
    return existingVmArgs;
  }
  ImmutableList.Builder<String> args=ImmutableList.<String>builder().addAll(existingVmArgs);
  if (targetDevice.isPresent()) {
    TargetDevice device=targetDevice.get();
    if (device.isEmulator()) {
      args.add("-Dbuck.device=emulator");
    }
 else {
      args.add("-Dbuck.device=device");
    }
    if (device.hasIdentifier()) {
      args.add("-Dbuck.device.id=" + device.getIdentifier());
    }
  }
  return args.build();
}
