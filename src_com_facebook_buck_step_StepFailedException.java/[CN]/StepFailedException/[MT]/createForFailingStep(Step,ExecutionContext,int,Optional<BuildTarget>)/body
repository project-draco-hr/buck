{
  String message;
  if (buildTarget.isPresent()) {
    message=String.format("%s failed on step \"%s\" with exit code %d",buildTarget.get().getFullyQualifiedName(),step.getShortName(context),exitCode);
  }
 else {
    message=String.format("Failed with %d: %s",exitCode,step.getDescription(context));
  }
  return new StepFailedException(message,step,exitCode);
}
