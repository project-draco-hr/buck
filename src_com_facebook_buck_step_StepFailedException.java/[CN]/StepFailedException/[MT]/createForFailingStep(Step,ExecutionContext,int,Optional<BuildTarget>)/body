{
  String message;
  if (buildTarget.isPresent()) {
    message=String.format("%s failed with exit code %d:\n%s",buildTarget.get().getFullyQualifiedName(),exitCode,step.getDescription(context));
  }
 else {
    message=String.format("Failed with exit code %d:\n%s",exitCode,step.getDescription(context));
  }
  return new StepFailedException(message,step,exitCode);
}
