{
  boolean shouldInstall=false;
  ImmutableExopackageInfo.Builder builder=ImmutableExopackageInfo.builder();
  if (ExopackageMode.enabledForSecondaryDexes(exopackageModes)) {
    PreDexMerge preDexMerge=enhancementResult.getPreDexMerge().get();
    builder.setDexInfo(ImmutableExopackageInfo.DexInfo.of(preDexMerge.getMetadataTxtPath(),preDexMerge.getDexDirectory()));
    shouldInstall=true;
  }
  if (ExopackageMode.enabledForNativeLibraries(exopackageModes) && enhancementResult.getCopyNativeLibraries().isPresent()) {
    CopyNativeLibraries copyNativeLibraries=enhancementResult.getCopyNativeLibraries().get();
    builder.setNativeLibsInfo(ImmutableExopackageInfo.NativeLibsInfo.of(copyNativeLibraries.getPathToMetadataTxt(),copyNativeLibraries.getPathToNativeLibsDir()));
    shouldInstall=true;
  }
  if (!shouldInstall) {
    return Optional.absent();
  }
  ExopackageInfo exopackageInfo=builder.build();
  return Optional.of(exopackageInfo);
}
