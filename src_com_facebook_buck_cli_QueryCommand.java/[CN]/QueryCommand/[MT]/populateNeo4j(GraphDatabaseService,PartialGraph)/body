{
  SortedMap<String,Node> nameNodeMap=Maps.newTreeMap();
  DependencyGraph dependencyGraph=partialGraph.getDependencyGraph();
  for (  BuildRule rule : dependencyGraph.getNodes()) {
    Node node=graphDb.createNode();
    String nodeName=rule.getFullyQualifiedName();
    node.setProperty("name",nodeName);
    nameNodeMap.put(nodeName,node);
  }
  for (  BuildRule rule : dependencyGraph.getNodes()) {
    Node source=nameNodeMap.get(rule.getFullyQualifiedName());
    for (    BuildRule dep : rule.getDeps()) {
      Node sink=nameNodeMap.get(dep.getFullyQualifiedName());
      source.createRelationshipTo(sink,QueryRelType.DEP);
    }
  }
  return nameNodeMap;
}
