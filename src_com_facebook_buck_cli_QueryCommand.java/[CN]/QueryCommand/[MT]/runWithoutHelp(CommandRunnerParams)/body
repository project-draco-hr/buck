{
  if (arguments.isEmpty()) {
    params.getBuckEventBus().post(ConsoleEvent.severe("Must specify at least the query expression"));
    return 1;
  }
  BuckQueryEnvironment env=new BuckQueryEnvironment(params,getEnableParserProfiling());
  try (CommandThreadManager pool=new CommandThreadManager("Query",params.getBuckConfig().getWorkQueueExecutionOrder(),getConcurrencyLimit(params.getBuckConfig()))){
    String queryFormat=arguments.remove(0);
    if (queryFormat.contains("%s")) {
      return runMultipleQuery(params,env,pool.getExecutor(),queryFormat,arguments,shouldGenerateJsonOutput());
    }
 else {
      return runSingleQuery(params,env,pool.getExecutor(),queryFormat);
    }
  }
 catch (  QueryException e) {
    params.getBuckEventBus().post(ConsoleEvent.severe(MoreExceptions.getHumanReadableOrLocalizedMessage(e)));
    return 1;
  }
}
