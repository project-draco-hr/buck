{
  ProjectFilesystem projectFilesystem=new FakeProjectFilesystem();
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  BuildRule rule=new FakeBuildRule(BuildRuleType.of("example"),target,pathResolver){
    @Override public Path getPathToOutput(){
      return Paths.get("cheese");
    }
  }
;
  resolver.addToIndex(rule);
  BuildTargetSourcePath path=new BuildTargetSourcePath(projectFilesystem,rule.getBuildTarget());
  Path resolved=pathResolver.getPath(path);
  assertEquals(Paths.get("cheese"),resolved);
}
