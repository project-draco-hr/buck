{
  FileHashCache hashCache;
  if (fileHashCache.isPresent()) {
    hashCache=fileHashCache.get();
  }
 else {
    hashCache=new DefaultFileHashCache(filesystem);
  }
  return new BuildRuleParams(buildTarget,Suppliers.ofInstance(deps),Suppliers.ofInstance(extraDeps),filesystem,TestCellBuilder.createCellRoots(filesystem),new DefaultRuleKeyBuilderFactory(hashCache,new SourcePathResolver(new BuildRuleResolver())));
}
