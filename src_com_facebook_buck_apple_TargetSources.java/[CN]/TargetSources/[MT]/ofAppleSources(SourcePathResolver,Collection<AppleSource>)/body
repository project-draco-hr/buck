{
  ImmutableList.Builder<GroupedSource> srcsBuilder=ImmutableList.builder();
  ImmutableSortedMap.Builder<SourcePath,String> perFileFlagsBuilder=ImmutableSortedMap.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> srcPathsBuilder=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> headerPathsBuilder=ImmutableSortedSet.naturalOrder();
  RuleUtils.extractSourcePaths(resolver,srcsBuilder,perFileFlagsBuilder,srcPathsBuilder,headerPathsBuilder,appleSources);
  return ImmutableTargetSources.of(srcsBuilder.build(),perFileFlagsBuilder.build(),srcPathsBuilder.build(),headerPathsBuilder.build());
}
