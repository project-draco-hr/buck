{
  ImmutableList.Builder<GroupedSource> srcsBuilder=ImmutableList.builder();
  ImmutableMap.Builder<SourcePath,String> perFileFlagsBuilder=ImmutableMap.builder();
  ImmutableSortedSet.Builder<SourcePath> srcPathsBuilder=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> headerPathsBuilder=ImmutableSortedSet.naturalOrder();
  RuleUtils.extractSourcePaths(srcsBuilder,perFileFlagsBuilder,srcPathsBuilder,headerPathsBuilder,appleSources);
  return new TargetSources(srcsBuilder.build(),perFileFlagsBuilder.build(),srcPathsBuilder.build(),headerPathsBuilder.build());
}
