{
  ImmutableSortedSet.Builder<SourceWithFlags> srcPathsBuilder=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> publicHeaderPathsBuilder=ImmutableSortedSet.naturalOrder();
  ImmutableSortedSet.Builder<SourcePath> privateHeaderPathsBuilder=ImmutableSortedSet.naturalOrder();
  RuleUtils.extractSourcePaths(srcPathsBuilder,publicHeaderPathsBuilder,privateHeaderPathsBuilder,sourcesWithFlags,headers,exportedHeaders);
  ImmutableSortedSet<SourceWithFlags> srcPaths=srcPathsBuilder.build();
  ImmutableSortedSet<SourcePath> publicHeaderPaths=publicHeaderPathsBuilder.build();
  ImmutableSortedSet<SourcePath> privateHeaderPaths=privateHeaderPathsBuilder.build();
  ImmutableList<GroupedSource> groupedSource=RuleUtils.createGroupsFromSourcePaths(resolver,srcPaths,publicHeaderPaths,privateHeaderPaths);
  return ImmutableTargetSources.of(groupedSource,srcPaths,publicHeaderPaths,privateHeaderPaths);
}
