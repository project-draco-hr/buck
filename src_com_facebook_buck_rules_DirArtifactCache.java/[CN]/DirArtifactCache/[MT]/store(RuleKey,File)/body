{
  if (!doStore) {
    return;
  }
  File cacheEntry=new File(cacheDir,ruleKey.toString());
  Path tmpCacheEntry=null;
  try {
    tmpCacheEntry=File.createTempFile(ruleKey.toString(),".tmp",cacheDir).toPath();
    Files.copy(output.toPath(),tmpCacheEntry,REPLACE_EXISTING);
    Files.move(tmpCacheEntry,cacheEntry.toPath());
  }
 catch (  IOException e) {
    logger.warning(String.format("Artifact store(%s, %s) error: %s",ruleKey,output.getPath(),e.getMessage()));
    if (tmpCacheEntry != null) {
      try {
        Files.deleteIfExists(tmpCacheEntry);
      }
 catch (      IOException ignored) {
        logger.log(Level.INFO,"Unable to delete temp cache file",ignored);
      }
    }
  }
}
