{
  try {
    setup(context);
  }
 catch (  IOException e) {
    e.printStackTrace(context.getStdErr());
    return 1;
  }
  ProcessBuilder processBuilder=new ProcessBuilder(getShellCommand(context));
  if (!getEnvironmentVariables().isEmpty()) {
    Map<String,String> environment=processBuilder.environment();
    environment.putAll(getEnvironmentVariables());
  }
  if (workingDirectory != null) {
    processBuilder.directory(workingDirectory);
  }
 else {
    processBuilder.directory(context.getProjectDirectoryRoot());
  }
  Process process;
  try {
    process=processBuilder.start();
  }
 catch (  IOException e) {
    e.printStackTrace(context.getStdErr());
    return 1;
  }
  return interactWithProcess(context,process);
}
