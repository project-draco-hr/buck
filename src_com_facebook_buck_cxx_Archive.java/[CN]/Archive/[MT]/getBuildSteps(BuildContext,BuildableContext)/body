{
  buildableContext.recordArtifact(output);
  for (  SourcePath input : inputs) {
    Preconditions.checkState(getResolver().getFilesystem(input).getRootPath().equals(getProjectFilesystem().getRootPath()));
  }
  return ImmutableList.of(new MkdirStep(getProjectFilesystem(),output.getParent()),new RmStep(getProjectFilesystem(),output,true),new ArchiveStep(getProjectFilesystem(),archiver.getEnvironment(getResolver()),archiver.getCommandPrefix(getResolver()),contents,output,FluentIterable.from(inputs).transform(getResolver().getRelativePathFunction()).toList()),new ShellStep(getProjectFilesystem().getRootPath()){
    @Override protected ImmutableList<String> getShellCommandInternal(    ExecutionContext context){
      return ImmutableList.<String>builder().addAll(ranlib.getCommandPrefix(getResolver())).add(output.toString()).build();
    }
    @Override public String getShortName(){
      return "ranlib";
    }
  }
,new FileScrubberStep(getProjectFilesystem(),output,archiver.getScrubbers()));
}
