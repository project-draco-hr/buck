def _local_execute(self, path):
    try:
        dirents = os.listdir(path)
    except OSError as e:
        TRACER.log(('Failed to fetch %s: %s' % (path, e)))
        return (set(), set())

    def partition(L, pred):
        return (filter((lambda v: (not pred(v))), L), filter((lambda v: pred(v)), L))
    return partition([os.path.join(path, fn) for fn in dirents], os.path.isdir)
