{
  if (object instanceof String) {
    String path=(String)object;
    if (path.startsWith(BuildRuleFactoryParams.GENFILE_PREFIX)) {
      path=path.substring(BuildRuleFactoryParams.GENFILE_PREFIX.length());
      return Paths.get(BuckConstant.GEN_DIR).resolve(pathRelativeToProjectRoot).resolve(path).normalize();
    }
 else {
      final Path normalizedPath;
      try {
        normalizedPath=pathRelativeToProjectRoot.resolve(path).normalize();
      }
 catch (      RuntimeException e) {
        throw new CoerceFailedException("invalid path",e);
      }
      try {
        filesystem.getPathForRelativeExistingPath(normalizedPath);
      }
 catch (      RuntimeException e) {
        throw new CoerceFailedException(String.format("no such file or directory '%s'",normalizedPath),e);
      }
      return normalizedPath;
    }
  }
 else {
    throw CoerceFailedException.simple(object,getOutputClass());
  }
}
