{
  Optional<Path> externalJavac=getJavacPath();
  if (externalJavac.isPresent()) {
    return ExternalJavac.createJavac(externalJavac.get());
  }
  Optional<SourcePath> javacJarPath=getJavacJarPath();
  if (javacJarPath.isPresent()) {
    return new JarBackedJavac("com.sun.tools.javac.api.JavacTool",ImmutableSet.of(javacJarPath.get()));
  }
  return new JdkProvidedInMemoryJavac();
}
