{
  ImmutableSet.Builder<IjLibrary> librariesBuilder=ImmutableSet.builder();
  for (  TargetNode<?> targetNode : targetNodes) {
    for (    BuildTarget dep : targetNode.getDeps()) {
      if (targetNodes.contains(dep)) {
        continue;
      }
      Optional<IjLibrary> libraryOptional=getLibrary(dep.getBuildTarget());
      Optionals.addIfPresent(libraryOptional,librariesBuilder);
    }
  }
  return librariesBuilder.build();
}
