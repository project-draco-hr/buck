{
  File root=tmp.newFolder();
  ProjectFilesystem filesystem=new ProjectFilesystem(root.toPath());
  String text="cheese" + File.pathSeparator + "peas";
  StringExpander source=new StringExpander(text);
  OutputToFileExpander expander=new OutputToFileExpander(source);
  BuildTarget target=BuildTargetFactory.newInstance("//some:example");
  String result=expander.expand(target,createCellRoots(filesystem),new BuildRuleResolver(TargetGraph.EMPTY,new BuildTargetNodeToBuildRuleTransformer()),filesystem,"totally ignored");
  assertTrue(result,result.startsWith("@"));
  Path output=Paths.get(result.substring(1));
  assertTrue(output.isAbsolute());
  List<String> seen=Files.readAllLines(output,UTF_8);
  List<String> expected=ImmutableList.of(text);
  assertEquals(expected,seen);
}
