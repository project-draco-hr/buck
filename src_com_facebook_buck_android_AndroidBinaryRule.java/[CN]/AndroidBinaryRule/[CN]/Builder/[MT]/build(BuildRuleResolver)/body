{
  BuildRule keystoreRule=ruleResolver.get(keystoreTarget);
  if (!(keystoreRule instanceof KeystoreRule)) {
    throw new HumanReadableException("In %s, keystore='%s' must be a keystore() but was %s().",getBuildTarget(),keystoreRule.getFullyQualifiedName(),keystoreRule.getType().getName());
  }
  boolean allowNonExistentRule=false;
  return new AndroidBinaryRule(createBuildRuleParams(ruleResolver),manifest,target,(KeystoreRule)keystoreRule,packageType,getBuildTargetsAsBuildRules(ruleResolver,buildRulesToExcludeFromDex,allowNonExistentRule),dexSplitMode,useAndroidProguardConfigWithOptimizations,proguardConfig,compressResources,primaryDexSubstrings.build(),resourceFilter,cpuFilters.build());
}
