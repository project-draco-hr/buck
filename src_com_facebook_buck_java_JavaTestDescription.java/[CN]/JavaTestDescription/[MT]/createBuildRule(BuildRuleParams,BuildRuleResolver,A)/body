{
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  JavacOptions.Builder javacOptions=JavaLibraryDescription.getJavacOptions(args,javacEnv);
  AnnotationProcessingParams annotationParams=args.buildAnnotationProcessingParams(params.getBuildTarget(),params.getProjectFilesystem(),resolver);
  javacOptions.setAnnotationProcessingData(annotationParams);
  return new JavaTest(params,pathResolver,args.srcs.get(),JavaLibraryDescription.validateResources(pathResolver,args,params.getProjectFilesystem()),args.labels.get(),args.contacts.get(),args.proguardConfig,ImmutableSet.<Path>of(),args.testType.or(TestType.JUNIT),javacOptions.build(),args.vmArgs.get(),validateAndGetSourcesUnderTest(args.sourceUnderTest.get(),params.getBuildTarget(),resolver),args.resourcesRoot);
}
