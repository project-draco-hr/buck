def set_perftest_side(args, cwd, perftest_side, cache_mode, dir_cache_only=True):
    log(('Reconfiguring to test %s version of buck.' % perftest_side))
    buckconfig_path = os.path.join(cwd, '.buckconfig.local')
    with open(buckconfig_path, 'w') as buckconfig:
        buckconfig.write(('[cache]\n  %s\n  dir = buck-cache-%s\n  dir_mode = %s\n' % (('mode = dir' if dir_cache_only else ''), perftest_side, cache_mode)))
        buckconfig.truncate()
    buckversion_path = os.path.join(cwd, '.buckversion')
    with open(buckversion_path, 'w') as buckversion:
        if (perftest_side == 'old'):
            buckversion.write((args.old_buck_revision + os.linesep))
        else:
            buckversion.write((args.new_buck_revision + os.linesep))
        buckversion.truncate()
