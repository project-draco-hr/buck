def main():
    args = createArgParser().parse_args()
    log('Running Performance Test!')
    git_clean(args.repo_under_test)
    revisions_to_test = git_get_revisions(args)
    log('=== Warming up cache ===')
    git_checkout(revisions_to_test[0], args.repo_under_test)
    build_all_targets(args, args.repo_under_test, 'old', 'readwrite', dir_cache_only=False, log_as_perftest=False)
    results_for_new = build_all_targets(args, args.repo_under_test, 'new', 'readwrite', dir_cache_only=False, log_as_perftest=False)
    log('=== Cache Warm!  Running tests ===')
    for i in xrange(1, args.revisions_to_go_back):
        results_for_new = run_tests_for_diff(args, revisions_to_test, i, results_for_new)
