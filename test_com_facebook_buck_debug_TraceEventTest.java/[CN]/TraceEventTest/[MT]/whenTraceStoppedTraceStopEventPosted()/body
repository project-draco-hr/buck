{
  EventBus eventBus=EasyMock.createNiceMock(EventBus.class);
  eventBus.post(EasyMock.anyObject(TraceStop.class));
  EasyMock.replay(eventBus);
  ThreadTrace.initCurrentTrace(0,eventBus);
  ThreadTrace threadTrace=ThreadTrace.threadTracer.get();
  long id=threadTrace.startTracer("test-trace","type");
  threadTrace.traceStarted(TraceEvents.started(id,"test-trace","type",0));
  long threshold=0;
  threadTrace.stopTracer(id,threshold);
  EasyMock.verify(eventBus);
}
