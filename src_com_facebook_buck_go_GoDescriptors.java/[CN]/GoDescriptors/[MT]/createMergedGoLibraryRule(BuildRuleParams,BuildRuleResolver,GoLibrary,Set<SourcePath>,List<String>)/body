{
  final BuildRuleParams originalParams=params;
  params=params.copyWithDeps(new Supplier<ImmutableSortedSet<BuildRule>>(){
    @Override public ImmutableSortedSet<BuildRule> get(){
      return ImmutableSortedSet.<BuildRule>naturalOrder().addAll(otherLibrary.getDeclaredDeps()).addAll(originalParams.getDeclaredDeps().get()).build();
    }
  }
,params.getExtraDeps());
  GoSymlinkTree symlinkTree=createDirectSymlinkTreeRule(params,resolver);
  resolver.addToIndex(symlinkTree);
  return new GoLibrary(params.appendExtraDeps(ImmutableList.of(symlinkTree)),new SourcePathResolver(resolver),otherLibrary,symlinkTree,ImmutableSet.copyOf(extraSrcs),ImmutableList.copyOf(extraCompilerFlags));
}
