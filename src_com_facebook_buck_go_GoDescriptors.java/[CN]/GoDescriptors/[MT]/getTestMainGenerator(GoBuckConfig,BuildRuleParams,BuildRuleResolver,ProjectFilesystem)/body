{
  Optional<Tool> configTool=goBuckConfig.getGoTestMainGenerator(resolver);
  if (configTool.isPresent()) {
    return configTool.get();
  }
  BuildTarget generatorTarget=sourceParams.getBuildTarget().withFlavors(ImmutableFlavor.of("make-test-main-gen"));
  Optional<BuildRule> generator=resolver.getRuleOptional(generatorTarget);
  if (generator.isPresent()) {
    return ((BinaryBuildRule)generator.get()).getExecutableCommand();
  }
  BuildRuleParams params=sourceParams.copyWithChanges(generatorTarget,Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of()),Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of()));
  GoBinary binary=createGoBinaryRule(params,resolver,goBuckConfig,ImmutableSet.<SourcePath>of(new PathSourcePath(projectFilesystem,MorePaths.relativize(projectFilesystem.getRootPath(),extractTestMainGenerator()))),ImmutableList.<String>of(),ImmutableList.<String>of(),goBuckConfig.getDefaultPlatform());
  resolver.addToIndex(binary);
  return binary.getExecutableCommand();
}
