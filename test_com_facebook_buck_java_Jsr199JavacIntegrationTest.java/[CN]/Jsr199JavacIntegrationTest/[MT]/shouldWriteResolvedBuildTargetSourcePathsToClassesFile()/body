{
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  BuildRule rule=new FakeBuildRule("//:fake",pathResolver);
  resolver.addToIndex(rule);
  Jsr199Javac javac=createJavac(false);
  ExecutionContext executionContext=createExecutionContext();
  int exitCode=javac.buildWithClasspath(executionContext,executionContext.getProjectFilesystem(),PATH_RESOLVER,BuildTargetFactory.newInstance("//some:example"),ImmutableList.<String>of(),SOURCE_PATHS,Optional.of(pathToSrcsList),Optional.<Path>absent());
  assertEquals("javac should exit with code 0.",exitCode,0);
  File srcsListFile=pathToSrcsList.toFile();
  assertTrue(srcsListFile.exists());
  assertTrue(srcsListFile.isFile());
  assertEquals("Example.java",Files.toString(srcsListFile,Charsets.UTF_8).trim());
}
