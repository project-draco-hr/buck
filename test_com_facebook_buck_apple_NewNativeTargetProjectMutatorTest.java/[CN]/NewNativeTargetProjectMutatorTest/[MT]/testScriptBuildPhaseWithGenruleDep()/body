{
  NewNativeTargetProjectMutator mutator=mutatorWithCommonDefaults();
  BuildTarget depBuildTarget=BuildTarget.builder("//foo","dep").build();
  GenruleBuilder.newGenruleBuilder(depBuildTarget).setCmd("echo \"hello dep!\"").setOut("dep.txt").build(buildRuleResolver);
  TargetNode<?> genruleNode=GenruleBuilder.newGenruleBuilder(BuildTarget.builder("//foo","script").build()).setSrcs(ImmutableList.<SourcePath>of(new TestSourcePath("script/input.png"))).setCmd("echo \"hello world!\"").setOut("helloworld.txt").setDeps(ImmutableSortedSet.of(depBuildTarget)).build();
  mutator.setPostBuildRunScriptPhases(ImmutableList.<TargetNode<?>>of(genruleNode));
  NewNativeTargetProjectMutator.Result result=mutator.buildTargetAndAddToProject(generatedProject);
  PBXShellScriptBuildPhase phase=getSingletonPhaseByType(result.target,PBXShellScriptBuildPhase.class);
  assertEquals("Should set input paths correctly","../script/input.png",Iterables.getOnlyElement(phase.getInputPaths()));
  assertEquals("should set script correctly","echo \"hello world!\"",phase.getShellScript());
}
