{
  TargetSources sources=TargetSources.fromSourcesWithFlags(ImmutableSortedSet.<SourceWithFlags>of(),ImmutableSortedSet.<SourcePath>of(new TestSourcePath("foo")),ImmutableSortedSet.<SourcePath>of());
{
    NewNativeTargetProjectMutator mutator=mutatorWithCommonDefaults();
    mutator.setShouldGenerateCopyHeadersPhase(false).setSources(sources);
    NewNativeTargetProjectMutator.Result result=mutator.buildTargetAndAddToProject(generatedProject);
    assertThat("copy headers phase should be omitted",Iterables.filter(result.target.getBuildPhases(),PBXHeadersBuildPhase.class),emptyIterable());
  }
{
    NewNativeTargetProjectMutator mutator=mutatorWithCommonDefaults();
    mutator.setShouldGenerateCopyHeadersPhase(true).setSources(sources);
    NewNativeTargetProjectMutator.Result result=mutator.buildTargetAndAddToProject(generatedProject);
    assertThat("copy headers phase should be generated",Iterables.filter(result.target.getBuildPhases(),PBXHeadersBuildPhase.class),not(emptyIterable()));
  }
}
