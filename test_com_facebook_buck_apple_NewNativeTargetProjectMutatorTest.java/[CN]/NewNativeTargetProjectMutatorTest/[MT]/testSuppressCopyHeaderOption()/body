{
  Set<SourcePath> privateHeaders=ImmutableSet.<SourcePath>of(new TestSourcePath("foo"));
{
    NewNativeTargetProjectMutator mutator=mutatorWithCommonDefaults();
    mutator.setShouldGenerateCopyHeadersPhase(false).setPrivateHeaders(privateHeaders);
    NewNativeTargetProjectMutator.Result result=mutator.buildTargetAndAddToProject(generatedProject);
    assertThat("copy headers phase should be omitted",Iterables.filter(result.target.getBuildPhases(),PBXHeadersBuildPhase.class),emptyIterable());
  }
{
    NewNativeTargetProjectMutator mutator=mutatorWithCommonDefaults();
    mutator.setShouldGenerateCopyHeadersPhase(true).setPrivateHeaders(privateHeaders);
    NewNativeTargetProjectMutator.Result result=mutator.buildTargetAndAddToProject(generatedProject);
    assertThat("copy headers phase should be generated",Iterables.filter(result.target.getBuildPhases(),PBXHeadersBuildPhase.class),not(emptyIterable()));
  }
}
