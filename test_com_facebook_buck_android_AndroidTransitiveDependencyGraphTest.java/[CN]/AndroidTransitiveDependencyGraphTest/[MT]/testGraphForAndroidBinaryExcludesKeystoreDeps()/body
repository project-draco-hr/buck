{
  BuildRuleResolver ruleResolver=new BuildRuleResolver();
  BuildTarget androidLibraryKeystoreTarget=new BuildTarget("//java/com/keystore/base","base");
  BuildRule androidLibraryKeystore=AndroidLibraryBuilder.createBuilder(androidLibraryKeystoreTarget).addSrc(Paths.get("java/com/facebook/keystore/Base.java")).build(ruleResolver);
  BuildTarget keystoreTarget=new BuildTarget("//keystore","debug");
  BuildRule keystore=KeystoreBuilder.createBuilder(keystoreTarget).setStore(Paths.get("keystore/debug.keystore")).setProperties(Paths.get("keystore/debug.keystore.properties")).addDep(androidLibraryKeystore).build(ruleResolver);
  BuildTarget androidLibraryTarget=new BuildTarget("//java/com/facebook/base","base");
  BuildRule androidLibrary=AndroidLibraryBuilder.createBuilder(androidLibraryTarget).addSrc(Paths.get("java/com/facebook/base/Base.java")).build(ruleResolver);
  ImmutableSortedSet<BuildRule> originalDeps=ImmutableSortedSet.of(androidLibrary);
  AndroidBinary androidBinary=(AndroidBinary)AndroidBinaryBuilder.newBuilder().setBuildTarget(new BuildTarget("//apps/sample","app")).setManifest(new TestSourcePath("apps/sample/AndroidManifest.xml")).setTarget("Google Inc.:Google APIs:16").setKeystore((Keystore)keystore.getBuildable()).setOriginalDeps(originalDeps).build(ruleResolver).getBuildable();
  androidBinary.getEnhancedDeps(ruleResolver,originalDeps,ImmutableSortedSet.of(keystore));
  AndroidDexTransitiveDependencies androidTransitiveDeps=androidBinary.findDexTransitiveDependencies();
  assertEquals("Classpath entries should include facebook/base but not keystore/base.",ImmutableSet.of(BuckConstant.GEN_PATH.resolve("java/com/facebook/base/lib__base__output/base.jar")),androidTransitiveDeps.classpathEntriesToDex);
}
