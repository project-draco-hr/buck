{
  List<TestRule> tests=ImmutableList.of(beerTest,hopsTest);
  TestResultsGrouper grouper=new TestResultsGrouper(tests);
  Capture<Boolean> isBeerDependenciesPass=newCapture();
  Capture<Boolean> isHopsDependenciesPass=newCapture();
  TestResults beerTestResults=failTestsAndCapture(isBeerDependenciesPass);
  TestResults hopsTestResults=failTestsAndCapture(isHopsDependenciesPass);
  assertGroupedTestResults(grouper.post(beerTest,beerTestResults));
  assertGroupedTestResults(grouper.post(hopsTest,hopsTestResults),beerTest,hopsTest);
  assertFalse("Beer should have a failed dependency (hops)",isBeerDependenciesPass.getValue());
  assertTrue("Hops has no failed dependencies",isHopsDependenciesPass.getValue());
}
