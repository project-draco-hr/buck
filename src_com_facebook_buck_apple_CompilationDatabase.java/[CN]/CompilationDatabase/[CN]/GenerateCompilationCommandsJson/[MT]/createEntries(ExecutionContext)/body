{
  BuildTarget target=getBuildTarget();
  List<JsonSerializableDatabaseEntry> entries=Lists.newArrayList();
  Iterable<SourcePath> allSources=Iterables.concat(targetSources.getSrcPaths(),targetSources.getHeaderPaths());
  ProjectFilesystem projectFilesystem=context.getProjectFilesystem();
  for (  SourcePath srcPath : allSources) {
    String fileToCompile=projectFilesystem.resolve(getResolver().getPath(srcPath)).toString();
    String language;
    String languageStandard;
    if (fileToCompile.endsWith(".mm")) {
      language="objective-c++";
      languageStandard="-std=c++11";
    }
 else {
      language="objective-c";
      languageStandard="-std=gnu99";
    }
    List<String> commandArgs=Lists.newArrayList("clang","-x",language,"-arch","i386","-mios-simulator-version-min=7.0","-fmessage-length=0","-fdiagnostics-show-note-include-stack","-fmacro-backtrace-limit=0",languageStandard,"-fpascal-strings","-fexceptions","-fasm-blocks","-fstrict-aliasing","-fobjc-abi-version=2","-fobjc-legacy-dispatch","-O0","-g","-MMD");
    commandArgs.add("-fobjc-arc");
    ImmutableMap<AppleSdk,AppleSdkPaths> allAppleSdkPaths=appleConfig.getAppleSdkPaths(context.getProcessExecutor());
    AppleSdkPaths appleSdkPaths=selectNewestSimulatorSdk(allAppleSdkPaths);
    commandArgs.add("-isysroot");
    Path sysroot=appleSdkPaths.getSdkPath();
    commandArgs.add(sysroot.toString());
    String sdkRoot=appleSdkPaths.getSdkPath().toString();
    for (    String framework : frameworks) {
      framework=framework.replace("$SDKROOT",sdkRoot);
      commandArgs.add("-F" + framework);
    }
    for (    Path includePath : includePaths) {
      commandArgs.add("-I" + projectFilesystem.resolve(includePath));
    }
    Path iquoteArg=internalHeaderMap.get();
    if (iquoteArg != null) {
      commandArgs.add("-iquote");
      commandArgs.add(projectFilesystem.resolve(iquoteArg).toString());
    }
    if (pchFile.isPresent()) {
      commandArgs.add("-include");
      Path relativePathToPchFile=getResolver().getPath(pchFile.get());
      commandArgs.add(projectFilesystem.resolve(relativePathToPchFile).toString());
    }
    commandArgs.add("-c");
    commandArgs.add(fileToCompile);
    String perFileFlags=Strings.nullToEmpty(targetSources.getPerFileFlags().get(srcPath));
    if (!perFileFlags.isEmpty() && FileExtensions.CLANG_SOURCES.contains(Files.getFileExtension(fileToCompile))) {
      commandArgs.add(perFileFlags);
    }
    String command=Joiner.on(' ').join(commandArgs);
    entries.add(new JsonSerializableDatabaseEntry(projectFilesystem.resolve(target.getBasePath()).toString(),fileToCompile,command));
  }
  return entries;
}
