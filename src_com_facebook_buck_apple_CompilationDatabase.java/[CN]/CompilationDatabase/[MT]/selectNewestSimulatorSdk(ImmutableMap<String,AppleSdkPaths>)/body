{
  final String prefix="iphonesimulator";
  List<String> iphoneSimulatorVersions=Lists.newArrayList(FluentIterable.from(allAppleSdkPaths.keySet()).filter(new Predicate<String>(){
    @Override public boolean apply(    String sdkName){
      return sdkName.startsWith(prefix);
    }
  }
).transform(new Function<String,String>(){
    @Override public String apply(    String sdkName){
      return sdkName.substring(prefix.length());
    }
  }
).toSet());
  if (iphoneSimulatorVersions.isEmpty()) {
    throw new RuntimeException("No iphonesimulator found in: " + allAppleSdkPaths.keySet());
  }
  Collections.sort(iphoneSimulatorVersions,new VersionStringComparator());
  String version=iphoneSimulatorVersions.get(iphoneSimulatorVersions.size() - 1);
  return Preconditions.checkNotNull(allAppleSdkPaths.get(prefix + version));
}
