{
  for (  TargetNode<?> node : nodes) {
    Genrule rule=(Genrule)targetNodeToBuildRuleTransformer.transform(targetGraph,buildRuleResolver,node);
    PBXShellScriptBuildPhase shellScriptBuildPhase=new PBXShellScriptBuildPhase();
    target.getBuildPhases().add(shellScriptBuildPhase);
    for (    Path path : rule.getSrcs()) {
      shellScriptBuildPhase.getInputPaths().add(pathRelativizer.outputDirToRootRelative(path).toString());
    }
    StringBuilder bashCommandBuilder=new StringBuilder();
    for (    String commandElement : rule.createGenruleStep().getShellCommand(executionContext)) {
      if (bashCommandBuilder.length() > 0) {
        bashCommandBuilder.append(' ');
      }
      bashCommandBuilder.append(Escaper.escapeAsBashString(commandElement));
    }
    shellScriptBuildPhase.setShellScript(bashCommandBuilder.toString());
    if (rule.getOutputName().length() > 0) {
      shellScriptBuildPhase.getOutputPaths().add(rule.getOutputName());
    }
  }
}
