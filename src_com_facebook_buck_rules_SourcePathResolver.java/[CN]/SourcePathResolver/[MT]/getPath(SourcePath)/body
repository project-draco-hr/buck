{
  if (sourcePath instanceof PathSourcePath) {
    return ((PathSourcePath)sourcePath).getRelativePath();
  }
  Preconditions.checkArgument(sourcePath instanceof BuildRuleSourcePath);
  BuildRuleSourcePath buildRuleSourcePath=(BuildRuleSourcePath)sourcePath;
  Optional<Path> resolvedPath=buildRuleSourcePath.getResolvedPath();
  if (resolvedPath.isPresent()) {
    return resolvedPath.get();
  }
  Path path=buildRuleSourcePath.getRule().getPathToOutputFile();
  if (path == null) {
    throw new HumanReadableException("No known output for: %s",buildRuleSourcePath.getRule());
  }
  return path;
}
