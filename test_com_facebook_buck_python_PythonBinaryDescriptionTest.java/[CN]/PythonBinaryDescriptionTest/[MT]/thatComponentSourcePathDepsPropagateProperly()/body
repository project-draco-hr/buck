{
  BuildRuleResolver resolver=new BuildRuleResolver();
  Genrule genrule=(Genrule)GenruleBuilder.newGenruleBuilder(BuildTargetFactory.newInstance("//:gen")).setOut("blah.py").build(resolver);
  BuildRuleParams libParams=new FakeBuildRuleParamsBuilder("//:lib").build();
  PythonLibrary lib=new PythonLibrary(libParams,new SourcePathResolver(resolver),Functions.constant(ImmutableMap.<Path,SourcePath>of(Paths.get("hello"),new BuildTargetSourcePath(genrule.getBuildTarget()))),Functions.constant(ImmutableMap.<Path,SourcePath>of()),Optional.<Boolean>absent());
  BuildRuleParams params=new FakeBuildRuleParamsBuilder(BuildTargetFactory.newInstance("//:bin")).setDeps(ImmutableSortedSet.<BuildRule>of(lib)).build();
  PythonBinaryDescription desc=new PythonBinaryDescription(PYTHON_BUCK_CONFIG,PythonTestUtils.PYTHON_PLATFORMS,CXX_PLATFORM,CXX_PLATFORMS);
  PythonBinaryDescription.Arg arg=desc.createUnpopulatedConstructorArg();
  arg.deps=Optional.of(ImmutableSortedSet.<BuildTarget>of());
  arg.mainModule=Optional.absent();
  arg.main=Optional.<SourcePath>of(new TestSourcePath("blah.py"));
  arg.baseModule=Optional.absent();
  arg.zipSafe=Optional.absent();
  arg.buildArgs=Optional.absent();
  BuildRule rule=desc.createBuildRule(TargetGraph.EMPTY,params,resolver,arg);
  assertEquals(ImmutableSortedSet.<BuildRule>of(genrule),rule.getDeps());
}
