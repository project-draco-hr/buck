{
  AbstractBottomUpTraversal<BuildRule,List<TestRule>> traversal=new AbstractBottomUpTraversal<BuildRule,List<TestRule>>(graph){
    private final List<TestRule> results=Lists.newArrayList();
    @Override public void visit(    BuildRule buildRule){
      TestRule testRule=null;
      if (buildRule instanceof TestRule) {
        testRule=(TestRule)buildRule;
      }
 else       if (buildRule.getBuildable() instanceof TestRule) {
        testRule=(TestRule)buildRule.getBuildable();
      }
      if (testRule != null) {
        results.add(testRule);
      }
    }
    @Override public List<TestRule> getResult(){
      return results;
    }
  }
;
  traversal.traverse();
  return traversal.getResult();
}
