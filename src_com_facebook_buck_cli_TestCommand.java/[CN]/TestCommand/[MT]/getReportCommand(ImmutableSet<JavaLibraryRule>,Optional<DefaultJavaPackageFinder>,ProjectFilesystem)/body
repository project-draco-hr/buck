{
  ImmutableSet.Builder<String> srcDirectories=ImmutableSet.builder();
  for (  JavaLibraryRule rule : rulesUnderTest) {
    ImmutableSet<String> sourceFolderPath=getPathToSourceFolders(rule,defaultJavaPackageFinderOptional,projectFilesystem);
    if (!sourceFolderPath.isEmpty()) {
      srcDirectories.addAll(sourceFolderPath);
    }
  }
  return new GenerateCodeCoverageReportStep(srcDirectories.build(),JUnitStep.EMMA_OUTPUT_DIR);
}
