{
  ImmutableCollection<BuildRule> toolInputs=toolOptional.isPresent() ? toolOptional.get().getDeps(getPathResolver()) : ImmutableSet.<BuildRule>of();
  return ImmutableSortedSet.<BuildRule>naturalOrder().addAll(toolInputs).addAll(getPathResolver().filterBuildRuleInputs(source.getPath())).addAll(getPreprocessDeps()).build();
}
