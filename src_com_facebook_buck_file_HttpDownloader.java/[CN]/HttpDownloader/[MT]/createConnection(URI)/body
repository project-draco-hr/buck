{
  if (!("http".equals(uri.getScheme()) || "https".equals(uri.getScheme()))) {
    throw new HumanReadableException("Cowardly refusing to download with unknown scheme: %s",uri);
  }
  HttpURLConnection connection;
  if (proxy.isPresent()) {
    connection=(HttpURLConnection)uri.toURL().openConnection(proxy.get());
  }
 else {
    connection=(HttpURLConnection)uri.toURL().openConnection();
  }
  connection.setConnectTimeout((int)TimeUnit.SECONDS.toMillis(20));
  connection.setInstanceFollowRedirects(true);
  return connection;
}
