{
switch (type) {
case LITERAL:
    return this;
case INTERPOLATION:
  ImmutableList<TokenValue> newValue=interpolateList(function,Preconditions.checkNotNull(interpolationValue));
if (newValue.size() == 1 && newValue.get(0).type == Type.LITERAL) {
  Optional<TokenValue> interpolated=function.apply(newValue.get(0).literalValue);
  if (interpolated.isPresent()) {
    return interpolated.get();
  }
}
return interpolation(newValue);
}
throw new IllegalStateException("'type' should always be of type 'LITERAL' or 'INTERPOLATION'");
}
