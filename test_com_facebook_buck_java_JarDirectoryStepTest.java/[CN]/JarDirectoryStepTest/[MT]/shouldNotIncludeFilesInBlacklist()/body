{
  Path zipup=folder.newFolder();
  Path first=createZip(zipup.resolve("first.zip"),"dir/file1.txt","dir/file2.txt","com/example/Main.class");
  JarDirectoryStep step=new JarDirectoryStep(Paths.get("output.jar"),ImmutableSet.of(first.getFileName()),"com.example.Main",null,true,ImmutableSet.of(".*2.*"));
  ExecutionContext context=TestExecutionContext.newBuilder().setProjectFilesystem(new ProjectFilesystem(zipup)).build();
  int returnCode=step.execute(context);
  assertEquals(0,returnCode);
  Path zip=zipup.resolve("output.jar");
  assertZipFileCountIs(3,zip);
  assertZipContains(zip,"dir/file1.txt");
  assertZipDoesNotContain(zip,"dir/file2.txt");
}
