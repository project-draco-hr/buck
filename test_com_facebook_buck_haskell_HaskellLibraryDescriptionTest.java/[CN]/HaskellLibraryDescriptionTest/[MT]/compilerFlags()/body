{
  BuildTarget target=BuildTargetFactory.newInstance("//:rule");
  String flag="-compiler-flag";
  HaskellLibraryBuilder builder=new HaskellLibraryBuilder(target).setCompilerFlags(ImmutableList.of(flag));
  BuildRuleResolver resolver=new BuildRuleResolver(TargetGraphFactory.newInstance(builder.build()),new DefaultTargetNodeToBuildRuleTransformer());
  HaskellLibrary library=(HaskellLibrary)builder.build(resolver);
  HaskellCompileRule rule=library.requireCompileRule(CxxPlatformUtils.DEFAULT_PLATFORM,CxxSourceRuleFactory.PicType.PIC);
  assertThat(rule.getFlags(),Matchers.hasItem(flag));
}
