{
  BuildTarget targetForOriginalRule=params.getBuildTarget();
  if (targetForOriginalRule.isFlavored()) {
    targetForOriginalRule=targetForOriginalRule.getUnflavoredTarget();
  }
  BuildTarget headersTarget=BuildTargets.createFlavoredBuildTarget(targetForOriginalRule,AppleDescriptions.HEADERS);
  BuildRuleParams headerRuleParams=params.copyWithChanges(HEADERS_RULE_TYPE,headersTarget,Suppliers.ofInstance(ImmutableSortedSet.<BuildRule>of()),Suppliers.ofInstance(params.getExtraDeps()));
  TargetSources targetSources=TargetSources.fromSourcesWithFlags(resolver,args.srcs.get());
  ImmutableSortedMap<SourcePath,ImmutableList<String>> perFileFlags=ImmutableSortedMap.copyOf(targetSources.getPerFileFlags());
  boolean useBuckHeaderMaps=args.useBuckHeaderMaps.or(Boolean.FALSE);
  return createSymlinkTree(headerRuleParams,resolver,perFileFlags,useBuckHeaderMaps);
}
