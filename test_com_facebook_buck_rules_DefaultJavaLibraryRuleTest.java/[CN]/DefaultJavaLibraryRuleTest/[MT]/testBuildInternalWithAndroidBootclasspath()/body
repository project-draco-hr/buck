{
  BuildTarget buildTarget=BuildTargetFactory.newInstance("//android/java/src/com/facebook:fb");
  ImmutableSet<String> srcs=ImmutableSet.of("android/java/src/com/facebook/Main.java");
  DefaultJavaLibraryRule javaLibrary=new AndroidLibraryRule(new BuildRuleParams(buildTarget,ImmutableSortedSet.<BuildRule>of(),ImmutableSet.<BuildTargetPattern>of()),srcs,ImmutableSet.<String>of(),null,AnnotationProcessingParams.EMPTY,null,JavacOptionsUtil.DEFAULT_SOURCE_LEVEL,JavacOptionsUtil.DEFAULT_TARGET_LEVEL);
  String bootclasspath="effects.jar:maps.jar:usb.jar:";
  BuildContext context=createBuildContext(javaLibrary,bootclasspath);
  List<Step> steps=javaLibrary.buildInternal(context);
  Step step=Iterables.find(steps,new Predicate<Step>(){
    @Override public boolean apply(    Step command){
      return command instanceof JavacInMemoryStep;
    }
  }
);
  assertNotNull("Expected a JavacInMemoryCommand in the command list.",step);
  JavacInMemoryStep javac=(JavacInMemoryStep)step;
  assertEquals("Should compile Main.java rather than generated R.java.",srcs,javac.getSrcs());
  EasyMock.verify(context);
}
