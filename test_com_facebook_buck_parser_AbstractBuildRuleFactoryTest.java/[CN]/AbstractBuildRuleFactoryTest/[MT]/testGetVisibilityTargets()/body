{
  Map<String,?> config=ImmutableMap.of("visibility",ImmutableList.of(BuildRule.VISIBILITY_PUBLIC,"//...","//com/facebook/..."));
  BuildRuleFactoryParams params=NonCheckingBuildRuleFactoryParams.createNonCheckingBuildRuleFactoryParams(config,null,null);
  assertEquals(ImmutableSet.of(BuildTargetPattern.MATCH_ALL,new SubdirectoryBuildTargetPattern(""),new SubdirectoryBuildTargetPattern("com/facebook/")),AbstractBuildRuleFactory.getVisibilityPatterns(params));
}
