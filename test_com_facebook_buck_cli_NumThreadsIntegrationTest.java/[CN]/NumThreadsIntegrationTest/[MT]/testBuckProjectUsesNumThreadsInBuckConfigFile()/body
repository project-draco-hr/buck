{
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"num_threads",tmp);
  workspace.setUp();
  ProcessResult buildResult1=workspace.runBuckCommand("project","--verbose","10");
  assertThat("Number of threads to use should be read from .buckconfig.",buildResult1.getStderr(),containsString("Creating a build with 7 threads.\n"));
  String newBuckProject=Joiner.on('\n').join("[project]","  initial_targets = //:noop");
  Files.write(workspace.getPath(".buckconfig"),newBuckProject.getBytes(UTF_8));
  int numThreads=(int)(Runtime.getRuntime().availableProcessors() * 1.25);
  ProcessResult buildResult2=workspace.runBuckCommand("project","--verbose","10");
  assertThat("Once num_threads is removed from .buckconfig, the number of threads should be " + "a function of the number of processors.",buildResult2.getStderr(),containsString("Creating a build with " + numThreads + " threads.\n"));
}
