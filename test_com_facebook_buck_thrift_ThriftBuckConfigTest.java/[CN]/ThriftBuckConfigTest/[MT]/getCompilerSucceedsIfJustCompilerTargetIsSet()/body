{
  BuildRuleResolver resolver=new BuildRuleResolver();
  SourcePathResolver pathResolver=new SourcePathResolver(resolver);
  BuildRule thriftRule=createFakeBuildRule("//thrift:target",pathResolver);
  BuildTarget thriftTarget=thriftRule.getBuildTarget();
  resolver.addToIndex(thriftRule);
  FakeBuckConfig buckConfig=new FakeBuckConfig(ImmutableMap.<String,Map<String,String>>of("thrift",ImmutableMap.of("compiler_target",thriftTarget.toString())));
  ThriftBuckConfig thriftBuckConfig=new ThriftBuckConfig(buckConfig);
  SourcePath compiler=thriftBuckConfig.getCompiler(resolver);
  assertTrue(compiler instanceof BuildTargetSourcePath);
  assertEquals(BuildTargetFactory.newInstance("//thrift:target"),((BuildTargetSourcePath)compiler).getTarget());
}
