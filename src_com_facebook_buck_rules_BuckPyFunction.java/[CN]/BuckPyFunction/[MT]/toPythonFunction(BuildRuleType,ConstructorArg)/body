{
  Preconditions.checkNotNull(type);
  Preconditions.checkNotNull(dto);
  StringBuilder builder=new StringBuilder();
  SortedSet<ParamInfo> mandatory=Sets.newTreeSet();
  SortedSet<ParamInfo> optional=Sets.newTreeSet();
  for (  ParamInfo param : argMarshaller.getAllParamInfo(dto)) {
    if (isSkippable(param)) {
      continue;
    }
    if (param.isOptional()) {
      optional.add(param);
    }
 else {
      mandatory.add(param);
    }
  }
  builder.append("@provide_for_build\n").append("def ").append(type.getName()).append("(name, ");
  for (  ParamInfo param : Iterables.concat(mandatory,optional)) {
    appendPythonParameter(builder,param);
  }
  builder.append("visibility=[], build_env=None):\n").append("  add_rule({\n").append("    'type' : '").append(type.getName()).append("',\n").append("    'name' : name,\n");
  for (  ParamInfo param : Iterables.concat(mandatory,optional)) {
    builder.append("    '").append(param.getName()).append("' : ").append(param.getPythonName()).append(",\n");
  }
  builder.append("    'visibility' : visibility,\n");
  builder.append("  }, build_env)\n\n");
  return builder.toString();
}
