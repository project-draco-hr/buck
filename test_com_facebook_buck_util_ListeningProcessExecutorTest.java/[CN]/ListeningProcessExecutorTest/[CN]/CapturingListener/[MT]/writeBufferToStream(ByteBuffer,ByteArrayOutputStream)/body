{
  if (buffer.hasArray()) {
    stream.write(buffer.array(),buffer.position(),buffer.remaining());
    buffer.position(buffer.limit());
  }
 else {
    byte[] bufferBytes=new byte[buffer.remaining()];
    buffer.get(bufferBytes);
    stream.write(bufferBytes,0,bufferBytes.length);
  }
}
