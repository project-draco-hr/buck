{
  if (this == AUTO && graphSize < MIN_SHALLOW_GRAPH_SIZE || this == NONE) {
    return Functions.identity();
  }
  return new Function<Path,Path>(){
    @Nullable @Override public Path apply(    @Nullable Path input){
      if (input == null || input.getNameCount() <= SHALLOW_MAX_PATH_LENGTH) {
        return input;
      }
      return input.subpath(0,SHALLOW_MAX_PATH_LENGTH);
    }
  }
;
}
