{
  BuildRule ruleWithNoOutput=JavaLibraryBuilder.createBuilder(BuildTarget.builder("//cheese","java").build()).build(new BuildRuleResolver());
  BuildRule genrule=GenruleBuilder.createGenrule(BuildTarget.builder("//cheese","cake").build()).setCmd("$(location //cheese:java").setOut("cake").addDep(ruleWithNoOutput).build();
  try {
    ((Genrule)genrule).createGenruleStep().replaceMatches(new FakeProjectFilesystem(),"$(location //cheese:java)");
    fail("Location was null. Expected HumanReadableException with helpful message.");
  }
 catch (  HumanReadableException e) {
    assertTrue(e.getMessage(),e.getMessage().contains("there is no output generated by //cheese:java"));
  }
}
