{
  ImmutableMultimap.Builder<BuildRule,BuildRule> ruleToTestRulesBuilder=ImmutableMultimap.builder();
  for (  BuildTarget target : graph.getTargets()) {
    BuildRule rule=graph.getActionGraph().findBuildRuleByTarget(target);
    if (rule.getType().equals(IosTestDescription.TYPE)) {
      IosTest testBuildable=(IosTest)Preconditions.checkNotNull(rule.getBuildable());
      for (      BuildRule sourceRule : testBuildable.getSourceUnderTest()) {
        ruleToTestRulesBuilder.put(sourceRule,rule);
      }
    }
  }
  return ruleToTestRulesBuilder.build();
}
