{
synchronized (this) {
    if (!tagSets.isEmpty()) {
      CounterSnapshot.Builder snapshot=CounterSnapshot.builderForCounter(this);
      snapshot.putAllTagSets(tagSets);
      tagSets.clear();
      return Optional.of(snapshot.build());
    }
 else {
      return Optional.absent();
    }
  }
}
