{
  if (!(args.apk.getBuildable() instanceof InstallableApk)) {
    throw new HumanReadableException("In %s, apk='%s' must be an android_binary() or apk_genrule() but was %s().",params.getBuildTarget(),args.apk.getFullyQualifiedName(),args.apk.getType().getName());
  }
  return new AndroidInstrumentationApk(params,args.manifest,getUnderlyingApk((InstallableApk)args.apk.getBuildable()),args.apk,args.deps.get());
}
