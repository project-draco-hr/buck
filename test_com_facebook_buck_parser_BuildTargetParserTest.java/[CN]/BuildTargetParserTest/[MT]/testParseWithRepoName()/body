{
  ImmutableMap<Optional<String>,Optional<String>> canonicalRepoNamesMap=ImmutableMap.of(Optional.of("localreponame"),Optional.of("canonicalname"));
  BuildTargetParser parser=new BuildTargetParser(canonicalRepoNamesMap);
  BuildTargetPatternParser context=BuildTargetPatternParser.fullyQualified();
  String targetStr="@localreponame//foo/bar:baz";
  String canonicalStr="@canonicalname//foo/bar:baz";
  BuildTarget buildTarget=parser.parse(targetStr,context);
  assertEquals(canonicalStr,buildTarget.getFullyQualifiedName());
  assertEquals("canonicalname",buildTarget.getRepository().get());
}
