{
  Set<String> sourceDirectories=ImmutableSet.of("parentDirectory1/src","root/parentDirectory/src");
  String outputDirectory="buck-gen/output";
  ExecutionContext context=createMock(ExecutionContext.class);
  replay(context);
  List<String> expectedShellCommand=ImmutableList.of("java","-classpath",JUnitCommand.PATH_TO_EMMA_JAR,"emma","report",String.format("-D%s=%s",GenerateCodeCoverageReportCommand.REPORT_OUTPUT_DIR,outputDirectory),"-report",GenerateCodeCoverageReportCommand.CODE_COVERAGE_OUTPUT_FORMAT,"-input",String.format("%s/coverage.ec,%s/coverage.em",JUnitCommand.EMMA_OUTPUT_DIR,JUnitCommand.EMMA_OUTPUT_DIR),"-sourcepath","parentDirectory1/src,root/parentDirectory/src");
  GenerateCodeCoverageReportCommand command=new GenerateCodeCoverageReportCommand(sourceDirectories,outputDirectory);
  MoreAsserts.assertListEquals(expectedShellCommand,command.getShellCommandInternal(context));
  verify(context);
}
