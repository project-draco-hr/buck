{
  environmentVariablesBuilder.put("SRCS",Joiner.on(' ').join(srcsToAbsolutePaths.values()));
  environmentVariablesBuilder.put("OUT",getAbsoluteOutputFilePath());
  final Set<String> depFiles=Sets.newHashSet();
  final Set<BuildRule> processedBuildRules=Sets.newHashSet();
  for (  BuildRule dep : getDeps()) {
    transformNames(processedBuildRules,depFiles,dep);
  }
  environmentVariablesBuilder.put("GEN_DIR",relativeToAbsolutePathFunction.apply(BuckConstant.GEN_PATH).toString());
  environmentVariablesBuilder.put("DEPS",Joiner.on(' ').skipNulls().join(depFiles));
  environmentVariablesBuilder.put("SRCDIR",absolutePathToSrcDirectory.toString());
  environmentVariablesBuilder.put("TMP",absolutePathToTmpDirectory.toString());
  Optional<AndroidPlatformTarget> optionalAndroid=context.getAndroidPlatformTargetOptional();
  if (optionalAndroid.isPresent()) {
    AndroidPlatformTarget android=optionalAndroid.get();
    environmentVariablesBuilder.put("DX",android.getDxExecutable().toString());
    environmentVariablesBuilder.put("ZIPALIGN",android.getZipalignExecutable().toString());
  }
  environmentVariablesBuilder.put("NO_BUCKD","1");
}
