{
  Map<String,ImmutableSet.Builder<Path>> builders=new HashMap<>(SUPPORTED_RESOURCE_DIRECTORIES.size());
  for (  String folderName : SUPPORTED_RESOURCE_DIRECTORIES) {
    builders.put(folderName,ImmutableSet.<Path>builder());
  }
  for (  Path resourceFolder : candidates) {
    String resourceType=getResourceType(resourceFolder);
    Preconditions.checkState(builders.containsKey(resourceType),"Unsupported resource type %s when processing resource folder %s",resourceType,resourceFolder);
    builders.get(resourceType).add(resourceFolder);
  }
  ImmutableMap.Builder<String,ImmutableSet<Path>> bucketsBuilder=ImmutableMap.builder();
  for (  Map.Entry<String,ImmutableSet.Builder<Path>> builderEntry : builders.entrySet()) {
    bucketsBuilder.put(builderEntry.getKey(),builderEntry.getValue().build());
  }
  return bucketsBuilder.build();
}
