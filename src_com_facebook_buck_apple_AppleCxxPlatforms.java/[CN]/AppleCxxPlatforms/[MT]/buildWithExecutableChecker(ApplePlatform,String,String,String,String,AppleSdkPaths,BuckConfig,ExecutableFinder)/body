{
  ImmutableList.Builder<Path> toolSearchPathsBuilder=ImmutableList.builder();
  toolSearchPathsBuilder.add(sdkPaths.getSdkPath().resolve(USR_BIN)).add(sdkPaths.getPlatformPath().resolve("Developer").resolve(USR_BIN));
  for (  Path toolchainPath : sdkPaths.getToolchainPaths()) {
    toolSearchPathsBuilder.add(toolchainPath.resolve(USR_BIN));
  }
  ImmutableList<Path> toolSearchPaths=toolSearchPathsBuilder.build();
  ImmutableList.Builder<String> cflagsBuilder=ImmutableList.builder();
  cflagsBuilder.add("-isysroot",sdkPaths.getSdkPath().toString());
  cflagsBuilder.add("-arch",targetArchitecture);
switch (targetPlatform) {
case MACOSX:
    cflagsBuilder.add("-mmacosx-version-min=" + targetVersion);
  break;
case IPHONESIMULATOR:
cflagsBuilder.add("-mios-simulator-version-min=" + targetVersion);
break;
case IPHONEOS:
cflagsBuilder.add("-mios-version-min=" + targetVersion);
break;
}
ImmutableList<String> cflags=cflagsBuilder.build();
String xcodeAndSdkVersion=Joiner.on(':').join(xcodeVersion,targetSdkName);
Tool clangPath=new VersionedTool(getToolPath("clang",toolSearchPaths,executableFinder),cflags,"apple-clang",xcodeAndSdkVersion);
Tool clangXxPath=new VersionedTool(getToolPath("clang++",toolSearchPaths,executableFinder),cflags,"apple-clang++",xcodeAndSdkVersion);
Tool libtool=new VersionedTool(getToolPath("libtool",toolSearchPaths,executableFinder),ImmutableList.<String>of(),"apple-libtool",xcodeAndSdkVersion);
Tool ar=new VersionedTool(getToolPath("ar",toolSearchPaths,executableFinder),ImmutableList.<String>of(),"apple-ar",xcodeAndSdkVersion);
CxxBuckConfig config=new CxxBuckConfig(buckConfig);
return CxxPlatforms.build(ImmutableFlavor.of(targetSdkName + "-" + targetArchitecture),Platform.MACOS,config,clangPath,clangPath,clangPath,clangXxPath,clangPath,clangXxPath,clangXxPath,Optional.of(CxxPlatform.LinkerType.DARWIN),libtool,ar,getOptionalTool("lex",toolSearchPaths,executableFinder,xcodeAndSdkVersion),getOptionalTool("yacc",toolSearchPaths,executableFinder,xcodeAndSdkVersion));
}
