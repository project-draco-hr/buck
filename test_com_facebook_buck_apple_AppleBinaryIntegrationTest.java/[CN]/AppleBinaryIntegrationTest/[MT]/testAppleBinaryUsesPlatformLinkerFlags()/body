{
  assumeTrue(Platform.detect() == Platform.MACOS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"apple_binary_builds_something",tmp);
  workspace.setUp();
  BuildTarget target=BuildTargetFactory.newInstance("//Apps/TestApp:TestAppWithNonstandardMain");
  workspace.runBuckCommand("build",target.getFullyQualifiedName()).assertSuccess();
  Path outputPath=workspace.getPath(BuildTargets.getGenPath(target,"%s"));
  assertThat(Files.exists(outputPath),is(true));
  assertThat(workspace.runCommand("file",outputPath.toString()).getStdout().get(),containsString("executable"));
}
