{
  BuildCommand buildCommand=new BuildCommand(arguments);
  Pair<ActionGraph,BuildRuleResolver> actionGraphAndResolver=buildCommand.createActionGraphAndResolver(params);
  if (actionGraphAndResolver == null) {
    return 1;
  }
  SimulateTimes times=Strings.isNullOrEmpty(simulateTimesFile) ? SimulateTimes.createEmpty(ruleFallbackTimeMillis) : SimulateTimes.createFromJsonFile(params.getObjectMapper(),simulateTimesFile,simulateTimeAggregate,ruleFallbackTimeMillis);
  BuildSimulator simulator=new BuildSimulator(times,actionGraphAndResolver.getFirst(),params.getBuckConfig().getNumThreads());
  SimulateReport report=simulator.simulateBuild(params.getClock().currentTimeMillis(),buildCommand.getBuildTargets());
  outputReport(params.getObjectMapper(),report);
  String finishedMsg=String.format("Simulation report was successfully written to [%s]",simulateReportFile);
  params.getBuckEventBus().post(ConsoleEvent.create(Level.INFO,finishedMsg));
  return 0;
}
