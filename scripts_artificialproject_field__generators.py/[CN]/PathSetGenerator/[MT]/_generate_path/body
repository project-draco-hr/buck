def _generate_path(self, base_path):
    component_count = weighted_choice(self._component_counts)
    components = [self._component_generator.generate(base_path).value for i in range(component_count)]
    path = os.path.join(*components)
    full_path = os.path.join(self._context.output_repository, path)
    if os.path.exists(full_path):
        raise GenerationFailedException()
    try:
        os.makedirs(os.path.dirname(full_path), exist_ok=True)
    except (NotADirectoryError, FileExistsError):
        raise GenerationFailedException()
    with open(full_path, 'w'):
        pass
    return path
