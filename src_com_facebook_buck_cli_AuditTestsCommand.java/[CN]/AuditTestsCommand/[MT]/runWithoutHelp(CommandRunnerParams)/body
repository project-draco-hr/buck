{
  final ImmutableSet<String> fullyQualifiedBuildTargets=ImmutableSet.copyOf(getArgumentsFormattedAsBuildTargets(params.getBuckConfig()));
  if (fullyQualifiedBuildTargets.isEmpty()) {
    params.getConsole().printBuildFailure("Must specify at least one build target.");
    return 1;
  }
  ImmutableSet<BuildTarget> targets=getBuildTargets(params,ImmutableSet.copyOf(getArgumentsFormattedAsBuildTargets(params.getBuckConfig())));
  TargetGraph graph;
  try {
    graph=params.getParser().buildTargetGraphForBuildTargets(targets,new ParserConfig(params.getBuckConfig()),params.getBuckEventBus(),params.getConsole(),params.getEnvironment(),getEnableProfiling());
  }
 catch (  BuildTargetException|BuildFileParseException e) {
    params.getConsole().printBuildFailureWithoutStacktrace(e);
    return 1;
  }
  TreeMultimap<BuildTarget,BuildTarget> targetsToPrint=getTestsForTargets(targets,graph);
  LOG.debug("Printing out the following targets: " + targetsToPrint);
  if (shouldGenerateJsonOutput()) {
    printJSON(params,targetsToPrint);
  }
 else {
    printToConsole(params,targetsToPrint);
  }
  return 0;
}
