{
  final ImmutableSet<String> fullyQualifiedBuildTargets=ImmutableSet.copyOf(getArgumentsFormattedAsBuildTargets(params.getBuckConfig()));
  if (fullyQualifiedBuildTargets.isEmpty()) {
    params.getConsole().printBuildFailure("Must specify at least one build target.");
    return 1;
  }
  ImmutableSet<BuildTarget> targets=getBuildTargets(ImmutableSet.copyOf(getArgumentsFormattedAsBuildTargets(params.getBuckConfig())));
  try {
    TreeMultimap<BuildTarget,BuildTarget> targetsToPrint=getTestsForTargets(params,targets,getEnableProfiling());
    LOG.debug("Printing out the following targets: " + targetsToPrint);
    if (shouldGenerateJsonOutput()) {
      CommandHelper.printJSON(params,targetsToPrint);
    }
 else {
      CommandHelper.printToConsole(params,targetsToPrint);
    }
  }
 catch (  BuildTargetException|BuildFileParseException e) {
    params.getConsole().printBuildFailureWithoutStacktrace(e);
    return 1;
  }
  return 0;
}
