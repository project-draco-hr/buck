{
  ImmutableBiMap.Builder<Path,Path> filteredResourcesDirMapBuilder=ImmutableBiMap.builder();
  String resDestinationBasePath=getResDestinationBasePath();
  int count=0;
  for (  Path resDir : resourceDirectories) {
    filteredResourcesDirMapBuilder.put(resDir,Paths.get(resDestinationBasePath,String.valueOf(count++)));
  }
  ImmutableBiMap<Path,Path> resSourceToDestDirMap=filteredResourcesDirMapBuilder.build();
  FilterResourcesStep.Builder filterResourcesStepBuilder=FilterResourcesStep.builder().setInResToOutResDirMap(resSourceToDestDirMap).setResourceFilter(resourceFilter);
  if (isStoreStringsAsAssets()) {
    filterResourcesStepBuilder.enableStringsFilter();
    filterResourcesStepBuilder.setWhitelistedStringDirs(FluentIterable.from(whitelistedStringDirs).transform(MorePaths.TO_PATH).toSet());
  }
  return filterResourcesStepBuilder.build();
}
