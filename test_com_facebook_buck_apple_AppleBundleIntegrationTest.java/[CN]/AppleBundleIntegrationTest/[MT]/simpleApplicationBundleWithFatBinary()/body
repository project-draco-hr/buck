{
  assumeTrue(Platform.detect() == Platform.MACOS);
  ProjectWorkspace workspace=TestDataHelper.createProjectWorkspaceForScenario(this,"simple_fat_application_bundle",tmp);
  workspace.setUp();
  workspace.runBuckCommand("build","//:DemoApp#iphonesimulator-i386,iphonesimulator-x86_64").assertSuccess();
  workspace.verify();
  Path outputFile=tmp.getRootPath().resolve(BuckConstant.GEN_DIR).resolve("DemoApp#iphonesimulator-i386,iphonesimulator-x86_64/DemoApp.app/DemoApp");
  assertTrue(Files.exists(outputFile));
  ProcessExecutor.Result result=workspace.runCommand("lipo",outputFile.toString(),"-verify_arch","i386","x86_64");
  assertEquals(0,result.getExitCode());
}
