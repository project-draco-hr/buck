{
  String watchmanOutput=Joiner.on('\n').join("{","\"version\": \"2.9.2\",","\"error\": \"Watch does not exist.\"","}");
  Capture<WatchEvent<Path>> eventCapture=newCapture();
  EventBus eventBus=createStrictMock(EventBus.class);
  eventBus.post(capture(eventCapture));
  replay(eventBus);
  WatchmanWatcher watcher=createWatcher(eventBus,new FakeProcess(0,watchmanOutput,""),new IncrementingFakeClock(),new ObjectMapper());
  try {
    watcher.postEvents(new BuckEventBus(new FakeClock(0),new BuildId()),ImmutableSet.<String>builder());
  }
  finally {
    assertEquals("Should be overflow event.",StandardWatchEventKinds.OVERFLOW,eventCapture.getValue().kind());
  }
}
