{
  String watchmanOutput=Joiner.on('\n').join("{\"files\": [","{","\"name\": \"/foo/bar/baz\"","},","{","\"name\": \"/foo/bar/boz\"","}","]}");
  EventBus eventBus=createStrictMock(EventBus.class);
  eventBus.post(anyObject(WatchEvent.class));
  eventBus.post(anyObject(WatchEvent.class));
  Process process=createMockProcess(watchmanOutput);
  replay(eventBus,process);
  WatchmanWatcher watcher=createWatcher(eventBus,process);
  watcher.postEvents();
  verify(eventBus,process);
}
