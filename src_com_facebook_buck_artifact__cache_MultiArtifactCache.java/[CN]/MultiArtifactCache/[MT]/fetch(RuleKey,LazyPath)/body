{
  CacheResult cacheResult=CacheResult.miss();
  for (  ArtifactCache artifactCache : artifactCaches) {
    cacheResult=artifactCache.fetch(ruleKey,output);
    if (cacheResult.getType().isSuccess()) {
      for (      ArtifactCache priorArtifactCache : artifactCaches) {
        if (priorArtifactCache.equals(artifactCache)) {
          break;
        }
        Path outputPath=output.getUnchecked();
        priorArtifactCache.store(ImmutableSet.of(ruleKey),cacheResult.getMetadata(),outputPath);
      }
      return cacheResult;
    }
  }
  return cacheResult;
}
