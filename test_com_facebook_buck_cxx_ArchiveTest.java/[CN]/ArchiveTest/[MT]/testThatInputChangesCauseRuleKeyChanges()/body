{
  SourcePathResolver pathResolver=new SourcePathResolver(new BuildRuleResolver());
  BuildTarget target=BuildTargetFactory.newInstance("//foo:bar");
  BuildRuleParams params=new FakeBuildRuleParamsBuilder(target).build();
  RuleKeyBuilderFactory ruleKeyBuilderFactory=new DefaultRuleKeyBuilderFactory(FakeFileHashCache.createFromStrings(ImmutableMap.of(AR.toString(),Strings.repeat("0",40),"a.o",Strings.repeat("a",40),"b.o",Strings.repeat("b",40),"c.o",Strings.repeat("c",40),Paths.get("different").toString(),Strings.repeat("d",40))),pathResolver);
  RuleKey defaultRuleKey=ruleKeyBuilderFactory.build(new Archive(params,pathResolver,DEFAULT_ARCHIVER,DEFAULT_OUTPUT,DEFAULT_INPUTS));
  RuleKey archiverChange=ruleKeyBuilderFactory.build(new Archive(params,pathResolver,new GnuArchiver(new HashedFileTool(Paths.get("different"))),DEFAULT_OUTPUT,DEFAULT_INPUTS));
  assertNotEquals(defaultRuleKey,archiverChange);
  RuleKey outputChange=ruleKeyBuilderFactory.build(new Archive(params,pathResolver,DEFAULT_ARCHIVER,Paths.get("different"),DEFAULT_INPUTS));
  assertNotEquals(defaultRuleKey,outputChange);
  RuleKey inputChange=ruleKeyBuilderFactory.build(new Archive(params,pathResolver,DEFAULT_ARCHIVER,DEFAULT_OUTPUT,ImmutableList.<SourcePath>of(new TestSourcePath("different"))));
  assertNotEquals(defaultRuleKey,inputChange);
  RuleKey archiverTypeChange=ruleKeyBuilderFactory.build(new Archive(params,pathResolver,new BsdArchiver(new HashedFileTool(AR)),DEFAULT_OUTPUT,DEFAULT_INPUTS));
  assertNotEquals(defaultRuleKey,archiverTypeChange);
}
