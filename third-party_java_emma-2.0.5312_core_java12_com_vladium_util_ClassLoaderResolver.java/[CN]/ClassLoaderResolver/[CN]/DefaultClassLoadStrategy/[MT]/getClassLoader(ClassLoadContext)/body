{
  if (ctx == null)   throw new IllegalArgumentException("null input: ctx");
  final Class caller=ctx.getCallerClass();
  final ClassLoader contextLoader=Thread.currentThread().getContextClassLoader();
  ClassLoader result;
  if (caller == null)   result=contextLoader;
 else {
    final ClassLoader callerLoader=caller.getClassLoader();
    if (isChild(callerLoader,contextLoader))     result=contextLoader;
 else     result=callerLoader;
  }
  final ClassLoader systemLoader=ClassLoader.getSystemClassLoader();
  if (isChild(result,systemLoader))   result=systemLoader;
  return result;
}
